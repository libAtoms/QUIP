

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Theoretical background &mdash; quippy 967e02c+ documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="quippy 967e02c+ documentation" href="index.html"/>
        <link rel="up" title="Adaptive QM/MM MD of Fracture in Silicon" href="adaptive-qmmm.html"/>
        <link rel="next" title="Step 1: Setup of the Silicon model system" href="adaptive-qmmm-step1.html"/>
        <link rel="prev" title="Introduction" href="adaptive-qmmm-step0.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> quippy
          

          
            
            <img src="_static/hybrid.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                967e02c+
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction to <code class="docutils literal"><span class="pre">quippy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation of QUIP and quippy</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tutorial.html">Introductory Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="adglass.html">Molecular Dynamics Simulation of Fracture in Quartz</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="adaptive-qmmm.html">Adaptive QM/MM MD of Fracture in Silicon</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="adaptive-qmmm-step0.html">Introduction</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Theoretical background</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#introduction-to-atomic-scale-modelling-of-fracture">Introduction to Atomic-scale Modelling of Fracture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classical-interatomic-potentials-for-silicon">Classical interatomic potentials for silicon</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qm-mm-force-mixing-and-the-learn-on-the-fly-scheme">QM/MM Force Mixing and the ‘Learn on the Fly’ scheme</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="adaptive-qmmm-step1.html">Step 1: Setup of the Silicon model system</a></li>
<li class="toctree-l3"><a class="reference internal" href="adaptive-qmmm-step2.html">Step 2: Classical MD simulation of fracture in Si</a></li>
<li class="toctree-l3"><a class="reference internal" href="adaptive-qmmm-step3.html">Step 3: LOTF hybrid MD simulation of fracture in Si</a></li>
<li class="toctree-l3"><a class="reference internal" href="adaptive-qmmm-solutions.html">Solutions</a></li>
<li class="toctree-l3"><a class="reference internal" href="adaptive-qmmm-references.html">References</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quippy.html">Quippy library reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualisation.html">Visualisation Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="fortran_wrapper.html">Appendix: wrapping Fortran 90 Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="teach_sparse.html">Command line options of the teach_sparse main program</a></li>
</ul>

            
          
    <p></p>
    <ul>
        <li><a href="genindex.html">Index</a></li>
        <li><a href="py-modindex.html">Module Index</a></li>
        <li><a href="search.html">Search Page</a></li>
        <li><a href="_modules/index.html">Module Source Code</a></li>
    </ul>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">quippy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="tutorials.html">Tutorials</a> &raquo;</li>
        
          <li><a href="adaptive-qmmm.html">Adaptive QM/MM MD of Fracture in Silicon</a> &raquo;</li>
        
      <li>Theoretical background</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/adaptive-qmmm-theory.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="theoretical-background">
<h1>Theoretical background<a class="headerlink" href="#theoretical-background" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction-to-atomic-scale-modelling-of-fracture">
<span id="theory1"></span><h2>Introduction to Atomic-scale Modelling of Fracture<a class="headerlink" href="#introduction-to-atomic-scale-modelling-of-fracture" title="Permalink to this headline">¶</a></h2>
<p>Fracture is the main lifetime limiting failure mode of many materials, from
metals to ceramics and glasses. There are two broad classes of
fracture: <em>brittle</em> and <em>ductile</em>.</p>
<div class="figure align-center" id="id27">
<a class="reference internal image-reference" href="_images/brittle-vs-ductile.png"><img alt="_images/brittle-vs-ductile.png" src="_images/brittle-vs-ductile.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Brittle and ductile failure of steel, at low and high temperature
respectively. Image credit: <a class="reference external" href="http://pwatlas.mt.umist.ac.uk/internetmicroscope/micrographs/failure/ductile-steel.html">Internet Electron Microscopy website, UMIST</a></span></p>
</div>
<p>In brittle fracture, there is no plastic deformation, and failure occurs along
particular low-energy cleavage planes. In contrast, ductile materials such as
steel tend to fail with a large amount of plastic deformation (or ‘necking’),
pulling apart to leave rough fracture surfaces. The same patterns are evident
upon closer examination: brittle cracks are found to be atomically sharp,
proceeding bond by bond, while ductile cracks remain rough at the microscale,
driven by the formation and coalescence of microscopic voids.</p>
<div class="figure align-center" id="id28">
<a class="reference internal image-reference" href="_images/brittle-vs-ductile-microscale.png"><img alt="_images/brittle-vs-ductile-microscale.png" src="_images/brittle-vs-ductile-microscale.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Brittle and ductile failure mechanisms, for silica and aluminium respectively.
Image credits: C. Marlière and A. Weck.</span></p>
</div>
<p>Silicon is known to be an ideally brittle material, as shown by the image below.
Below the brittle to ductile transition, at around <span class="math">\(500^\circ~\mathrm{C}\)</span>, silicon
cleaves atomically smooth fracture surfaces (left and centre panel; sample in
central panel is tilted to show the crack front). At higher temperatures,
fracture is ductile, with the emission of multiple dislocations from the tip
(right panel).</p>
<div class="figure align-center" id="id29">
<span id="si-tem-images"></span><a class="reference internal image-reference" href="_images/lawn-fracture-silicon.png"><img alt="_images/lawn-fracture-silicon.png" src="_images/lawn-fracture-silicon.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">Transmission electron microscopy (TEM) images of a crack in silicon.
Image reproduced from <a class="reference internal" href="adaptive-qmmm-references.html#lawn1993" id="id1">[Lawn1993]</a>.</span></p>
</div>
<div class="section" id="fracture-mechanics">
<span id="theory-griffith"></span><h3>Fracture Mechanics<a class="headerlink" href="#fracture-mechanics" title="Permalink to this headline">¶</a></h3>
<p>The study of fracture mechanics dates back around 100 years, to
Griffith, who first proposed a thermodynamic energy balance criteria
to understand when cracks will propagate <a class="reference internal" href="adaptive-qmmm-references.html#griffith1921" id="id2">[Griffith1921]</a>. The key idea
is that stress concentrates at pre-existing flaws: this was motivated
by the observation that materials break at much lower loads than the
theoretical stress needed to break their chemical bonds For example,
in glass, the theoretical strength is given by</p>
<div class="math">
\[\sigma_{theoretical} = \sqrt{\frac{E\gamma}{a}} \sim 10,000\;\mathrm{MPa}\]</div>
<p>where <span class="math">\(E\)</span>, <span class="math">\(\gamma\)</span> and <span class="math">\(a\)</span> are the Young’s modulus, surface
energy and bond length, respectively.</p>
<p>For a slowly-moving crack of length <cite>c</cite> in an infinite plane, the
well-known Griffith criterion for fracture propagation is based on thermodynamic
energy balance between the release of elastic energy in an area
proportional to <cite>c</cite><sup>2</sup> and the cost of creating new surfaces,
which is proportional to <cite>c</cite>, as illustrated below.</p>
<a class="reference internal image-reference" href="_images/griffith-criterion.png"><img alt="_images/griffith-criterion.png" class="align-center" src="_images/griffith-criterion.png" style="width: 600px;" /></a>
<p>This leads to a Griffith fracture strength for glass of</p>
<div class="math">
\[\sigma_{fracture} = \sqrt{\frac{E\gamma\rho}{4ac}} \sim 100 \;\mathrm{MPa}\]</div>
<p>which is much lower than the theoretical strength. Here the additional
parameters are <span class="math">\(\rho\)</span>, the radius of curvature and the crack
length <cite>c</cite>. The effect of stress concentration increases for sharper and
longer cracks.</p>
<p>The Griffith criterion leads to a critical length <span class="math">\(c_0\)</span> below which it is
not energetically favourable for cracks to grow, since the elastic energy
released does not exceed the surface energy cost. Below <span class="math">\(c_0\)</span>, cracks
prefer to close up, meaning that not all flaws are unstable. This explains why
it makes sense to measure the length of cracks e.g. on aeroplanes, so that small
flaws can be identified and treated before they become critical.</p>
<p>In fracture mechanics it is common to use the energy release rate <span class="math">\(G\)</span> to
describe the flow of energy to a crack tip. <span class="math">\(G\)</span> is the driving force for
crack propagation. It is defined by</p>
<div class="math">
\[G = - \frac{\partial U_E}{\partial c}\]</div>
<p>where <span class="math">\(U_E\)</span> is the total strain energy and <cite>c</cite> is the crack length.
The Griffith criterion can be reformulated in terms of <span class="math">\(G\)</span> to show that
crack propagation becomes favourable when</p>
<div class="math">
\[G &gt; 2\gamma\]</div>
<p>where <span class="math">\(\gamma\)</span> is the surface energy density, i.e. when the energy flow to
the crack tip exceeds the cost of creating two new surfaces.</p>
</div>
<div class="section" id="atomic-scale-modelling-of-fracture">
<span id="theory-atomic-fracture"></span><h3>Atomic scale modelling of fracture<a class="headerlink" href="#atomic-scale-modelling-of-fracture" title="Permalink to this headline">¶</a></h3>
<p>Much work has been done to understand fracture at the continuum level
(see, e.g.  <a class="reference internal" href="adaptive-qmmm-references.html#freund1998" id="id3">[Freund1998]</a> and <a class="reference internal" href="adaptive-qmmm-references.html#lawn1993" id="id4">[Lawn1993]</a>), but here we would like to
simulate fracture at the atomic level, to examine the combined effects
of stress and chemistry (‘chemomechanics’). A first approach would be
to use classical interatomic potentials to carry out molecular
dynamics (MD). However, as we will see in <a class="reference internal" href="adaptive-qmmm-step2.html#step2"><span class="std std-ref">Step 2: Classical MD simulation of fracture in Si</span></a>, most classical
potentials fail to accurately reproduce brittle fracture. This is due
to stress concentration which has been shown to diverge as
<span class="math">\(\sigma \sim 1/\sqrt{r}\)</span> near a crack tip <a class="reference internal" href="adaptive-qmmm-references.html#irwin1948" id="id5">[Irwin1948]</a>, leading
to anharmonic stretching and rupture of bonds, which is typically not
well captured by simple interatomic potentials.</p>
<div class="figure align-center" id="id30">
<span id="irwin-sig-yy"></span><a class="reference internal image-reference" href="_images/irwin-sig-yy.png"><img alt="_images/irwin-sig-yy.png" src="_images/irwin-sig-yy.png" style="width: 300px;" /></a>
<p class="caption"><span class="caption-text">Irwin near-field solution for <span class="math">\(\sigma_{yy}\)</span> for a singular crack.
Black is zero stress and yellow very high stress; note the divergence at the
crack tip.</span></p>
</div>
<p>Most potentials overestimate what is called the <em>lattice trapping
barrier</em>, the energy barrier to bond breaking at a crack tip that
arises from the periodicity of the crystalline lattice (in contrast to
continuum methods where the crack tip advances continuously). This
means that when fracture eventually does occur, there is too much
energy available, which is then dissipated by a variety of plasticity
mechanisms such as dislocation emission. This leads to results in
contrast with the expected brittle behaviour.</p>
<p>Interestingly, however, continuum theories and simple potentials agree
with one another until surprisingly close to the crack tip (~1nm),
where non-linear effects become important, as illustrated in the
figure below.</p>
<div class="figure align-center" id="id31">
<a class="reference internal image-reference" href="_images/atomistic-vs-continuum.png"><img alt="_images/atomistic-vs-continuum.png" src="_images/atomistic-vs-continuum.png" style="width: 400px;" /></a>
<p class="caption"><span class="caption-text">Atomic and continuum calculations for the stress along the line ahead of a
crack tip in silicon. Agreement is excellent beyond ~ 2 nm from the tip.
Reproduced from G. Singh, J.R. Kermode, A. De Vita, R.W. Zimmerman,
<em>in prep.</em> (2013).</span></p>
</div>
<p>The region where atomistic and continuum theories disagree is the
non-linear <em>process zone</em>, where chemically interesting things are happening.
Here, we would like to treat this region at a quantum mechanical (QM) level.</p>
</div>
<div class="section" id="coupled-multiscale-approach">
<span id="theory-multiscale"></span><h3>Coupled multiscale approach<a class="headerlink" href="#coupled-multiscale-approach" title="Permalink to this headline">¶</a></h3>
<p>QM approaches such as density functional theory (DFT) do correctly
describe bond-breaking in silicon. However, the strong bidirectional
coupling between bond-breaking at the crack tip and the long-range
stress field driving fracture necessitates a multiscale approach. The
reason a fully DFT approach is not practical is that the boundaries of
the model system must be placed far enough away from the crack tip not
to affect the results, which means that large cells containing tens to
hundreds of thousands of atoms are needed. This exceeds the current
capabilities of most QM approaches. Fracture is perhaps the
archetypical coupled multiscale problem, with thousands of atoms
contributing to the elastic relaxation of the near-tip region. We will
describe how classical and QM descriptions can be coupled to study
problems in fracture using the ‘Learn on the Fly’ (LOTF) approach in
<a class="reference internal" href="#theory3"><span class="std std-ref">more detail</span></a> later in this tutorial.</p>
<div class="figure align-center" id="id32">
<a class="reference internal image-reference" href="_images/multiscale-coupling.png"><img alt="_images/multiscale-coupling.png" src="_images/multiscale-coupling.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Hierarchy of materials modelling techniques, showing simultaneous coupling
of QM methods and empirical interatomic potentials. Image source: G. Csányi.</span></p>
</div>
</div>
<div class="section" id="thin-strip-loading-geometry-and-elasticity-theory">
<span id="thin-strip"></span><h3>Thin strip loading geometry and elasticity theory<a class="headerlink" href="#thin-strip-loading-geometry-and-elasticity-theory" title="Permalink to this headline">¶</a></h3>
<p>We will use the thin strip fracture loading geometry illustrated below for our
fracture simulations, where the load is applied by displacing the top and bottom
surfaces.</p>
<a class="reference internal image-reference" href="_images/thin-strip.png"><img alt="_images/thin-strip.png" class="align-center" src="_images/thin-strip.png" style="width: 500px;" /></a>
<p>The advantage of this setup is that the energy release rate <cite>G</cite> does not depend
on the crack length, and can be found analytically by considering the energetics
of an advancing crack.</p>
<p>The horizontal edges of the strip are given a uniform normal
displacement <span class="math">\(\delta\)</span>, so the applied strain is
<span class="math">\(\epsilon_0 = \delta / h\)</span>.  Far ahead of the crack, the strip is
in uniaxial tension: <span class="math">\(\epsilon_{yy} \to \epsilon_0\)</span> as <span class="math">\(x
\to \infty\)</span>.</p>
<p>The stress far ahead of the crack is given by <span class="math">\(\sigma_{0} = E'
\epsilon_{0}\)</span>, and therefore the elastic energy per unit length and
per unit thickness far ahead of the crack tip is</p>
<div class="math">
\[W_\infty = \frac{1}{2}E'\epsilon_0^2\cdot 2h = \frac{\delta^2 E'}{h}\]</div>
<p>where <span class="math">\(E'\)</span> is the effective Young’s modulus.</p>
<p>Far behind the tip, the energy density is zero. Since no energy
disappears through the clamped edges, if the crack is to advance by
unit distance, a vertical strip of material with energy density
<span class="math">\(W_\infty\)</span> is effectively replaced by a strip with energy
density zero.</p>
<p>The energy supplied to the crack tip is therefore equal to <span class="math">\(W_\infty\)</span>,
so the energy release rate is simply</p>
<div class="math">
\[G = W_\infty = \frac{\delta^2 E'}{h}\]</div>
<p>In our simulations we will use periodic boundary conditions in the <span class="math">\(z\)</span>
direction, so we have plane strain loading (<span class="math">\(\epsilon_{zz} = 0\)</span>), which
means that the effective Young’s modulus <span class="math">\(E'\)</span> is given by
<span class="math">\(E/(1-\nu^2)\)</span>, where <span class="math">\(E\)</span> is the Young’s modulus in the <span class="math">\(y\)</span> relevant
direction and <span class="math">\(\nu\)</span> is the Poisson ratio, so finally we have</p>
<div class="math" id="thin-strip-equation">
\[G = \frac{E \delta^2}{(1- \nu^2)h} = \frac{E \epsilon_0^2 h}{1 - \nu^2}\]</div>
<p>We can see that, in order to relate the strain we apply to the system
with the energy release rate, we will need to calculate the Young’s
modulus and Poisson ratio for our model material. We will see how to
do this from the elastic constant matrix <span class="math">\(C_{ij}\)</span> <a class="reference internal" href="adaptive-qmmm-step1.html#youngs-modulus-and-poisson-ratio"><span class="std std-ref">below</span></a>.</p>
</div>
</div>
<div class="section" id="classical-interatomic-potentials-for-silicon">
<h2>Classical interatomic potentials for silicon<a class="headerlink" href="#classical-interatomic-potentials-for-silicon" title="Permalink to this headline">¶</a></h2>
<p>The Stillinger-Weber <a class="reference internal" href="adaptive-qmmm-references.html#stillinger1985" id="id6">[Stillinger1985]</a> interatomic potential provides a fairly good
description of many properties of crystalline and amorphous silicon. Its
functional form is a two- and three-body expansion suitable for the
representation of highly directional covalent bonds between Si atoms:</p>
<div class="math">
\[\begin{split}V = \sum_{ij} V_2(r_{ij}) + \sum_{ijk} V_3(r_{ij}, r_{ik},
\theta_{jik}) \\
V_2(r_{ij}) = A\left(\frac{B}{r_{ij}^4} - 1\right) \exp
\frac{1}{r-a}, \; r &lt; a \\
V_3(r_{ij},r_{jk},\theta_{jik}) = \lambda \exp \left[
\frac{\gamma}{r_{ij} - a} + \frac{\gamma}{r_{jk} - a} \right] \left(\cos
\theta_{jik} + \frac{1}{3}\right)\end{split}\]</div>
<p>In particular, the three-body term stabilises the ideal tetrahedral
structure with respect to all the other possible structures. The
parameters of the SW potential were determined by fitting experimental
data with the constraint that the diamond-like structure must be the
most stable periodic arrangement of particles al low pressures.</p>
<p>Although this potential has not been fitted to the Si elastic
constants, it gives a reasonable description of all of them. As we
will see during this step, however, the SW potential fails to describe
the brittle fracture of silicon.  A number of interatomic potentials
have been developed to go beyond the basic description of Si provided
by the SW potential (e.g. <a class="reference internal" href="adaptive-qmmm-references.html#swadener2002" id="id7">[Swadener2002]</a>, <a class="reference internal" href="adaptive-qmmm-references.html#vink2001" id="id8">[Vink2001]</a> <a class="reference internal" href="adaptive-qmmm-references.html#buehler2006" id="id9">[Buehler2006]</a>,
<a class="reference internal" href="adaptive-qmmm-references.html#pizzagalli2013" id="id10">[Pizzagalli2013]</a>), however, they are usually not sufficiently
transferable to provide a general description of the inherently
quantum-mechanical processes occurring at the tip of a crack. As a
consequence, treating the tip at the QM level using hybrid QM/MM
methods is necessary to perform accurate MD simulations of brittle
fracture in Si. Here, we will use the SW potential because its simple
functional form and its speed make it a suitable choice for a
multiscale QM/MM approach, where only an accurate description of the
Si crystal far from the crack tip is required.</p>
<p>In this step, we will use the SW potential to perform a classical MD
simulation of the crack propagation in the NVE ensemble. The velocity
Verlet scheme <a class="reference internal" href="adaptive-qmmm-references.html#frenkelsmit2001" id="id11">[FrenkelSmit2001]</a> will be used to integrate Newton’s
equations of motion.</p>
</div>
<div class="section" id="qm-mm-force-mixing-and-the-learn-on-the-fly-scheme">
<span id="theory3"></span><h2>QM/MM Force Mixing and the ‘Learn on the Fly’ scheme<a class="headerlink" href="#qm-mm-force-mixing-and-the-learn-on-the-fly-scheme" title="Permalink to this headline">¶</a></h2>
<p>In this last part of the tutorial, we will perform an accurate MD simulation of
Si fracture using the “Learn on the fly” (LOTF) hybrid QM/MM technique
<a class="reference internal" href="adaptive-qmmm-references.html#devita1998" id="id12">[DeVita1998]</a>, <a class="reference internal" href="adaptive-qmmm-references.html#csanyi2004" id="id13">[Csanyi2004]</a>. In the present case, all atoms that are not suitably described by
the <a class="reference internal" href="adaptive-qmmm-references.html#stillinger1985" id="id14">[Stillinger1985]</a> potential (our MM scheme) will be treated
quantum-mechanically with the DFTB method <a class="reference internal" href="adaptive-qmmm-references.html#elstner1998" id="id15">[Elstner1998]</a>. These atoms are
those in the vicinity of the crack tip, where highly strained Si-Si bonds are
present, and where formation and rupture of chemical bonds occurs during
crack propagation.</p>
<p>Standard QM/MM techniques, usually developed for biological systems, adopt
energy-based approaches. The total energy of the system is written as a combination
of the QM energy, the MM energy and a QM/MM term, often specifically devised
for a particular system, that takes care of the interaction between the two regions.
While this approach allows the definition of a total energy which is
conserved during the dynamics, the forces used to propagate the MD are not accurate
enough because of the spurious effects due to the presence of the boundary
between the QM and the MM regions. Moreover, the necessity to suitably “terminate”
the QM region, does not allow the QM region to move during the simulation, which
is, however, required if we want to follow the motion of a crack tip.</p>
<p>The LOTF scheme adopts a force-based scheme instead, which allows the
QM region to move during the MD simulation and accurate forces to be
calculated even at the boundaries of the two regions. While the
details of the scheme have been thoroughly presented in a number of
articles <a class="reference internal" href="adaptive-qmmm-references.html#devita1998" id="id16">[DeVita1998]</a>, <a class="reference internal" href="adaptive-qmmm-references.html#csanyi2004" id="id17">[Csanyi2004]</a>, <a class="reference internal" href="adaptive-qmmm-references.html#csanyi2005" id="id18">[Csanyi2005]</a>, <a class="reference internal" href="adaptive-qmmm-references.html#moras2010" id="id19">[Moras2010]</a>,
<a class="reference internal" href="adaptive-qmmm-references.html#kermode2008a" id="id20">[Kermode2008a]</a>, <a class="reference internal" href="adaptive-qmmm-references.html#bernstein2009" id="id21">[Bernstein2009]</a>, we will here briefly explain the
basic concepts that will allow us to perform the crack simulation.</p>
<div class="section" id="calculation-of-the-forces-buffered-force-mixing">
<span id="buffer"></span><h3>Calculation of the forces: buffered force mixing<a class="headerlink" href="#calculation-of-the-forces-buffered-force-mixing" title="Permalink to this headline">¶</a></h3>
<p>The first problem we have to face, when performing a QM/MM MD simulation is to
calculate accurate forces. While the calculation of the MM forces, using a
short-ranged potential (e.g. the SW potential) is trivially solved by
inexpensively computing the MM forces on the whole system, the problem of
calculating accurate QM forces is more complicated. The ultimate goal of any QM/MM
approach is to perform a simulation where all the system behaves instantaneously
as if it were fully QM. In a standard QM/MM approach, however, the QM forces
would be calculated by carving the QM region out of the system and chemically
terminating the resulting Si dangling bonds, for instance with H atoms. Even by
using more complex termination strategies, it is generally not possible to
mimic the presence of the surrounding MM system, and the forces on the atoms
close to the artificially created “QM surface” are not accurate.</p>
<p>To solve this problem, at the expense of an increased computational
cost, we increase the size of the QM region by adding a “buffer
region”, as illustrated below. The calculation of the QM forces is
carried out on a cluster made from the QM + buffer regions, after
suitable termination with H atoms.</p>
<div class="figure align-center" id="id33">
<a class="reference internal image-reference" href="_images/buffer-region.png"><img alt="_images/buffer-region.png" src="_images/buffer-region.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-text">The finite buffer termination strategy. Force on the atoms in the buffer
region (dark grey) are discarded to give accurate QM or MM forces on all atoms
(right hand panel). Reproduced from <a class="reference internal" href="adaptive-qmmm-references.html#bernstein2009" id="id22">[Bernstein2009]</a>.</span></p>
</div>
<p>The buffer region must be large enough to minimize the errors on the QM forces
due to the presence of the outer artificial surface. The size of the buffer
region can be determined through some tests (see <a class="reference internal" href="adaptive-qmmm-step3.html#buffer-region-size"><span class="std std-ref">this extension task</span></a>) , and is typically around 8 A, or 4 neighbour hops, for
Si. This near-sightedness of quantum mechanics is ultimately due to the locality
of the density matrix in covalent materials.</p>
<p>Once accurate QM forces have been obtained, only the QM forces on the atoms
belonging to the original QM region are used in the MD. The QM forces on the
atoms in the buffer region, which are strongly affected by the presence of the
outer QM surface, are discarded and replaced by the MM forces (as illustrated
above). In this way, we can obtain good forces on all atoms in the
system. These forces can be used in the MD simulation, provided that the
conservation of the total momentum is restored. This can be enforced by
subtracting the (typically small) mean force, so that the final
QM/MM forces sum to zero.</p>
<p>It is important to have good elastic matching between the QM and MM models, so
that there is no discontinuity at the boundary. For simple materials, this can
usually be achieved by scaling the classical model in space and energy to match
the lattice constant and bulk modulus of the QM model (for simplicity we omit
this step in this tutorial, but the mismatch here is not too big).</p>
</div>
<div class="section" id="hysteretic-selection-of-the-qm-active-and-buffer-regions">
<span id="hysteretic"></span><h3>Hysteretic selection of the QM active and buffer regions<a class="headerlink" href="#hysteretic-selection-of-the-qm-active-and-buffer-regions" title="Permalink to this headline">¶</a></h3>
<p>A key advantage of the buffered force mixing approach is that the QM region can
be redefined during a simulation. This works because new atoms first enter the
QM calculation at the outer boundary of the buffer region, where they do not
have a large effect on the forces at the centre, and therefore changing the QM
region does not introduce large inconsistencies.</p>
<p>In this tutorial, the QM region will be updated during the MD simulation in
order to follow the motion of the crack tip. When selecting the atoms that
belong to the buffered QM region, it is important to minimise fluctuations in
the set of QM atoms. This should be done in order to minimise the spurious heat
generation due to atoms whose description changes from MM to QM, or vice-versa
<a class="reference internal" href="adaptive-qmmm-references.html#bernstein2009" id="id23">[Bernstein2009]</a>. This change of description is inevitable when the QM region
moves with the crack tip. However, solutions have to be found to minimise
fluctuations due to oscillation.</p>
<p>A robust way to minimise fluctuations is to employ a “hysteretic” algorithm for
the QM selection process <a class="reference internal" href="adaptive-qmmm-references.html#bernstein2009" id="id24">[Bernstein2009]</a>. In the context of a fracture
simulation, atoms have to come within a certain <em>inner
radius</em> <span class="math">\(r_\mathrm{-}\)</span> from the crack tip to become selected as QM active
atoms (see the picture below). In our case, atoms have to come within 8 A from
the crack tip to become part of the QM region. However, using the hysteretic
algorithm, these atoms will remain QM until they move further than the
<em>outer radius</em> <span class="math">\(r_\mathrm{+}\)</span> (where <span class="math">\(r_\mathrm{+} &gt; r_\mathrm{-}\)</span>)
away from the crack tip. In our simulation, this outer radius will be 10 A. We
refer to the current set of QM atoms in as the <em>QM active region</em>.</p>
<div class="figure align-center" id="id34">
<a class="reference internal image-reference" href="_images/hysteresis.png"><img alt="_images/hysteresis.png" src="_images/hysteresis.png" style="height: 200px;" /></a>
<p class="caption"><span class="caption-text">Hysteretic QM selection algorithm. For fracture simulations the black <em>active region</em>
can be reduced to a single point at the crack tip. Reproduced from <a class="reference internal" href="adaptive-qmmm-references.html#bernstein2009" id="id25">[Bernstein2009]</a>.</span></p>
</div>
<p>As well as using hysteresis to select the QM active atoms for which QM
forces will be used, we can also use the hysteretic selection
algorithm to minimise fluctuations in the buffer region. These radii
apply to the distance from any of the QM active atoms, so the buffer
takes the form of a shell of constant width around the QM atoms. Here
we will use inner and outer buffer radii of 7 A and 9 A, respectively.
This leads to overall QM active + buffer clusters with a radius of
around 15 A, containing around 150 atoms, including terminating
hydrogens (see the <a class="reference internal" href="adaptive-qmmm-step3.html#cluster"><span class="std std-ref">example cluster</span></a> below).</p>
<p>Further tricks which can be used to stabilise the QM and buffer region include
growing the regions using bond hopping rather than distance criteria, and using
time-averaged positions <a class="reference internal" href="adaptive-qmmm-references.html#bernstein2009" id="id26">[Bernstein2009]</a>. For simplicity, in this tutorial we
will use only the hysteretic selection technique.</p>
</div>
<div class="section" id="lotf-adjustable-potential-and-predictor-corrector-scheme">
<span id="lotf"></span><h3>LOTF adjustable potential and predictor-corrector scheme<a class="headerlink" href="#lotf-adjustable-potential-and-predictor-corrector-scheme" title="Permalink to this headline">¶</a></h3>
<p>The QM/MM forces calculated as just explained, using a buffered QM region, can
be directly used to perform an MD simulation, provided that the total sum of the
forces is constrained to be zero, as explained above. However, in many cases,
and in particular in this Si crack case, we can use yet another “trick” to speed
up our MD simulation, by at least a factor 10.</p>
<p>We first introduce a new Hamiltonian, which is the sum of the MM potential (the
SW potential here) and of a so called <em>adjustable potential</em>. This potential has
a general analytical expression and a set of parameters that can be adjusted. In
this case, we will use a simple two-body linear ‘spring’ potential with the form</p>
<div class="math">
\[V_\mathrm{adj} = \sum_{\mathrm{pairs}\; ij} \alpha_{ij} r_{ij}\]</div>
<p>where <span class="math">\(i\)</span> and <span class="math">\(j\)</span> indicate a pair of atoms which are closer than an
arbitrary spring length (typically around 3 neighbour hops),
and <span class="math">\(\{\alpha_{ij}\}\)</span> are the set of adjustable parameters. We then define
a <em>fitting region</em>, typically slightly larger than the buffered QM region.</p>
<p>Our adjustable potential is then used to fit the difference between the QM and
the MM forces for each atom in this fitting region. (The functional form above is
particularly suitable as it can be optimised using linear algebra). Of course,
this difference will be zero for atoms in the fitting region that do not belong
to the QM region. In this way, after a successful force matching, the gradient
of our sum potential <span class="math">\(-\nabla (V_{SW}(\mathbf{r})+
V_{adj}(\mathbf{r},\{\alpha\}))\)</span> gives us the MM forces on the MM atoms and the QM
forces on the QM atoms. Of course a very small error on these forces
(typically <span class="math">\(\sim 10^{-3}\)</span> eV/A) is caused by requiring our forces to be
the gradient of a single Hamiltonian. This is however of the same order as the
error introduced by forcing the total sum of the forces to zero, and less than
the error associated with computing QM forces using clusters with a finite
buffer radius (which can be as much as <span class="math">\(\sim 0.1\)</span> eV/A compared to a
reference QM calculation in the full system with PBC). The figure below
illustrates the force fitting process.</p>
<a class="reference internal image-reference" href="_images/lotf-overview.png"><img alt="_images/lotf-overview.png" class="align-center" src="_images/lotf-overview.png" style="width: 500px;" /></a>
<p>The definition of this new adjustable potential is very beneficial to
our simulation because it allows us to employ a predictor-corrector
algorithm that, as mentioned before, significantly speeds up our
simulation. This scheme is based on the possibility of varying the
values of the adjustable potential parameters <span class="math">\(\{\alpha_{ij}\}\)</span>
in both time and in space (i.e. each two-body term of the potential
has an independent parameter <span class="math">\(\alpha_{ij}\)</span>). Once these
parameters are adjusted to match the QM/MM forces in the fitting
region, we do not necessarily need to perform this fitting procedure
at the next time step. In many cases, in fact, the parameters would
change very slowly with respect to the changing atomic positions. This
means that the same parameters can be used for a small number of steps
(e.g. 10 in our case), after which the expensive QM forces are
recomputed, and then used to retune the parameters. This is the
philosophy behind the ‘Learn on the Fly’ approach.</p>
<p>The predictor-corrector scheme works as follows, with reference to the illustration below:</p>
<blockquote>
<div><p>1. <strong>Initialisation.</strong> The QM region is selected, the buffered QM/MM forces are
calculated and the parameters of the adjustable potential are adjusted to
reproduce the difference between QM and MM forces in the fitting region.</p>
<p>2. <strong>MD predictor: Extrapolation.</strong> The
classical <span class="math">\(V_\mathrm{SW}+V_\mathrm{adj}\)</span> is used
with the fixed set of adjusted parameters <span class="math">\(\alpha_0\)</span> to evolve the
dynamics of the whole system starting from the positions <span class="math">\(R_0\)</span> for a small
number <span class="math">\(N\)</span> of steps of size <span class="math">\(\Delta t\)</span> for a total time
of <span class="math">\(\Delta T = N\Delta t\)</span>.</p>
<p>3. <strong>QM/MM forces.</strong> The buffered QM region method is used to compute the QM/MM
forces on the new configuration <span class="math">\(R_1'\)</span>.</p>
<p>4. <strong>Force matching.</strong> The parameters of the adjustable potential are tuned to
reproduce the difference between the new QM forces and the new MM forces to give a
new set of adjustable potential parameters <span class="math">\(\alpha_1\)</span>.</p>
<p>5. <strong>MD corrector: Interpolation.</strong> The formerly predicted MD steps are now
corrected by returning the system to <span class="math">\(R_0\)</span>, and
re-running the dynamics with the adjustable potential
parameters linear interpolated between <span class="math">\(\alpha_0\)</span> and <span class="math">\(\alpha_1\)</span>.</p>
</div></blockquote>
<p>We then return to step 2. and iterate.</p>
<a class="reference internal image-reference" href="_images/lotf-pred-corr.png"><img alt="_images/lotf-pred-corr.png" class="align-center" src="_images/lotf-pred-corr.png" style="width: 500px;" /></a>
<p>The number of extrapolation steps that can be made before the potential
parameters change too much can be checked by keeping an eye on the force errors
made by the LOTF scheme in comparison with doing a QM force evaluation at each
time step: there is an <a class="reference internal" href="adaptive-qmmm-step3.html#pred-corr-error"><span class="std std-ref">extension task</span></a> at the end of
this tutorial to do exactly that.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="adaptive-qmmm-step1.html" class="btn btn-neutral float-right" title="Step 1: Setup of the Silicon model system" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="adaptive-qmmm-step0.html" class="btn btn-neutral" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2008-2016, James Kermode.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'967e02c+',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Molecular Dynamics &mdash; quippy 7470022 documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '7470022',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="quippy 7470022 documentation" href="index.html" />
    <link rel="up" title="Quippy library reference" href="quippy.html" />
    <link rel="prev" title="Utilities for topological analysis" href="topology.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="topology.html" title="Utilities for topological analysis"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">quippy 7470022 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="quippy.html" accesskey="U">Quippy library reference</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/hybrid.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="topology.html"
                        title="previous chapter">Utilities for topological analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/dynamicalsystem.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-quippy.dynamicalsystem">
<span id="molecular-dynamics"></span><h1>Molecular Dynamics<a class="headerlink" href="#module-quippy.dynamicalsystem" title="Permalink to this headline">¶</a></h1>
<p>A DynamicalSystem object contains an Atoms object, which holds infomation about
velocities and accelerations of each atom, scalar quantities such as
thermostat settings, and logical masks so that thermostatting can be applied
to selected atoms etc.</p>
<p>In Fortran code, initialise a DynamicalSystem object like this:</p>
<div class="highlight-python"><div class="highlight"><pre>call initialise(MyDS, MyAtoms)
</pre></div>
</div>
<p>which (shallowly) copies MyAtoms into the internal atoms structure (and so
MyAtoms is not required by MyDS after this call and can be finalised). In Python,
a DynamicalSystem can be initialised from an Atoms instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">MyDS</span> <span class="o">=</span> <span class="n">DynamicalSystem</span><span class="p">(</span><span class="n">MyAtoms</span><span class="p">)</span>
</pre></div>
</div>
<p>A DynamicalSystem is constructed from an Atoms object
<code class="docutils literal"><span class="pre">atoms</span></code>. The initial velocities and accelerations can optionally be
specificed as <code class="docutils literal"><span class="pre">(3,atoms.n)</span></code> arrays. The <code class="docutils literal"><span class="pre">constraints</span></code> and
<code class="docutils literal"><span class="pre">rigidbodies</span></code> arguments can be used to specify the number of
constraints and rigid bodies respectively (the default is zero in
both cases).</p>
<p>DynamicalSystem has an integrator,</p>
<div class="highlight-python"><div class="highlight"><pre>call advance_verlet(MyDS,dt,forces)
</pre></div>
</div>
<p>which takes a set of forces and integrates the equations of motion forward
for a time <code class="docutils literal"><span class="pre">dt</span></code>.</p>
<p>All dynamical variables are stored inside the Atoms&#8217; <a class="reference internal" href="atoms.html#quippy.atoms.Atoms.properties" title="quippy.atoms.Atoms.properties"><code class="xref py py-attr docutils literal"><span class="pre">properties</span></code></a> Dictionary.</p>
<p>Module contents for <a class="reference internal" href="#module-quippy.dynamicalsystem" title="quippy.dynamicalsystem: Run molecular dynamics simulations"><code class="xref py py-mod docutils literal"><span class="pre">quippy.dynamicalsystem</span></code></a>:</p>
<p class="rubric">Classes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem" title="quippy.dynamicalsystem.DynamicalSystem"><code class="xref py py-obj docutils literal"><span class="pre">DynamicalSystem</span></code></a>(...)</td>
<td>Initialise this DynamicalSystem from an Atoms object</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics" title="quippy.dynamicalsystem.Dynamics"><code class="xref py py-obj docutils literal"><span class="pre">Dynamics</span></code></a>(atoms,&nbsp;timestep,&nbsp;trajectory[,&nbsp;...])</td>
<td>Wrapper around <a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem" title="quippy.dynamicalsystem.DynamicalSystem"><code class="xref py py-class docutils literal"><span class="pre">DynamicalSystem</span></code></a> integrator compatible with ASE <code class="xref py py-class docutils literal"><span class="pre">ase.md.MolecularDynamics</span></code> interface.</td>
</tr>
</tbody>
</table>
<p class="rubric">Functions</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="72%" />
<col width="28%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">TYPE_ATOM</span></code></td>
<td>1</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">TYPE_IGNORE</span></code></td>
<td>0</td>
</tr>
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">TYPE_RIGID</span></code></td>
<td>3</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">TYPE_CONSTRAINED</span></code></td>
<td>2</td>
</tr>
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">fs</span></code></td>
<td>0.0982269353155</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_PR</span></code></td>
<td>5</td>
</tr>
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_NOSE_HOOVER</span></code></td>
<td>2</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_OU</span></code></td>
<td>8</td>
</tr>
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_NPT</span></code></td>
<td>4</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_NONE</span></code></td>
<td>0</td>
</tr>
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_NPH_PR</span></code></td>
<td>7</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_ALL_PURPOSE</span></code></td>
<td>10</td>
</tr>
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_NPT_NB</span></code></td>
<td>9</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_LANGEVIN</span></code></td>
<td>1</td>
</tr>
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_NPH_ANDERSEN</span></code></td>
<td>6</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">THERMOSTAT_NOSE_HOOVER_LANGEVIN</span></code></td>
<td>3</td>
</tr>
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">BAROSTAT_NONE</span></code></td>
<td>0</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-attr docutils literal"><span class="pre">BAROSTAT_HOOVER_LANGEVIN</span></code></td>
<td>1</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="quippy.dynamicalsystem.DynamicalSystem">
<em class="property">class </em><code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">DynamicalSystem</code><span class="sig-paren">(</span><em>atoms_in</em><span class="optional">[</span>, <em>velocity</em>, <em>acceleration</em>, <em>constraints</em>, <em>restraints</em>, <em>rigidbodies</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#DynamicalSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">quippy._dynamicalsystem.DynamicalSystem</span></code></p>
<p>Initialise this DynamicalSystem from an Atoms object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atoms_in</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<p><strong>velocity</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1), optional</p>
<p><strong>acceleration</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3), optional</p>
<p><strong>constraints</strong> :  input int, optional</p>
<p><strong>restraints</strong> :  input int, optional</p>
<p><strong>rigidbodies</strong> :  input int, optional</p>
<p class="last"><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">__init__initialise</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.
Class is wrapper around Fortran type <code class="docutils literal"><span class="pre">DynamicalSystem</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.avg_temp" title="quippy.dynamicalsystem.DynamicalSystem.avg_temp"><code class="xref py py-obj docutils literal"><span class="pre">avg_temp</span></code></a></td>
<td>Time-averaged temperature</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.avg_time" title="quippy.dynamicalsystem.DynamicalSystem.avg_time"><code class="xref py py-obj docutils literal"><span class="pre">avg_time</span></code></a></td>
<td>Averaging time, in fs</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.cur_temp" title="quippy.dynamicalsystem.DynamicalSystem.cur_temp"><code class="xref py py-obj docutils literal"><span class="pre">cur_temp</span></code></a></td>
<td>Current temperature</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.dt" title="quippy.dynamicalsystem.DynamicalSystem.dt"><code class="xref py py-obj docutils literal"><span class="pre">dt</span></code></a></td>
<td>Last time step</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.dw" title="quippy.dynamicalsystem.DynamicalSystem.dw"><code class="xref py py-obj docutils literal"><span class="pre">dw</span></code></a></td>
<td>Increment of work done this time step</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.ekin" title="quippy.dynamicalsystem.DynamicalSystem.ekin"><code class="xref py py-obj docutils literal"><span class="pre">ekin</span></code></a></td>
<td>Current kinetic energy</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.epot" title="quippy.dynamicalsystem.DynamicalSystem.epot"><code class="xref py py-obj docutils literal"><span class="pre">epot</span></code></a></td>
<td>Total potential energy</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.ext_energy" title="quippy.dynamicalsystem.DynamicalSystem.ext_energy"><code class="xref py py-obj docutils literal"><span class="pre">ext_energy</span></code></a></td>
<td>Extended energy</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.n" title="quippy.dynamicalsystem.DynamicalSystem.n"><code class="xref py py-obj docutils literal"><span class="pre">n</span></code></a></td>
<td>Number of atoms</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.nconstraints" title="quippy.dynamicalsystem.DynamicalSystem.nconstraints"><code class="xref py py-obj docutils literal"><span class="pre">nconstraints</span></code></a></td>
<td>Number of constraints</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.ndof" title="quippy.dynamicalsystem.DynamicalSystem.ndof"><code class="xref py py-obj docutils literal"><span class="pre">ndof</span></code></a></td>
<td>Number of degrees of freedom</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.nrestraints" title="quippy.dynamicalsystem.DynamicalSystem.nrestraints"><code class="xref py py-obj docutils literal"><span class="pre">nrestraints</span></code></a></td>
<td>Number of restraints</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.nrigid" title="quippy.dynamicalsystem.DynamicalSystem.nrigid"><code class="xref py py-obj docutils literal"><span class="pre">nrigid</span></code></a></td>
<td>Number of rigid bodies</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.nsteps" title="quippy.dynamicalsystem.DynamicalSystem.nsteps"><code class="xref py py-obj docutils literal"><span class="pre">nsteps</span></code></a></td>
<td>Number of integration steps</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.random_seed" title="quippy.dynamicalsystem.DynamicalSystem.random_seed"><code class="xref py py-obj docutils literal"><span class="pre">random_seed</span></code></a></td>
<td>RNG seed, used by <code class="docutils literal"><span class="pre">ds_save_state</span></code> and <code class="docutils literal"><span class="pre">ds_restore_state</span></code> only.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.t" title="quippy.dynamicalsystem.DynamicalSystem.t"><code class="xref py py-obj docutils literal"><span class="pre">t</span></code></a></td>
<td>Time</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.thermostat_dw" title="quippy.dynamicalsystem.DynamicalSystem.thermostat_dw"><code class="xref py py-obj docutils literal"><span class="pre">thermostat_dw</span></code></a></td>
<td>Increment of work done by thermostat</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.thermostat_work" title="quippy.dynamicalsystem.DynamicalSystem.thermostat_work"><code class="xref py py-obj docutils literal"><span class="pre">thermostat_work</span></code></a></td>
<td>Total work done by thermostat</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.wkin" title="quippy.dynamicalsystem.DynamicalSystem.wkin"><code class="xref py py-obj docutils literal"><span class="pre">wkin</span></code></a></td>
<td>Current kinetic contribution to the virial</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.work" title="quippy.dynamicalsystem.DynamicalSystem.work"><code class="xref py py-obj docutils literal"><span class="pre">work</span></code></a></td>
<td>Total work done</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem.run" title="quippy.dynamicalsystem.DynamicalSystem.run"><code class="xref py py-obj docutils literal"><span class="pre">run</span></code></a>(...)</td>
<td>Run <code class="docutils literal"><span class="pre">n_steps</span></code> of dynamics using forces from Potential <code class="docutils literal"><span class="pre">pot</span></code>.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.add_atoms">
<code class="descname">add_atoms</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.add_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Add one or more atoms to this DynamicalSystem. Equivalent to &#8216;Atoms%add_atoms&#8217;,
but also appends the number of degrees of freedom correctly.</p>
<p>Wrapper around Fortran interface <code class="docutils literal"><span class="pre">add_atoms</span></code> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<code class="descname">add_atoms</code><span class="sig-paren">(</span><em>z</em><span class="optional">[</span>, <em>mass</em>, <em>p</em>, <em>v</em>, <em>a</em>, <em>t</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>mass</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n1), optional</em>) &#8211; </li>
<li><strong>p</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3), optional</em>) &#8211; </li>
<li><strong>v</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n4,qp_n5), optional</em>) &#8211; </li>
<li><strong>a</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n6,qp_n7), optional</em>) &#8211; </li>
<li><strong>t</strong> (<em>input rank-2 array(&#8216;i&#8217;) with bounds (qp_n8,qp_n9), optional</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">ds_add_atom_multiple</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descname">add_atoms</code><span class="sig-paren">(</span><em>z</em><span class="optional">[</span>, <em>mass</em>, <em>p</em>, <em>v</em>, <em>a</em>, <em>t</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>z</strong> (<em>input int</em>) &#8211; </li>
<li><strong>mass</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>p</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (3), optional</em>) &#8211; </li>
<li><strong>v</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (3), optional</em>) &#8211; </li>
<li><strong>a</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (3), optional</em>) &#8211; </li>
<li><strong>t</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (3), optional</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">ds_add_atom_single</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.add_constraint">
<code class="descname">add_constraint</code><span class="sig-paren">(</span><em>atoms</em>, <em>func</em>, <em>data</em><span class="optional">[</span>, <em>update_ndof</em>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.add_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a constraint to the DynamicalSystem and reduce the number of degrees of freedom,
unless <code class="docutils literal"><span class="pre">update_Ndof</span></code> is present and false.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>atoms</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</p>
<p><strong>func</strong> :  input int</p>
<p><strong>data</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n1)</p>
<p><strong>update_ndof</strong> :  input int, optional</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">ds_add_constraint</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.add_thermostat">
<code class="descname">add_thermostat</code><span class="sig-paren">(</span><em>type</em>, <em>t</em><span class="optional">[</span>, <em>gamma</em>, <em>q</em>, <em>tau</em>, <em>tau_cell</em>, <em>p</em>, <em>bulk_modulus_estimate</em>, <em>cell_oscillation_time</em>, <em>nhl_tau</em>, <em>nhl_mu</em>, <em>massive</em>, <em>region_i</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.add_thermostat" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new thermostat to this DynamicalSystem. <code class="docutils literal"><span class="pre">type</span></code> should
be one of the following thermostat types:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">THERMOSTAT_NONE</span></code></li>
<li><code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN</span></code></li>
<li><code class="docutils literal"><span class="pre">THERMOSTAT_NOSE_HOOVER</span></code></li>
<li><code class="docutils literal"><span class="pre">THERMOSTAT_NOSE_HOOVER_LANGEVIN</span></code></li>
<li><code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_NPT</span></code></li>
<li><code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_PR</span></code></li>
<li><code class="docutils literal"><span class="pre">THERMOSTAT_NPH_ANDERSEN</span></code></li>
<li><code class="docutils literal"><span class="pre">THERMOSTAT_NPH_PR</span></code></li>
<li><code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_OU</span></code></li>
<li><code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_NPT_NB</span></code></li>
</ul>
<p><code class="docutils literal"><span class="pre">T</span></code> is the target temperature. <code class="docutils literal"><span class="pre">Q</span></code> is the Nose-Hoover coupling constant. Only one
of <code class="docutils literal"><span class="pre">tau</span></code> or <code class="docutils literal"><span class="pre">gamma</span></code> should be given. <code class="docutils literal"><span class="pre">p</span></code> is the external
pressure for the case of Langevin NPT.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>type</strong> :  input int</p>
<p><strong>t</strong> :  input float</p>
<p><strong>gamma</strong> :  input float, optional</p>
<p><strong>q</strong> :  input float, optional</p>
<p><strong>tau</strong> :  input float, optional</p>
<p><strong>tau_cell</strong> :  input float, optional</p>
<p><strong>p</strong> :  input float, optional</p>
<p><strong>bulk_modulus_estimate</strong> :  input float, optional</p>
<p><strong>cell_oscillation_time</strong> :  input float, optional</p>
<p><strong>nhl_tau</strong> :  input float, optional</p>
<p><strong>nhl_mu</strong> :  input float, optional</p>
<p><strong>massive</strong> :  input int, optional</p>
<p class="last"><strong>region_i</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">add_thermostat</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.add_thermostats">
<code class="descname">add_thermostats</code><span class="sig-paren">(</span><em>type</em>, <em>n</em><span class="optional">[</span>, <em>t</em>, <em>t_a</em>, <em>gamma</em>, <em>gamma_a</em>, <em>q</em>, <em>q_a</em>, <em>tau</em>, <em>tau_a</em>, <em>region_i</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.add_thermostats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>type</strong> :  input int</p>
<p><strong>n</strong> :  input int</p>
<p><strong>t</strong> :  input float, optional</p>
<p><strong>t_a</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0), optional</p>
<p><strong>gamma</strong> :  input float, optional</p>
<p><strong>gamma_a</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n1), optional</p>
<p><strong>q</strong> :  input float, optional</p>
<p><strong>q_a</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n2), optional</p>
<p><strong>tau</strong> :  input float, optional</p>
<p><strong>tau_a</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n3), optional</p>
<p class="last"><strong>region_i</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">add_thermostats</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.advance_verlet">
<code class="descname">advance_verlet</code><span class="sig-paren">(</span><em>ds</em>, <em>dt</em>, <em>f</em><span class="optional">[</span>, <em>virial</em>, <em>e</em>, <em>parallel</em>, <em>store_constraint_force</em>, <em>do_calc_dists</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.advance_verlet" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls`` advance_verlet2`` followed by <code class="docutils literal"><span class="pre">advance_verlet1</span></code>. Outside this routine the
velocities will be half-stepped. This allows a simpler MD loop:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
    <span class="n">pot</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">advance_verlet</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">force</span><span class="p">)</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">print_status</span><span class="p">(</span><span class="n">epot</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">connect_interval</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
       <span class="n">ds</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">calc_connect</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>ds</strong> : <code class="xref py py-class docutils literal"><span class="pre">dynamicalsystem</span></code> object</p>
<p><strong>dt</strong> :  input float</p>
<p><strong>f</strong> :  in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
<p><strong>virial</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3), optional</p>
<p><strong>e</strong> :  in/output rank-0 array(float,&#8217;d&#8217;), optional</p>
<p><strong>parallel</strong> :  input int, optional</p>
<p><strong>store_constraint_force</strong> :  input int, optional</p>
<p><strong>do_calc_dists</strong> :  input int, optional</p>
<p class="last"><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">advance_verlet</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.advance_verlet1">
<code class="descname">advance_verlet1</code><span class="sig-paren">(</span><em>dt</em><span class="optional">[</span>, <em>virial</em>, <em>parallel</em>, <em>store_constraint_force</em>, <em>do_calc_dists</em>, <em>mpi_obj</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.advance_verlet1" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the velocities by half the time-step <code class="docutils literal"><span class="pre">dt</span></code> and the
positions by a full time-step. A typical MD loop should
resemble the following code (Python example, Fortran is similar):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ds</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">calc_connect</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_steps</span><span class="p">):</span>
   <span class="n">ds</span><span class="o">.</span><span class="n">advance_verlet1</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
   <span class="n">pot</span><span class="o">.</span><span class="n">calc</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
   <span class="n">ds</span><span class="o">.</span><span class="n">advance_verlet2</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">force</span><span class="p">)</span>
   <span class="n">ds</span><span class="o">.</span><span class="n">print_status</span><span class="p">(</span><span class="n">epot</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">connect_interval</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">ds</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">calc_connect</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dt</strong> :  input float</p>
<p><strong>virial</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3), optional</p>
<p><strong>parallel</strong> :  input int, optional</p>
<p><strong>store_constraint_force</strong> :  input int, optional</p>
<p><strong>do_calc_dists</strong> :  input int, optional</p>
<p><strong>mpi_obj</strong> : <a class="reference internal" href="mpi_context.html#quippy.mpi_context.MPI_context" title="quippy.mpi_context.MPI_context"><code class="xref py py-class docutils literal"><span class="pre">MPI_context</span></code></a> object, optional</p>
<p class="last"><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">advance_verlet1</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.advance_verlet2">
<code class="descname">advance_verlet2</code><span class="sig-paren">(</span><em>dt</em>, <em>f</em><span class="optional">[</span>, <em>virial</em>, <em>e</em>, <em>parallel</em>, <em>store_constraint_force</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.advance_verlet2" title="Permalink to this definition">¶</a></dt>
<dd><p>Advances the velocities by the second half time-step</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>dt</strong> :  input float</p>
<p><strong>f</strong> :  in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
<p><strong>virial</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3), optional</p>
<p><strong>e</strong> :  in/output rank-0 array(float,&#8217;d&#8217;), optional</p>
<p><strong>parallel</strong> :  input int, optional</p>
<p><strong>store_constraint_force</strong> :  input int, optional</p>
<p class="last"><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">advance_verlet2</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.amend_constraint">
<code class="descname">amend_constraint</code><span class="sig-paren">(</span><em>constraint</em>, <em>func</em>, <em>data</em><span class="optional">[</span>, <em>k</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.amend_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace a constraint involving some atoms with a different constraint involving
the same atoms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>constraint</strong> :  input int</p>
<p><strong>func</strong> :  input int</p>
<p><strong>data</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</p>
<p class="last"><strong>k</strong> :  input float, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">ds_amend_constraint</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.angular_momentum">
<code class="descname">angular_momentum</code><span class="sig-paren">(</span><span class="optional">[</span><em>origin</em>, <em>indices</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.angular_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the angular momentum of all the atoms in this DynamicalSystem, defined by
<img class="math" src="_images/math/ede2d8f94fbc6c451abbbe27d607904bcef7f7c0.png" alt="\mathbf{L} = \sum_{i} \mathbf{r_i} \times \mathbf{v_i}"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>origin</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3), optional</p>
<p><strong>indices</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_l</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">angular_momentum</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_atom_plane">
<code class="descname">constrain_atom_plane</code><span class="sig-paren">(</span><em>i</em>, <em>plane_n</em><span class="optional">[</span>, <em>d</em>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_atom_plane" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain an atom to lie in a particluar plane</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>i</strong> :  input int</p>
<p><strong>plane_n</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p><strong>d</strong> :  input float, optional</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_atom_plane</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_bondanglecos">
<code class="descname">constrain_bondanglecos</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em><span class="optional">[</span>, <em>c</em>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_bondanglecos" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the bond angle cosine between atoms i, j, and k</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>i</strong> :  input int</p>
<p><strong>j</strong> :  input int</p>
<p><strong>k</strong> :  input int</p>
<p><strong>c</strong> :  input float, optional</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_bondanglecos</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength">
<code class="descname">constrain_bondlength</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>d</em><span class="optional">[</span>, <em>di</em>, <em>t0</em>, <em>tau</em>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the bond between atoms i and j</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>i</strong> :  input int</p>
<p><strong>j</strong> :  input int</p>
<p><strong>d</strong> :  input float</p>
<p><strong>di</strong> :  input float, optional</p>
<p><strong>t0</strong> :  input float, optional</p>
<p><strong>tau</strong> :  input float, optional</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_bondlength</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength_dev_pow">
<code class="descname">constrain_bondlength_dev_pow</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>p</em>, <em>d</em><span class="optional">[</span>, <em>di</em>, <em>t0</em>, <em>tau</em>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength_dev_pow" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the bond between atoms i and j</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>i</strong> :  input int</p>
<p><strong>j</strong> :  input int</p>
<p><strong>p</strong> :  input float</p>
<p><strong>d</strong> :  input float</p>
<p><strong>di</strong> :  input float, optional</p>
<p><strong>t0</strong> :  input float, optional</p>
<p><strong>tau</strong> :  input float, optional</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_bondlength_dev_pow</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength_diff">
<code class="descname">constrain_bondlength_diff</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>d</em><span class="optional">[</span>, <em>di</em>, <em>t0</em>, <em>tau</em>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the difference of bond length between atoms i&#8211;j and j&#8211;k</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>i</strong> :  input int</p>
<p><strong>j</strong> :  input int</p>
<p><strong>k</strong> :  input int</p>
<p><strong>d</strong> :  input float</p>
<p><strong>di</strong> :  input float, optional</p>
<p><strong>t0</strong> :  input float, optional</p>
<p><strong>tau</strong> :  input float, optional</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_bondlength_diff</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength_sq">
<code class="descname">constrain_bondlength_sq</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="optional">[</span>, <em>d</em>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_bondlength_sq" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the bond between atoms i and j</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>i</strong> :  input int</p>
<p><strong>j</strong> :  input int</p>
<p><strong>d</strong> :  input float, optional</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_bondlength_sq</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_gap_energy">
<code class="descname">constrain_gap_energy</code><span class="sig-paren">(</span><em>d</em><span class="optional">[</span>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_gap_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain the energy gap of two resonance structures</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>d</strong> :  input float</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_gap_energy</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_struct_factor_like_i">
<code class="descname">constrain_struct_factor_like_i</code><span class="sig-paren">(</span><em>z</em>, <em>q</em>, <em>sf</em><span class="optional">[</span>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_struct_factor_like_i" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain an atom to lie in a particluar plane</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>z</strong> :  input int</p>
<p><strong>q</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p><strong>sf</strong> :  input float</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_struct_factor_like_i</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_struct_factor_like_mag">
<code class="descname">constrain_struct_factor_like_mag</code><span class="sig-paren">(</span><em>z</em>, <em>q</em>, <em>sf</em><span class="optional">[</span>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_struct_factor_like_mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain an atom to lie in a particluar plane</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>z</strong> :  input int</p>
<p><strong>q</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p><strong>sf</strong> :  input float</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_struct_factor_like_mag</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.constrain_struct_factor_like_r">
<code class="descname">constrain_struct_factor_like_r</code><span class="sig-paren">(</span><em>z</em>, <em>q</em>, <em>sf</em><span class="optional">[</span>, <em>restraint_k</em>, <em>bound</em>, <em>tol</em>, <em>print_summary</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.constrain_struct_factor_like_r" title="Permalink to this definition">¶</a></dt>
<dd><p>Constrain an atom to lie in a particluar plane</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>z</strong> :  input int</p>
<p><strong>q</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p><strong>sf</strong> :  input float</p>
<p><strong>restraint_k</strong> :  input float, optional</p>
<p><strong>bound</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p class="last"><strong>print_summary</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">constrain_struct_factor_like_r</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.disable_damping">
<code class="descname">disable_damping</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.disable_damping" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">disable_damping</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.enable_damping">
<code class="descname">enable_damping</code><span class="sig-paren">(</span><em>damp_time</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.enable_damping" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable damping, with damping time set to <cite>damp_time</cite>. Only atoms
flagged in the <cite>damp_mask</cite> property will be affected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>damp_time</strong> :  input float</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">enable_damping</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.get_damping_time">
<code class="descname">get_damping_time</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.get_damping_time" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_get_damping_time</strong> :  float</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">get_damping_time</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.is_damping_enabled">
<code class="descname">is_damping_enabled</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.is_damping_enabled" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_is_damping_enabled</strong> :  int</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">is_damping_enabled</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.kinetic_energy">
<code class="descname">kinetic_energy</code><span class="sig-paren">(</span><span class="optional">[</span><em>mpi_obj</em>, <em>local_ke</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.kinetic_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total kinetic energy <img class="math" src="_images/math/e74031185d07cfd0bd1566be386399a316a9e624.png" alt="E_k = \sum_{i} \frac{1}{2} m v^2"/></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mpi_obj</strong> : <a class="reference internal" href="mpi_context.html#quippy.mpi_context.MPI_context" title="quippy.mpi_context.MPI_context"><code class="xref py py-class docutils literal"><span class="pre">MPI_context</span></code></a> object, optional</p>
<p><strong>local_ke</strong> :  input int, optional</p>
<p><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_ke</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">kinetic_energy</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.kinetic_virial">
<code class="descname">kinetic_virial</code><span class="sig-paren">(</span><span class="optional">[</span><em>mpi_obj</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.kinetic_virial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total kinetic virial <img class="math" src="_images/math/f394c2f44d750bbad26ca9b3257ec68688ac24d6.png" alt="w_ij = \sum_{k} \frac{1}{2} m v_i v_j"/></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>mpi_obj</strong> : <a class="reference internal" href="mpi_context.html#quippy.mpi_context.MPI_context" title="quippy.mpi_context.MPI_context"><code class="xref py py-class docutils literal"><span class="pre">MPI_context</span></code></a> object, optional</p>
<p><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_kv</strong> :  rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">kinetic_virial</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.momentum">
<code class="descname">momentum</code><span class="sig-paren">(</span><span class="optional">[</span><em>indices</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total momentum <img class="math" src="_images/math/f65d5abc743368c153c92e6f5062a4127a165b1c.png" alt="\mathbf{p} = \sum_i \mathbf{m_i} \mathbf{v_i}"/>.
Optionally only include the contribution of a subset of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>indices</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0), optional</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_p</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (3)</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">momentum</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.n_thermostat">
<code class="descname">n_thermostat</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.n_thermostat" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_n_thermostat</strong> :  int</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">n_thermostat</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.print_">
<code class="descname">print_</code><span class="sig-paren">(</span><span class="optional">[</span><em>file</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.print_" title="Permalink to this definition">¶</a></dt>
<dd><p>Print lots of information about this DynamicalSystem in text format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>file</strong> : <a class="reference internal" href="system.html#quippy.system.InOutput" title="quippy.system.InOutput"><code class="xref py py-class docutils literal"><span class="pre">InOutput</span></code></a> object, optional</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">print_</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.print_status">
<code class="descname">print_status</code><span class="sig-paren">(</span><span class="optional">[</span><em>label</em>, <em>epot</em>, <em>instantaneous</em>, <em>mpi_obj</em>, <em>file</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.print_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a status line showing the current time, temperature, the mean temperature
the total energy and the total momentum for this DynamicalSystem. If present, the optional
<code class="docutils literal"><span class="pre">label</span></code> parameter should be a one character label for the log lines and is printed
in the first column of the output. <code class="docutils literal"><span class="pre">epot</span></code> should be the potential energy
if this is available. <code class="docutils literal"><span class="pre">instantaneous</span></code> has the same meaning as in <code class="docutils literal"><span class="pre">temperature</span></code> routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>label</strong> :  input string(len=-1), optional</p>
<p><strong>epot</strong> :  input float, optional</p>
<p><strong>instantaneous</strong> :  input int, optional</p>
<p><strong>mpi_obj</strong> : <a class="reference internal" href="mpi_context.html#quippy.mpi_context.MPI_context" title="quippy.mpi_context.MPI_context"><code class="xref py py-class docutils literal"><span class="pre">MPI_context</span></code></a> object, optional</p>
<p><strong>file</strong> : <a class="reference internal" href="system.html#quippy.system.InOutput" title="quippy.system.InOutput"><code class="xref py py-class docutils literal"><span class="pre">InOutput</span></code></a> object, optional</p>
<p class="last"><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">ds_print_status</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.print_thermostats">
<code class="descname">print_thermostats</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.print_thermostats" title="Permalink to this definition">¶</a></dt>
<dd><p>ds_print_thermostats</p>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">print_thermostats</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.remove_atoms">
<code class="descname">remove_atoms</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.remove_atoms" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove one or more atoms from this DynamicalSystem. Equivalent of &#8216;Atoms%remove_atoms&#8217;,
but also amends the number of degrees of freedom correctly.</p>
<p>Wrapper around Fortran interface <code class="docutils literal"><span class="pre">remove_atoms</span></code> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<code class="descname">remove_atoms</code><span class="sig-paren">(</span><em>i</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>i</strong> (<em>input int</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">ds_remove_atom_single</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descname">remove_atoms</code><span class="sig-paren">(</span><em>atomlist_in</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>atomlist_in</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">ds_remove_atom_multiple</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.remove_thermostat">
<code class="descname">remove_thermostat</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.remove_thermostat" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> :  input int</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">remove_thermostat</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.rescale_velo">
<code class="descname">rescale_velo</code><span class="sig-paren">(</span><em>temp</em><span class="optional">[</span>, <em>mass_weighted</em>, <em>zero_l</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.rescale_velo" title="Permalink to this definition">¶</a></dt>
<dd><p>Rescale the atomic velocities to temperature <code class="docutils literal"><span class="pre">temp</span></code>. If the
current temperature is zero, we first randomise the velocites.
If <code class="docutils literal"><span class="pre">mass_weighted</span></code> is true, then the velocites are weighted by
<img class="math" src="_images/math/5c57b07fd423ffb29f09fda62a58a2edc00aa785.png" alt="1/sqrt{m}"/>. Linear momentum is zeroed automatically.  If
<code class="docutils literal"><span class="pre">zero_l</span></code> is true then the angular momentum is also zeroed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>temp</strong> :  input float</p>
<p><strong>mass_weighted</strong> :  input int, optional</p>
<p class="last"><strong>zero_l</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">rescale_velo</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.restore_state">
<code class="descname">restore_state</code><span class="sig-paren">(</span><em>to</em>, <em>from</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.restore_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore a DynamicalSystem to a previously saved state.
Only scalar members and <code class="docutils literal"><span class="pre">ds.atoms</span></code> (minus <code class="docutils literal"><span class="pre">ds.atoms%connect</span></code>)
are copied back; <code class="docutils literal"><span class="pre">to</span></code> should be a properly initialised
DynamicalSystem object. The saved state of the random
number generator is also restored. <code class="docutils literal"><span class="pre">calc_dists()</span></code> is
called on the restored atoms object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>to</strong> : <a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem" title="quippy.dynamicalsystem.DynamicalSystem"><code class="xref py py-class docutils literal"><span class="pre">DynamicalSystem</span></code></a> object</p>
<p class="last"><strong>from</strong> : <a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem" title="quippy.dynamicalsystem.DynamicalSystem"><code class="xref py py-class docutils literal"><span class="pre">DynamicalSystem</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">ds_restore_state</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>pot</em>, <em>dt</em>, <em>n_steps</em>, <em>hook</em><span class="optional">[</span>, <em>hook_interval</em>, <em>summary_interval</em>, <em>write_interval</em>, <em>trajectory</em>, <em>args_str</em>, <em>error</em>, <em>hook_extra_args</em><span class="optional">]</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#DynamicalSystem.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run <code class="docutils literal"><span class="pre">n_steps</span></code> of dynamics using forces from Potential <code class="docutils literal"><span class="pre">pot</span></code>.</p>
<p>For each step, forces are evaluated using the Potential
<code class="docutils literal"><span class="pre">pot</span></code> and the DynamicalSystem is advanced by a time <code class="docutils literal"><span class="pre">dt</span></code>
(default 1 fs).  <code class="docutils literal"><span class="pre">n_steps</span></code> (default 10 steps) are carried out in
total, with snapshots saved every <code class="docutils literal"><span class="pre">save_interval</span></code> steps. The
connectivity is recalculated every <code class="docutils literal"><span class="pre">connect_interval</span></code> steps.
<code class="docutils literal"><span class="pre">args_str</span></code> can be used to supply extra arguments to <code class="docutils literal"><span class="pre">Potential.calc</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pot</strong> : <a class="reference internal" href="potential.html#quippy.potential.Potential" title="quippy.potential.Potential"><code class="xref py py-class docutils literal"><span class="pre">Potential</span></code></a> object</p>
<p><strong>dt</strong> :  input float</p>
<p><strong>n_steps</strong> :  input int</p>
<p><strong>hook</strong> :  call-back function</p>
<p><strong>hook_interval</strong> :  input int, optional</p>
<p><strong>summary_interval</strong> :  input int, optional</p>
<p><strong>write_interval</strong> :  input int, optional</p>
<p><strong>trajectory</strong> : <code class="xref py py-class docutils literal"><span class="pre">CInOutput</span></code> object, optional</p>
<p><strong>args_str</strong> :  input string(len=-1), optional</p>
<p class="last"><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">dynamicalsystem_run</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/Potentials/Potential.f95">src/Potentials/Potential.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.save_state">
<code class="descname">save_state</code><span class="sig-paren">(</span><em>to</em>, <em>from</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.save_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the state of a DynamicalSystem. The output object
cannot be used as an initialised DynamicalSystem since
connectivity and group information is not copied to save
memory. Only scalar members and the <code class="docutils literal"><span class="pre">ds.atoms</span></code> object
(minus <code class="docutils literal"><span class="pre">ds.atoms%connect</span></code>) are copied. The current
state of the random number generator is also saved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>to</strong> : <a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem" title="quippy.dynamicalsystem.DynamicalSystem"><code class="xref py py-class docutils literal"><span class="pre">DynamicalSystem</span></code></a> object</p>
<p><strong>from</strong> : <a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem" title="quippy.dynamicalsystem.DynamicalSystem"><code class="xref py py-class docutils literal"><span class="pre">DynamicalSystem</span></code></a> object</p>
<p class="last"><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">ds_save_state</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.set_barostat">
<code class="descname">set_barostat</code><span class="sig-paren">(</span><em>type</em>, <em>p_ext</em>, <em>hydrostatic_strain</em>, <em>diagonal_strain</em>, <em>finite_strain_formulation</em>, <em>tau_epsilon</em><span class="optional">[</span>, <em>w_epsilon</em>, <em>t</em>, <em>w_epsilon_factor</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.set_barostat" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>type</strong> :  input int</p>
<p><strong>p_ext</strong> :  input float</p>
<p><strong>hydrostatic_strain</strong> :  input int</p>
<p><strong>diagonal_strain</strong> :  input int</p>
<p><strong>finite_strain_formulation</strong> :  input int</p>
<p><strong>tau_epsilon</strong> :  input float</p>
<p><strong>w_epsilon</strong> :  input float, optional</p>
<p><strong>t</strong> :  input float, optional</p>
<p class="last"><strong>w_epsilon_factor</strong> :  input float, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">set_barostat</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.temperature">
<code class="descname">temperature</code><span class="sig-paren">(</span><span class="optional">[</span><em>property</em>, <em>value</em>, <em>include_all</em>, <em>instantaneous</em>, <em>mpi_obj</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the temperature, assuming each degree of freedom contributes
<img class="math" src="_images/math/fe498c612521ddb61c9780a490b6c14663bce7d5.png" alt="\frac{1}{2}kT"/>. By default only moving and thermostatted atoms are
included &#8212; this can be overriden by setting <code class="docutils literal"><span class="pre">include_all</span></code> to true.
<code class="docutils literal"><span class="pre">region</span></code> can be used to restrict
the calculation to a particular thermostat
region. <code class="docutils literal"><span class="pre">instantaneous</span></code> controls whether the calculation should
be carried out using the current values of the velocities and
masses, or whether to return the value at the last Verlet step
(the latter is the default).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>property</strong> :  input string(len=-1), optional</p>
<p><strong>value</strong> :  input int, optional</p>
<p><strong>include_all</strong> :  input int, optional</p>
<p><strong>instantaneous</strong> :  input int, optional</p>
<p><strong>mpi_obj</strong> : <a class="reference internal" href="mpi_context.html#quippy.mpi_context.MPI_context" title="quippy.mpi_context.MPI_context"><code class="xref py py-class docutils literal"><span class="pre">MPI_context</span></code></a> object, optional</p>
<p><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_temperature</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">temperature</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.thermostat_temperatures">
<code class="descname">thermostat_temperatures</code><span class="sig-paren">(</span><em>n0</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.thermostat_temperatures" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n0</strong> :  input int</p>
<blockquote>
<div><p>shape(qp_temps,0)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>temps</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">thermostat_temperatures</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.update_thermostat">
<code class="descname">update_thermostat</code><span class="sig-paren">(</span><span class="optional">[</span><em>t</em>, <em>p</em>, <em>i</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.update_thermostat" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>t</strong> :  input float, optional</p>
<p><strong>p</strong> :  input float, optional</p>
<p class="last"><strong>i</strong> :  input int, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">update_thermostat</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.DynamicalSystem.zero_momentum">
<code class="descname">zero_momentum</code><span class="sig-paren">(</span><span class="optional">[</span><em>indices</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.zero_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Change velocities to those that the system would have in the zero momentum frame.
Optionalally zero the total momentum of a subset of atoms, specified by <code class="docutils literal"><span class="pre">indices</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>indices</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0), optional</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">zero_momentum</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.avg_temp">
<code class="descname">avg_temp</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.avg_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Time-averaged temperature</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.avg_time">
<code class="descname">avg_time</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.avg_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Averaging time, in fs</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.cur_temp">
<code class="descname">cur_temp</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.cur_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Current temperature</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.dt">
<code class="descname">dt</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Last time step</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.dw">
<code class="descname">dw</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.dw" title="Permalink to this definition">¶</a></dt>
<dd><p>Increment of work done this time step</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.ekin">
<code class="descname">ekin</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.ekin" title="Permalink to this definition">¶</a></dt>
<dd><p>Current kinetic energy</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.epot">
<code class="descname">epot</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.epot" title="Permalink to this definition">¶</a></dt>
<dd><p>Total potential energy</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.ext_energy">
<code class="descname">ext_energy</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.ext_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Extended energy</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.n">
<code class="descname">n</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.n" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of atoms</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.nconstraints">
<code class="descname">nconstraints</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.nconstraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of constraints</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.ndof">
<code class="descname">ndof</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.ndof" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of degrees of freedom</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.nrestraints">
<code class="descname">nrestraints</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.nrestraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of restraints</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.nrigid">
<code class="descname">nrigid</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.nrigid" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of rigid bodies</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.nsteps">
<code class="descname">nsteps</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.nsteps" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of integration steps</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.random_seed">
<code class="descname">random_seed</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.random_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>RNG seed, used by <code class="docutils literal"><span class="pre">ds_save_state</span></code> and <code class="docutils literal"><span class="pre">ds_restore_state</span></code> only.</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.t">
<code class="descname">t</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.t" title="Permalink to this definition">¶</a></dt>
<dd><p>Time</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.thermostat_dw">
<code class="descname">thermostat_dw</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.thermostat_dw" title="Permalink to this definition">¶</a></dt>
<dd><p>Increment of work done by thermostat</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.thermostat_work">
<code class="descname">thermostat_work</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.thermostat_work" title="Permalink to this definition">¶</a></dt>
<dd><p>Total work done by thermostat</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.wkin">
<code class="descname">wkin</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.wkin" title="Permalink to this definition">¶</a></dt>
<dd><p>Current kinetic contribution to the virial</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.DynamicalSystem.work">
<code class="descname">work</code><a class="headerlink" href="#quippy.dynamicalsystem.DynamicalSystem.work" title="Permalink to this definition">¶</a></dt>
<dd><p>Total work done</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="quippy.dynamicalsystem.Dynamics">
<em class="property">class </em><code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">Dynamics</code><span class="sig-paren">(</span><em>atoms</em>, <em>timestep</em>, <em>trajectory</em>, <em>trajectoryinterval=10</em>, <em>initialtemperature=None</em>, <em>logfile='-'</em>, <em>loginterval=1</em>, <em>loglabel='D'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="http://docs.python.org/2.7/library/functions.html#object" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">object</span></code></a></p>
<p>Wrapper around <a class="reference internal" href="#quippy.dynamicalsystem.DynamicalSystem" title="quippy.dynamicalsystem.DynamicalSystem"><code class="xref py py-class docutils literal"><span class="pre">DynamicalSystem</span></code></a> integrator compatible with
ASE <code class="xref py py-class docutils literal"><span class="pre">ase.md.MolecularDynamics</span></code> interface.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This class uses ASE units for time (and hence velocities
and momenta) which differ from the femtoseconds used in QUIP.
When using this class, all times should be given in ASE time units.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>atoms</strong> &#8211; quippy or ASE Atoms instance. Note that if atoms is
not a quippy Atoms object, a copy will be made.</li>
<li><strong>timestep</strong> &#8211; in ASE time units (multiply by <code class="xref py py-const docutils literal"><span class="pre">ase.units.fs</span></code>
to convert from femtoseconds)</li>
<li><strong>trajectory</strong> &#8211; output file to which to write the trajectory.
Can be a string to create a new output object.</li>
<li><strong>trajectoryinterval</strong> &#8211; interval at which to write frames</li>
<li><strong>initialtemperature</strong> &#8211; if not <code class="docutils literal"><span class="pre">None</span></code>, rescale initial velocities
to a specified temperature, given in K.</li>
<li><strong>logfile</strong> &#8211; filename or open InOutput object to write log lines to.
Use special filename <code class="docutils literal"><span class="pre">&quot;-&quot;</span></code> for stdout (default).</li>
<li><strong>loginterval</strong> &#8211; interval at which to write log lines</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.average_temperature" title="quippy.dynamicalsystem.Dynamics.average_temperature"><code class="xref py py-obj docutils literal"><span class="pre">average_temperature</span></code></a></td>
<td>Average temperature</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.averaging_time" title="quippy.dynamicalsystem.Dynamics.averaging_time"><code class="xref py py-obj docutils literal"><span class="pre">averaging_time</span></code></a></td>
<td>Averaging time used for average temperature and kinetic energy</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.damping" title="quippy.dynamicalsystem.Dynamics.damping"><code class="xref py py-obj docutils literal"><span class="pre">damping</span></code></a></td>
<td>Get or set the damping time constant in fs.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.number_of_constraints" title="quippy.dynamicalsystem.Dynamics.number_of_constraints"><code class="xref py py-obj docutils literal"><span class="pre">number_of_constraints</span></code></a></td>
<td>Get number of constraints</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.number_of_degrees_of_freedom" title="quippy.dynamicalsystem.Dynamics.number_of_degrees_of_freedom"><code class="xref py py-obj docutils literal"><span class="pre">number_of_degrees_of_freedom</span></code></a></td>
<td>Get number of degrees of freedom in system, including QUIP constraints</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.number_of_restraints" title="quippy.dynamicalsystem.Dynamics.number_of_restraints"><code class="xref py py-obj docutils literal"><span class="pre">number_of_restraints</span></code></a></td>
<td>Get number of restraints</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.number_of_rigid_bodies" title="quippy.dynamicalsystem.Dynamics.number_of_rigid_bodies"><code class="xref py py-obj docutils literal"><span class="pre">number_of_rigid_bodies</span></code></a></td>
<td>Get number of rigid_bodies</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.state" title="quippy.dynamicalsystem.Dynamics.state"><code class="xref py py-obj docutils literal"><span class="pre">state</span></code></a></td>
<td>Save or restore current state of this dynamical system</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.temperature" title="quippy.dynamicalsystem.Dynamics.temperature"><code class="xref py py-obj docutils literal"><span class="pre">temperature</span></code></a></td>
<td>Get or set the current temperature</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.time" title="quippy.dynamicalsystem.Dynamics.time"><code class="xref py py-obj docutils literal"><span class="pre">time</span></code></a></td>
<td>Time in ASE units (Note: NOT the same as femtoseconds)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.timestep" title="quippy.dynamicalsystem.Dynamics.timestep"><code class="xref py py-obj docutils literal"><span class="pre">timestep</span></code></a></td>
<td>Set timestep, in ASE time units</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.add_thermostat" title="quippy.dynamicalsystem.Dynamics.add_thermostat"><code class="xref py py-obj docutils literal"><span class="pre">add_thermostat</span></code></a>(type,&nbsp;T[,&nbsp;gamma,&nbsp;Q,&nbsp;tau,&nbsp;...])</td>
<td>Add a new thermostat to this Dynamics, and return its index.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.attach" title="quippy.dynamicalsystem.Dynamics.attach"><code class="xref py py-obj docutils literal"><span class="pre">attach</span></code></a>(function[,&nbsp;interval])</td>
<td>Attach callback function.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.get_number_of_thermostats" title="quippy.dynamicalsystem.Dynamics.get_number_of_thermostats"><code class="xref py py-obj docutils literal"><span class="pre">get_number_of_thermostats</span></code></a>()</td>
<td>Return the number of active thermostats</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.get_thermostat_temperatures" title="quippy.dynamicalsystem.Dynamics.get_thermostat_temperatures"><code class="xref py py-obj docutils literal"><span class="pre">get_thermostat_temperatures</span></code></a>()</td>
<td>Return the current temperatures of all thermostated regions</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.insert_observer" title="quippy.dynamicalsystem.Dynamics.insert_observer"><code class="xref py py-obj docutils literal"><span class="pre">insert_observer</span></code></a>(function[,&nbsp;position,&nbsp;interval])</td>
<td>Insert an observer.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.print_thermostats" title="quippy.dynamicalsystem.Dynamics.print_thermostats"><code class="xref py py-obj docutils literal"><span class="pre">print_thermostats</span></code></a>()</td>
<td>Print a table of the current thermostats in this system</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.remove_thermostat" title="quippy.dynamicalsystem.Dynamics.remove_thermostat"><code class="xref py py-obj docutils literal"><span class="pre">remove_thermostat</span></code></a>(index)</td>
<td>Remove thermostat number <cite>index</cite>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.run" title="quippy.dynamicalsystem.Dynamics.run"><code class="xref py py-obj docutils literal"><span class="pre">run</span></code></a>([steps])</td>
<td>Run dynamics forwards for <cite>steps</cite> steps.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.set_barostat" title="quippy.dynamicalsystem.Dynamics.set_barostat"><code class="xref py py-obj docutils literal"><span class="pre">set_barostat</span></code></a>(type,&nbsp;p_ext,&nbsp;...[,&nbsp;W_epsilon,&nbsp;...])</td>
<td>Add a barostat to this dynamical system</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.set_temperature" title="quippy.dynamicalsystem.Dynamics.set_temperature"><code class="xref py py-obj docutils literal"><span class="pre">set_temperature</span></code></a>(temperature)</td>
<td>Randomise velocities to a target temperature (given in K)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.step" title="quippy.dynamicalsystem.Dynamics.step"><code class="xref py py-obj docutils literal"><span class="pre">step</span></code></a>(forces)</td>
<td>Advance dynamics by one time-step.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.update_barostat" title="quippy.dynamicalsystem.Dynamics.update_barostat"><code class="xref py py-obj docutils literal"><span class="pre">update_barostat</span></code></a>(p,&nbsp;T)</td>
<td>Update target pressure <cite>p</cite> or temperature <cite>T</cite> for NPT barostat</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.dynamicalsystem.Dynamics.update_thermostat" title="quippy.dynamicalsystem.Dynamics.update_thermostat"><code class="xref py py-obj docutils literal"><span class="pre">update_thermostat</span></code></a>([T,&nbsp;p,&nbsp;index])</td>
<td>Change the target temperature <cite>T</cite> or presure <cite>p</cite> for thermostat <cite>index</cite>.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.add_thermostat">
<code class="descname">add_thermostat</code><span class="sig-paren">(</span><em>type</em>, <em>T</em>, <em>gamma=None</em>, <em>Q=None</em>, <em>tau=None</em>, <em>tau_cell=None</em>, <em>p=None</em>, <em>NHL_tau=None</em>, <em>NHL_mu=None</em>, <em>massive=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.add_thermostat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.add_thermostat" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a new thermostat to this Dynamics, and return its index.</p>
<p>By default, all thermostats apply to the whole system. The
&#8216;thermostat_region&#8217; property can be used to control which
thermostats affect which atoms. It should be set to the index
of the required thermostat for each atom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>type</strong> &#8211; string or integer giving thermostat type. The following types are supported::
<code class="docutils literal"><span class="pre">THERMOSTAT_NONE</span></code>, <code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN</span></code>, <code class="docutils literal"><span class="pre">THERMOSTAT_NOSE_HOOVER</span></code>, <code class="docutils literal"><span class="pre">THERMOSTAT_NOSE_HOOVER_LANGEVIN</span></code>,
<code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_NPT</span></code>, <code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_PR</span></code>, <code class="docutils literal"><span class="pre">THERMOSTAT_NPH_ANDERSEN</span></code>, <code class="docutils literal"><span class="pre">THERMOSTAT_NPH_PR</span></code>,
<code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_OU</span></code>, <code class="docutils literal"><span class="pre">THERMOSTAT_LANGEVIN_NPT_NB</span></code>, <code class="docutils literal"><span class="pre">THERMOSTAT_ALL_PURPOSE</span></code>.</li>
<li><strong>T</strong> &#8211; target temperature for this thermostat, in K.</li>
<li><strong>gamma</strong> &#8211; decay constant, in units  of 1/fs</li>
<li><strong>tau</strong> &#8211; time constant, in units of fs. tau == 1/gamma, and
only one of the two should be specified.</li>
<li><strong>tau_cell</strong> &#8211; time constant for the cell degrees of freedom
(for variable cell thermostats only).</li>
<li><strong>p</strong> &#8211; target pressure (for variable cell thermostats)</li>
<li><strong>NHL_tau</strong> &#8211; time constant for Nose-Hoover-Langevein thermostats</li>
<li><strong>NHL_mu</strong> &#8211; thermostat mass Nose-Hoover-Langevin thermostats</li>
<li><strong>massive</strong> &#8211; set to True to enable massive Nose-Hoover-Langevin</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.attach">
<code class="descname">attach</code><span class="sig-paren">(</span><em>function</em>, <em>interval=1</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.attach"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.attach" title="Permalink to this definition">¶</a></dt>
<dd><p>Attach callback function.</p>
<p>At every <em>interval</em> steps, call <em>function</em> with arguments
<em>args</em> and keyword arguments <em>kwargs</em>.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.get_number_of_thermostats">
<code class="descname">get_number_of_thermostats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.get_number_of_thermostats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.get_number_of_thermostats" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of active thermostats</p>
<p>Excludes thermostat with index zero, which is used for damping.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.get_thermostat_temperatures">
<code class="descname">get_thermostat_temperatures</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.get_thermostat_temperatures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.get_thermostat_temperatures" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current temperatures of all thermostated regions</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.insert_observer">
<code class="descname">insert_observer</code><span class="sig-paren">(</span><em>function</em>, <em>position=0</em>, <em>interval=1</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.insert_observer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.insert_observer" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert an observer.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.print_thermostats">
<code class="descname">print_thermostats</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.print_thermostats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.print_thermostats" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a table of the current thermostats in this system</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.remove_thermostat">
<code class="descname">remove_thermostat</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.remove_thermostat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.remove_thermostat" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove thermostat number <cite>index</cite>.</p>
<p><cite>index</cite> should be in range 1 &lt;= index &lt;= dyn.get_number_of_thermostats()</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>steps=50</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run dynamics forwards for <cite>steps</cite> steps.</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.set_barostat">
<code class="descname">set_barostat</code><span class="sig-paren">(</span><em>type</em>, <em>p_ext</em>, <em>hydrostatic_strain</em>, <em>diagonal_strain</em>, <em>finite_strain_formulation</em>, <em>tau_epsilon</em>, <em>W_epsilon=None</em>, <em>T=None</em>, <em>W_epsilon_factor=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.set_barostat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.set_barostat" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a barostat to this dynamical system</p>
<p>Langevin NPT barostat based on fluctuation/dissipation, as
originally implemented for hydrostatic strain using
EOM from Quigley, D. and Probert, M.I.J., J. Chem. Phys.
120 11432, subsequently rediscretized by Noam Bernstein
based on ideas from and discussion with B. Leimkuhler.</p>
<p>Modified for arbitrary strain based on (but not exactly using)
formulation in E. Tadmor and R. Miller Modeling Materials:
Continuum, Atomistic and Multiscale Techniques
(Cambridge University Press, 2011). Chap 9.5.  Their
definition of stress (factors of F, F^T, J, and F^-T) for finite
strain is optionally used, but certain terms in EOM are excluded,
and their discretization is entirely ignored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>type</strong> &#8211; The type of barostat to be used. Currently only
<code class="docutils literal"><span class="pre">BAROSTAT_HOOVER_LANGEVIN</span></code> is supported.</li>
<li><strong>p_ext</strong> &#8211; External pressure in QUIP units eV/A^3</li>
<li><strong>hystrostatic_strain</strong> &#8211; Set to True to constrain a
hydrostatic strain tensor</li>
<li><strong>diagonal_strain</strong> &#8211; Set to True to constrain a
diagonal strain tensor</li>
<li><strong>finite_strain_formulation</strong> &#8211; If True, use finite instead of
infinitessimal strain formulation</li>
<li><strong>tau_epsilon</strong> &#8211; time constant for Langevin part (in fs)</li>
<li><strong>W_epsilon</strong> &#8211; fictious cell mass used in Langevin NPT</li>
<li><strong>T</strong> &#8211; target temperature for Langevin part</li>
<li><strong>W_epsilon_factor</strong> &#8211; Scaling factor for fictious cell mass</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.set_temperature">
<code class="descname">set_temperature</code><span class="sig-paren">(</span><em>temperature</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.set_temperature"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.set_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomise velocities to a target temperature (given in K)</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>forces</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance dynamics by one time-step.</p>
<p>Returns forces at the end of the time-step, suitable for passing to next step()</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.update_barostat">
<code class="descname">update_barostat</code><span class="sig-paren">(</span><em>p</em>, <em>T</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.update_barostat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.update_barostat" title="Permalink to this definition">¶</a></dt>
<dd><p>Update target pressure <cite>p</cite> or temperature <cite>T</cite> for NPT barostat</p>
</dd></dl>

<dl class="method">
<dt id="quippy.dynamicalsystem.Dynamics.update_thermostat">
<code class="descname">update_thermostat</code><span class="sig-paren">(</span><em>T=None</em>, <em>p=None</em>, <em>index=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/dynamicalsystem.html#Dynamics.update_thermostat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.update_thermostat" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the target temperature <cite>T</cite> or presure <cite>p</cite> for thermostat <cite>index</cite>.</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.average_temperature">
<code class="descname">average_temperature</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.average_temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Average temperature</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.averaging_time">
<code class="descname">averaging_time</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.averaging_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Averaging time used for average temperature and kinetic energy</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.damping">
<code class="descname">damping</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.damping" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the damping time constant in fs. Set to
None to disable damping.  By default damping applies
to all atoms, but can be selectively enabled with the
&#8216;damp_mask&#8217; property.</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.number_of_constraints">
<code class="descname">number_of_constraints</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.number_of_constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of constraints</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.number_of_degrees_of_freedom">
<code class="descname">number_of_degrees_of_freedom</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.number_of_degrees_of_freedom" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of degrees of freedom in system, including QUIP constraints</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.number_of_restraints">
<code class="descname">number_of_restraints</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.number_of_restraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of restraints</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.number_of_rigid_bodies">
<code class="descname">number_of_rigid_bodies</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.number_of_rigid_bodies" title="Permalink to this definition">¶</a></dt>
<dd><p>Get number of rigid_bodies</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.state">
<code class="descname">state</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.state" title="Permalink to this definition">¶</a></dt>
<dd><p>Save or restore current state of this dynamical system</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.temperature">
<code class="descname">temperature</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.temperature" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the current temperature</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.time">
<code class="descname">time</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Time in ASE units (Note: NOT the same as femtoseconds)</p>
</dd></dl>

<dl class="attribute">
<dt id="quippy.dynamicalsystem.Dynamics.timestep">
<code class="descname">timestep</code><a class="headerlink" href="#quippy.dynamicalsystem.Dynamics.timestep" title="Permalink to this definition">¶</a></dt>
<dd><p>Set timestep, in ASE time units</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="quippy.dynamicalsystem.gaussian_velocity_component">
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">gaussian_velocity_component</code><span class="sig-paren">(</span><em>m</em>, <em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.gaussian_velocity_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw a velocity component from the correct Gaussian distribution for
a degree of freedom with (effective) mass <code class="docutils literal"><span class="pre">m</span></code> at temperature <code class="docutils literal"><span class="pre">T</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>m</strong> :  input float</p>
<p><strong>t</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_v</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">gaussian_velocity_component</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.dynamicalsystem.torque">
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">torque</code><span class="sig-paren">(</span><em>pos</em>, <em>force</em><span class="optional">[</span>, <em>origin</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.torque" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>pos</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
<p><strong>force</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</p>
<p><strong>origin</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_tau</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">torque</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.dynamicalsystem.distance_relative_velocity">
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">distance_relative_velocity</code><span class="sig-paren">(</span><em>at</em>, <em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.distance_relative_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the distance between two atoms and the relative velocity
between them projected along the bond direction.
This is useful for time dependent constraints.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<p><strong>i</strong> :  input int</p>
<p><strong>j</strong> :  input int</p>
<p><strong>dist</strong> :  float</p>
<p class="last"><strong>rel_velo</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">distance_relative_velocity</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.dynamicalsystem.angular_momentum">
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">angular_momentum</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.angular_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <code class="docutils literal"><span class="pre">angular_momentum</span></code> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">angular_momentum</code><span class="sig-paren">(</span><em>mass</em>, <em>pos</em>, <em>velo</em><span class="optional">[</span>, <em>origin</em>, <em>indices</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Return the angular momentum of all the atoms in this DynamicalSystem, defined by
<img class="math" src="_images/math/ede2d8f94fbc6c451abbbe27d607904bcef7f7c0.png" alt="\mathbf{L} = \sum_{i} \mathbf{r_i} \times \mathbf{v_i}"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mass</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>pos</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n1,qp_n2)</em>) &#8211; </li>
<li><strong>velo</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n3,qp_n4)</em>) &#8211; </li>
<li><strong>origin</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (3), optional</em>) &#8211; </li>
<li><strong>indices</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n5), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_l</strong> &#8211;  rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">arrays_angular_momentum</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.dynamicalsystem.kinetic_virial">
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">kinetic_virial</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.kinetic_virial" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <code class="docutils literal"><span class="pre">kinetic_virial</span></code> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">kinetic_virial</code><span class="sig-paren">(</span><em>mass</em>, <em>velo</em><span class="sig-paren">)</span></dt>
<dd><p>Return the total kinetic virial given atomic masses and velocities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mass</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>velo</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n1,qp_n2)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_kv</strong> &#8211;  rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">arrays_kinetic_virial</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">kinetic_virial</code><span class="sig-paren">(</span><em>mass</em>, <em>velo</em><span class="sig-paren">)</span></dt>
<dd><p>Return the kinetic virial given a mass and a velocity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mass</strong> (<em>input float</em>) &#8211; </li>
<li><strong>velo</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (3)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_kv</strong> &#8211;  rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">single_kinetic_virial</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.dynamicalsystem.momentum">
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">momentum</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <code class="docutils literal"><span class="pre">momentum</span></code> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">momentum</code><span class="sig-paren">(</span><em>mass</em>, <em>velo</em><span class="optional">[</span>, <em>indices</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Return the total momentum <img class="math" src="_images/math/f65d5abc743368c153c92e6f5062a4127a165b1c.png" alt="\mathbf{p} = \sum_i \mathbf{m_i} \mathbf{v_i}"/>.
Optionally only include the contribution of a subset of atoms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mass</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>velo</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n1,qp_n2)</em>) &#8211; </li>
<li><strong>indices</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n3), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_p</strong> &#8211;  rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">arrays_momentum</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.dynamicalsystem.kinetic_energy">
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">kinetic_energy</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.dynamicalsystem.kinetic_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <code class="docutils literal"><span class="pre">kinetic_energy</span></code> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">kinetic_energy</code><span class="sig-paren">(</span><em>mass</em>, <em>velo</em><span class="optional">[</span>, <em>local_ke</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Return the total kinetic energy given atomic masses and velocities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mass</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>velo</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n1,qp_n2)</em>) &#8211; </li>
<li><strong>local_ke</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n3), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_ke</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">arrays_kinetic_energy</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">quippy.dynamicalsystem.</code><code class="descname">kinetic_energy</code><span class="sig-paren">(</span><em>mass</em>, <em>velo</em><span class="sig-paren">)</span></dt>
<dd><p>Return the kinetic energy given a mass and a velocity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mass</strong> (<em>input float</em>) &#8211; </li>
<li><strong>velo</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (3)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_ke</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">single_kinetic_energy</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/DynamicalSystem.f95">src/libAtoms/DynamicalSystem.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="topology.html" title="Utilities for topological analysis"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">quippy 7470022 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="quippy.html" >Quippy library reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2008-2015, James Kermode.
      Last updated on Dec 03, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>
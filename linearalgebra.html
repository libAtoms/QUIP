<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Linear algebra routines &mdash; quippy  documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="quippy  documentation" href="index.html" />
    <link rel="up" title="Quippy library reference" href="quippy.html" />
    <link rel="next" title="Quaternions and rotation" href="quaternions.html" />
    <link rel="prev" title="Tools for electrostatic embedding" href="electrostaticembed.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="quaternions.html" title="Quaternions and rotation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="electrostaticembed.html" title="Tools for electrostatic embedding"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">quippy  documentation</a> &raquo;</li>
          <li><a href="quippy.html" accesskey="U">Quippy library reference</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/hybrid.png" alt="Logo"/>
            </a></p>
  <h4>Previous topic</h4>
  <p class="topless"><a href="electrostaticembed.html"
                        title="previous chapter">Tools for electrostatic embedding</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="quaternions.html"
                        title="next chapter">Quaternions and rotation</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/linearalgebra.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-quippy.linearalgebra">
<span id="linear-algebra-routines"></span><h1>Linear algebra routines<a class="headerlink" href="#module-quippy.linearalgebra" title="Permalink to this headline">¶</a></h1>
<p>This is a general purpose linear algebra module, extending
the Fortran intrinsics
This module defines dot products between matrices and vectors,
wrappers to textsc{lapack} for matrix diagonalisation and inversion,
as well as array searching, sorting and averaging.</p>
<p>Module contents for <a class="reference internal" href="#module-quippy.linearalgebra" title="quippy.linearalgebra: Linear algebra rountines"><tt class="xref py py-mod docutils literal"><span class="pre">quippy.linearalgebra</span></tt></a>:</p>
<p class="rubric">Functions</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.arrays_lt" title="quippy.linearalgebra.arrays_lt"><tt class="xref py py-obj docutils literal"><span class="pre">arrays_lt</span></tt></a>(i,j,[error])</td>
<td>compare contents of 2 cells in up to N=2 arrays (int or real), return true if</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.fit_cubic" title="quippy.linearalgebra.fit_cubic"><tt class="xref py py-obj docutils literal"><span class="pre">fit_cubic</span></tt></a>(x0,y0,y0p,x1,y1,y1p)</td>
<td>Fit a cubic polynomial to a function given its values (<img class="math" src="_images/math/f7e73389b494d356293b5ad9e3601a3a61609e96.png" alt="y_0"/> and <img class="math" src="_images/math/f30c7e391f4cef1d7b14050b5916c857c0979cb5.png" alt="y_1"/>) and</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.kmeans" title="quippy.linearalgebra.kmeans"><tt class="xref py py-obj docutils literal"><span class="pre">kmeans</span></tt></a>(data,k,means,assign,[err,initialisation])</td>
<td>K-means clustering.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.round_prime_factors" title="quippy.linearalgebra.round_prime_factors"><tt class="xref py py-obj docutils literal"><span class="pre">round_prime_factors</span></tt></a>(n,[max_prime_factor,error])</td>
<td>round n to the nearest number greater or equal to n</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.random_unit_vector" title="quippy.linearalgebra.random_unit_vector"><tt class="xref py py-obj docutils literal"><span class="pre">random_unit_vector</span></tt></a>()</td>
<td>Returns a random unit vector which is uniformly distributed over the unit sphere [See Knop, CACM 13 326 (1970)].</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.int_array_gt" title="quippy.linearalgebra.int_array_gt"><tt class="xref py py-obj docutils literal"><span class="pre">int_array_gt</span></tt></a>(array1,array2)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.is_in_array" title="quippy.linearalgebra.is_in_array"><tt class="xref py py-obj docutils literal"><span class="pre">is_in_array</span></tt></a>(val)</td>
<td>Test if a given integer <tt class="docutils literal"><span class="pre">val</span></tt> is in an integer array <tt class="docutils literal"><span class="pre">array</span></tt>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.int_array_ge" title="quippy.linearalgebra.int_array_ge"><tt class="xref py py-obj docutils literal"><span class="pre">int_array_ge</span></tt></a>(array1,array2)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.linear_interpolate" title="quippy.linearalgebra.linear_interpolate"><tt class="xref py py-obj docutils literal"><span class="pre">linear_interpolate</span></tt></a>(x0,y0,x1,y1,x)</td>
<td>Linearly interpolate between the points <img class="math" src="_images/math/bfd6ca45953d0c6ff82172022440d2fec96cc301.png" alt="(x_0,y_0)"/> and <img class="math" src="_images/math/11068e2663344fae473707cc857f803b9265dd3c.png" alt="(x_1,y_1)"/>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.cubic_interpolate" title="quippy.linearalgebra.cubic_interpolate"><tt class="xref py py-obj docutils literal"><span class="pre">cubic_interpolate</span></tt></a>(x0,y0,x1,y1,x)</td>
<td>Perform a cubic interpolation between the points <img class="math" src="_images/math/bfd6ca45953d0c6ff82172022440d2fec96cc301.png" alt="(x_0,y_0)"/> and <img class="math" src="_images/math/11068e2663344fae473707cc857f803b9265dd3c.png" alt="(x_1,y_1)"/>, using the cubic function with zero first derivative at <img class="math" src="_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/> and <img class="math" src="_images/math/b31b1ea8e4fe3f618dedfb0e2d8c69a3df7a391d.png" alt="x_1"/>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.permutation_symbol" title="quippy.linearalgebra.permutation_symbol"><tt class="xref py py-obj docutils literal"><span class="pre">permutation_symbol</span></tt></a>()</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.factorial" title="quippy.linearalgebra.factorial"><tt class="xref py py-obj docutils literal"><span class="pre">factorial</span></tt></a>(n)</td>
<td>Factorial, real result</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.pbc_aware_centre" title="quippy.linearalgebra.pbc_aware_centre"><tt class="xref py py-obj docutils literal"><span class="pre">pbc_aware_centre</span></tt></a>(p,lattice,g)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.ran_normal3" title="quippy.linearalgebra.ran_normal3"><tt class="xref py py-obj docutils literal"><span class="pre">ran_normal3</span></tt></a>()</td>
<td>Return a three vector with normally distributed components</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.matrix3x3_inverse" title="quippy.linearalgebra.matrix3x3_inverse"><tt class="xref py py-obj docutils literal"><span class="pre">matrix3x3_inverse</span></tt></a>(matrix)</td>
<td>Calculate <img class="math" src="_images/math/59ca78535a2bfd005ddf503222102c74a0199b90.png" alt="3\times3"/> matrix inverse of <tt class="docutils literal"><span class="pre">lattice</span></tt> and store result in <tt class="docutils literal"><span class="pre">g</span></tt>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.binom" title="quippy.linearalgebra.binom"><tt class="xref py py-obj docutils literal"><span class="pre">binom</span></tt></a>(n,r)</td>
<td>Binomial coefficient, real result</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.oscillate" title="quippy.linearalgebra.oscillate"><tt class="xref py py-obj docutils literal"><span class="pre">oscillate</span></tt></a>(m)</td>
<td>:math:` (-1)^n ` function.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.factorial2" title="quippy.linearalgebra.factorial2"><tt class="xref py py-obj docutils literal"><span class="pre">factorial2</span></tt></a>(n)</td>
<td>Double factorial, real result</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.zero_sum" title="quippy.linearalgebra.zero_sum"><tt class="xref py py-obj docutils literal"><span class="pre">zero_sum</span></tt></a>(array)</td>
<td>Subtract the average value from each element of a real array.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.d3poly_switch" title="quippy.linearalgebra.d3poly_switch"><tt class="xref py py-obj docutils literal"><span class="pre">d3poly_switch</span></tt></a>(r,cutoff_in,transition_width)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.poly_switch" title="quippy.linearalgebra.poly_switch"><tt class="xref py py-obj docutils literal"><span class="pre">poly_switch</span></tt></a>(r,cutoff_in,transition_width)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.unit_vector" title="quippy.linearalgebra.unit_vector"><tt class="xref py py-obj docutils literal"><span class="pre">unit_vector</span></tt></a>(theta,phi)</td>
<td>Return a unit vector in the direction given by the angles <tt class="docutils literal"><span class="pre">theta</span></tt> and <tt class="docutils literal"><span class="pre">phi</span></tt>, i.e.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.symmetric_linear_solve" title="quippy.linearalgebra.symmetric_linear_solve"><tt class="xref py py-obj docutils literal"><span class="pre">symmetric_linear_solve</span></tt></a>(m,a,n3)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.dcos_cutoff_function" title="quippy.linearalgebra.dcos_cutoff_function"><tt class="xref py py-obj docutils literal"><span class="pre">dcos_cutoff_function</span></tt></a>(r,cutoff_in)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.inverse_svd_threshold" title="quippy.linearalgebra.inverse_svd_threshold"><tt class="xref py py-obj docutils literal"><span class="pre">inverse_svd_threshold</span></tt></a>(...)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.cos_cutoff_function" title="quippy.linearalgebra.cos_cutoff_function"><tt class="xref py py-obj docutils literal"><span class="pre">cos_cutoff_function</span></tt></a>(r,cutoff_in)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.angle" title="quippy.linearalgebra.angle"><tt class="xref py py-obj docutils literal"><span class="pre">angle</span></tt></a>(a,b)</td>
<td>Return the (smallest) angle between two vectors, in radians.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.dpoly_switch" title="quippy.linearalgebra.dpoly_switch"><tt class="xref py py-obj docutils literal"><span class="pre">dpoly_switch</span></tt></a>(r,cutoff_in,transition_width)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.d2poly_switch" title="quippy.linearalgebra.d2poly_switch"><tt class="xref py py-obj docutils literal"><span class="pre">d2poly_switch</span></tt></a>(r,cutoff_in,transition_width)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.factorial_int" title="quippy.linearalgebra.factorial_int"><tt class="xref py py-obj docutils literal"><span class="pre">factorial_int</span></tt></a>(n)</td>
<td>Factorial, integer result</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.fill_random_integer" title="quippy.linearalgebra.fill_random_integer"><tt class="xref py py-obj docutils literal"><span class="pre">fill_random_integer</span></tt></a>(n,n0,[b])</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.scalar_triple_product" title="quippy.linearalgebra.scalar_triple_product"><tt class="xref py py-obj docutils literal"><span class="pre">scalar_triple_product</span></tt></a>(x,y,z)</td>
<td>Return the scalar triple product <img class="math" src="_images/math/b8ea76bffe9d3d676798e6cde9f5db21f5538c5b.png" alt="\mathbf{x} \cdot \mathbf{y} \times \mathbf{z}"/> of the 3-vectors <tt class="docutils literal"><span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">y</span></tt> and <tt class="docutils literal"><span class="pre">z</span></tt>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.trapezoidintegral" title="quippy.linearalgebra.trapezoidintegral"><tt class="xref py py-obj docutils literal"><span class="pre">trapezoidintegral</span></tt></a>(x,y)</td>
<td>Calculates integral numerically using the trapezoid formula from (x,y) data pairs.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.invsqrt_real_array1d" title="quippy.linearalgebra.invsqrt_real_array1d"><tt class="xref py py-obj docutils literal"><span class="pre">invsqrt_real_array1d</span></tt></a>(x)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.matrix3x3_det" title="quippy.linearalgebra.matrix3x3_det"><tt class="xref py py-obj docutils literal"><span class="pre">matrix3x3_det</span></tt></a>(m)</td>
<td>Calulates determinant of <img class="math" src="_images/math/59ca78535a2bfd005ddf503222102c74a0199b90.png" alt="3\times3"/> matrix</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.int_array_lt" title="quippy.linearalgebra.int_array_lt"><tt class="xref py py-obj docutils literal"><span class="pre">int_array_lt</span></tt></a>(array1,array2)</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.binary_search" title="quippy.linearalgebra.binary_search"><tt class="xref py py-obj docutils literal"><span class="pre">binary_search</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">binary_search</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.update_exponential_average" title="quippy.linearalgebra.update_exponential_average"><tt class="xref py py-obj docutils literal"><span class="pre">update_exponential_average</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Update a measure of a recent average by decaying its current value and adding on a new sample</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.matrix_mvmt" title="quippy.linearalgebra.matrix_mvmt"><tt class="xref py py-obj docutils literal"><span class="pre">matrix_mvmt</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Matrix product of matrix and a vector in the form:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.sign" title="quippy.linearalgebra.sign"><tt class="xref py py-obj docutils literal"><span class="pre">sign</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">sign</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.dcoordination_function" title="quippy.linearalgebra.dcoordination_function"><tt class="xref py py-obj docutils literal"><span class="pre">dcoordination_function</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">dcoordination_function</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.uniq" title="quippy.linearalgebra.uniq"><tt class="xref py py-obj docutils literal"><span class="pre">uniq</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">uniq</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.find" title="quippy.linearalgebra.find"><tt class="xref py py-obj docutils literal"><span class="pre">find</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">find</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.matrix_product_vect_asdiagonal_sub" title="quippy.linearalgebra.matrix_product_vect_asdiagonal_sub"><tt class="xref py py-obj docutils literal"><span class="pre">matrix_product_vect_asdiagonal_sub</span></tt></a>(*args,&nbsp;...)</td>
<td>Matrix product with the diagonal matrix constructed from a vector in subroutine form,</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.normsq" title="quippy.linearalgebra.normsq"><tt class="xref py py-obj docutils literal"><span class="pre">normsq</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Euclidean norm$^2$ of a vector or a of a list of vectors.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.inverse" title="quippy.linearalgebra.inverse"><tt class="xref py py-obj docutils literal"><span class="pre">inverse</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Calculate the inverse of a matrix in-place.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.trace" title="quippy.linearalgebra.trace"><tt class="xref py py-obj docutils literal"><span class="pre">trace</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Return the trace of a matrix.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.randomise" title="quippy.linearalgebra.randomise"><tt class="xref py py-obj docutils literal"><span class="pre">randomise</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Randomise the elements of an array.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.diag" title="quippy.linearalgebra.diag"><tt class="xref py py-obj docutils literal"><span class="pre">diag</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Construct a diagonal matrix from a vector, or extract the diagonal elements of a matrix and return them as a vector.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.matrix_product_sub" title="quippy.linearalgebra.matrix_product_sub"><tt class="xref py py-obj docutils literal"><span class="pre">matrix_product_sub</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Overloaded multiplication for matrix $times$ matrix in subroutine form,</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.matrix_exp" title="quippy.linearalgebra.matrix_exp"><tt class="xref py py-obj docutils literal"><span class="pre">matrix_exp</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">matrix_exp</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.add_identity" title="quippy.linearalgebra.add_identity"><tt class="xref py py-obj docutils literal"><span class="pre">add_identity</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Adds the identity to a matrix</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.is_symmetric" title="quippy.linearalgebra.is_symmetric"><tt class="xref py py-obj docutils literal"><span class="pre">is_symmetric</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Test for matrix symmetry (with floating point equality test &#8216;.feq.&#8217; as described above).</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.histogram" title="quippy.linearalgebra.histogram"><tt class="xref py py-obj docutils literal"><span class="pre">histogram</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Returns a vector, contining a histogram of frequencies.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.d2coordination_function" title="quippy.linearalgebra.d2coordination_function"><tt class="xref py py-obj docutils literal"><span class="pre">d2coordination_function</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">d2coordination_function</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.symmetrise" title="quippy.linearalgebra.symmetrise"><tt class="xref py py-obj docutils literal"><span class="pre">symmetrise</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Symmetrise a matrix: $$A to frac{A + A^T}{2}$$</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.nonsymmetric_diagonalise" title="quippy.linearalgebra.nonsymmetric_diagonalise"><tt class="xref py py-obj docutils literal"><span class="pre">nonsymmetric_diagonalise</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">nonsymmetric_diagonalise</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.insertion_sort" title="quippy.linearalgebra.insertion_sort"><tt class="xref py py-obj docutils literal"><span class="pre">insertion_sort</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">insertion_sort</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.find_in_array" title="quippy.linearalgebra.find_in_array"><tt class="xref py py-obj docutils literal"><span class="pre">find_in_array</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Search an array by element or by row.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.coordination_function" title="quippy.linearalgebra.coordination_function"><tt class="xref py py-obj docutils literal"><span class="pre">coordination_function</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">coordination_function</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.matrix_product_vect_asdiagonal_rl_sub" title="quippy.linearalgebra.matrix_product_vect_asdiagonal_rl_sub"><tt class="xref py py-obj docutils literal"><span class="pre">matrix_product_vect_asdiagonal_rl_sub</span></tt></a>(*args,&nbsp;...)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">matrix_product_vect_asdiagonal_rl_sub</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.sort_array" title="quippy.linearalgebra.sort_array"><tt class="xref py py-obj docutils literal"><span class="pre">sort_array</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">sort_array</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.diagonalise" title="quippy.linearalgebra.diagonalise"><tt class="xref py py-obj docutils literal"><span class="pre">diagonalise</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Overloaded interfaces to textsc{lapack} matrix diagonlisation functions for real and complex matrices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.rms_diff" title="quippy.linearalgebra.rms_diff"><tt class="xref py py-obj docutils literal"><span class="pre">rms_diff</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Root-mean-square difference calculation for components of two vectors or arrays.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.trace_mult" title="quippy.linearalgebra.trace_mult"><tt class="xref py py-obj docutils literal"><span class="pre">trace_mult</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">trace_mult</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.norm" title="quippy.linearalgebra.norm"><tt class="xref py py-obj docutils literal"><span class="pre">norm</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Return the euclidean norm of a vector or of an array.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.heap_sort" title="quippy.linearalgebra.heap_sort"><tt class="xref py py-obj docutils literal"><span class="pre">heap_sort</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">heap_sort</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.d3coordination_function" title="quippy.linearalgebra.d3coordination_function"><tt class="xref py py-obj docutils literal"><span class="pre">d3coordination_function</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">d3coordination_function</span></tt> containing multiple routines:</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.linearalgebra.is_orthogonal" title="quippy.linearalgebra.is_orthogonal"><tt class="xref py py-obj docutils literal"><span class="pre">is_orthogonal</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Test is matrix is unitary i.e.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.linearalgebra.check_size" title="quippy.linearalgebra.check_size"><tt class="xref py py-obj docutils literal"><span class="pre">check_size</span></tt></a>(*args,&nbsp;**kwargs)</td>
<td>Overloaded interface to assert that the size of an array is correct.</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="82%" />
<col width="18%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="xref py py-attr docutils literal"><span class="pre">NOT_FACTORISED</span></tt></td>
<td>0</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-attr docutils literal"><span class="pre">QR</span></tt></td>
<td>2</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-attr docutils literal"><span class="pre">CHOLESKY</span></tt></td>
<td>1</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-attr docutils literal"><span class="pre">factorial_table</span></tt></td>
<td>&#8212;</td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="quippy.linearalgebra.arrays_lt">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">arrays_lt</tt><big>(</big><em>i</em>, <em>j</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#quippy.linearalgebra.arrays_lt" title="Permalink to this definition">¶</a></dt>
<dd><p>compare contents of 2 cells in up to N=2 arrays (int or real), return true if
contents in first cell is less than 2nd, with 1st array taking precendence.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>i</strong> :  input int</p>
<p><strong>j</strong> :  input int</p>
<p><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_arrays_lt</strong> :  int</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">arrays_lt</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.fit_cubic">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">fit_cubic</tt><big>(</big><em>x0</em>, <em>y0</em>, <em>y0p</em>, <em>x1</em>, <em>y1</em>, <em>y1p</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.fit_cubic" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a cubic polynomial to a function given its values (<img class="math" src="_images/math/f7e73389b494d356293b5ad9e3601a3a61609e96.png" alt="y_0"/> and <img class="math" src="_images/math/f30c7e391f4cef1d7b14050b5916c857c0979cb5.png" alt="y_1"/>) and
its derivative (<img class="math" src="_images/math/5f76549f4cb0d7f165c33f4fa2a15c3c3800efb5.png" alt="y^\prime_0"/> and <img class="math" src="_images/math/c514f6ce84e31ae3411793319f3e2787890cd43d.png" alt="y^\prime_1"/>) at two points (<img class="math" src="_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/> and <img class="math" src="_images/math/b31b1ea8e4fe3f618dedfb0e2d8c69a3df7a391d.png" alt="x_1"/>)</p>
<div class="math">
<p><img src="_images/math/e73c41bdad603437e372290d8ba39832cc5625cc.png" alt="y = ax^3 + bx^2 + cx + d"/></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x0</strong> :  input float</p>
<blockquote>
<div><p><img class="math" src="_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/>, <img class="math" src="_images/math/f7e73389b494d356293b5ad9e3601a3a61609e96.png" alt="y_0"/>, <img class="math" src="_images/math/5f76549f4cb0d7f165c33f4fa2a15c3c3800efb5.png" alt="y^\prime_0"/></p>
</div></blockquote>
<p><strong>y0</strong> :  input float</p>
<blockquote>
<div><p><img class="math" src="_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/>, <img class="math" src="_images/math/f7e73389b494d356293b5ad9e3601a3a61609e96.png" alt="y_0"/>, <img class="math" src="_images/math/5f76549f4cb0d7f165c33f4fa2a15c3c3800efb5.png" alt="y^\prime_0"/></p>
</div></blockquote>
<p><strong>y0p</strong> :  input float</p>
<blockquote>
<div><p><img class="math" src="_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/>, <img class="math" src="_images/math/f7e73389b494d356293b5ad9e3601a3a61609e96.png" alt="y_0"/>, <img class="math" src="_images/math/5f76549f4cb0d7f165c33f4fa2a15c3c3800efb5.png" alt="y^\prime_0"/></p>
</div></blockquote>
<p><strong>x1</strong> :  input float</p>
<blockquote>
<div><p><img class="math" src="_images/math/b31b1ea8e4fe3f618dedfb0e2d8c69a3df7a391d.png" alt="x_1"/>, <img class="math" src="_images/math/f30c7e391f4cef1d7b14050b5916c857c0979cb5.png" alt="y_1"/>, <img class="math" src="_images/math/c514f6ce84e31ae3411793319f3e2787890cd43d.png" alt="y^\prime_1"/></p>
</div></blockquote>
<p><strong>y1</strong> :  input float</p>
<blockquote>
<div><p><img class="math" src="_images/math/b31b1ea8e4fe3f618dedfb0e2d8c69a3df7a391d.png" alt="x_1"/>, <img class="math" src="_images/math/f30c7e391f4cef1d7b14050b5916c857c0979cb5.png" alt="y_1"/>, <img class="math" src="_images/math/c514f6ce84e31ae3411793319f3e2787890cd43d.png" alt="y^\prime_1"/></p>
</div></blockquote>
<p><strong>y1p</strong> :  input float</p>
<blockquote>
<div><p><img class="math" src="_images/math/b31b1ea8e4fe3f618dedfb0e2d8c69a3df7a391d.png" alt="x_1"/>, <img class="math" src="_images/math/f30c7e391f4cef1d7b14050b5916c857c0979cb5.png" alt="y_1"/>, <img class="math" src="_images/math/c514f6ce84e31ae3411793319f3e2787890cd43d.png" alt="y^\prime_1"/></p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>coeffs</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (4)</p>
<blockquote class="last">
<div><p><tt class="docutils literal"><span class="pre">(/a,b,c,d/)</span></tt></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">fit_cubic</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.kmeans">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">kmeans</tt><big>(</big><em>data</em>, <em>k</em>, <em>means</em>, <em>assign</em><span class="optional">[</span>, <em>err</em>, <em>initialisation</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#quippy.linearalgebra.kmeans" title="Permalink to this definition">¶</a></dt>
<dd><p>K-means clustering. Algorithm is as described in Numerical Recipes
(Third Edition, Section 16.1.2, pp. 848-849).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>data</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
<p><strong>k</strong> :  input int</p>
<p><strong>means</strong> :  in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</p>
<p><strong>assign</strong> :  in/output rank-1 array(&#8216;i&#8217;) with bounds (qp_n4)</p>
<p><strong>err</strong> :  in/output rank-0 array(float,&#8217;d&#8217;), optional</p>
<p class="last"><strong>initialisation</strong> :  input string(len=-1), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">kmeans</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.round_prime_factors">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">round_prime_factors</tt><big>(</big><em>n</em><span class="optional">[</span>, <em>max_prime_factor</em>, <em>error</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#quippy.linearalgebra.round_prime_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>round n to the nearest number greater or equal to n
with prime factors of only 2, 3, 5, ... max_prime_factor</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n</strong> :  in/output rank-0 array(int,&#8217;i&#8217;)</p>
<blockquote>
<div><p>The number to be rounded</p>
</div></blockquote>
<p><strong>max_prime_factor</strong> :  input int, optional</p>
<p class="last"><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">round_prime_factors</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.random_unit_vector">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">random_unit_vector</tt><big>(</big><big>)</big><a class="headerlink" href="#quippy.linearalgebra.random_unit_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random unit vector which is
uniformly distributed over the unit sphere
[See Knop, CACM 13 326 (1970)].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_v</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (3)</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">random_unit_vector</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.int_array_gt">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">int_array_gt</tt><big>(</big><em>array1</em>, <em>array2</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.int_array_gt" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>array1</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</p>
<p><strong>array2</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (size(qp_array1))</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_gt</strong> :  int</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">int_array_gt</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.is_in_array">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">is_in_array</tt><big>(</big><em>val</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.is_in_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if a given integer <tt class="docutils literal"><span class="pre">val</span></tt> is in an integer array <tt class="docutils literal"><span class="pre">array</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>val</strong> :  input int</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_is_in_array</strong> :  int</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">is_in_array</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.int_array_ge">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">int_array_ge</tt><big>(</big><em>array1</em>, <em>array2</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.int_array_ge" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>array1</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</p>
<p><strong>array2</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (size(qp_array1))</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_ge</strong> :  int</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">int_array_ge</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.linear_interpolate">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">linear_interpolate</tt><big>(</big><em>x0</em>, <em>y0</em>, <em>x1</em>, <em>y1</em>, <em>x</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.linear_interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Linearly interpolate between the points <img class="math" src="_images/math/bfd6ca45953d0c6ff82172022440d2fec96cc301.png" alt="(x_0,y_0)"/> and <img class="math" src="_images/math/11068e2663344fae473707cc857f803b9265dd3c.png" alt="(x_1,y_1)"/>.
Returns the interpolated <img class="math" src="_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> at position <img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>, where <img class="math" src="_images/math/8529a12ffb786f3d289764e535d63a708c0da889.png" alt="x_0 \le x \le x_1"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x0</strong> :  input float</p>
<p><strong>y0</strong> :  input float</p>
<p><strong>x1</strong> :  input float</p>
<p><strong>y1</strong> :  input float</p>
<p><strong>x</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_y</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">linear_interpolate</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.cubic_interpolate">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">cubic_interpolate</tt><big>(</big><em>x0</em>, <em>y0</em>, <em>x1</em>, <em>y1</em>, <em>x</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.cubic_interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a cubic interpolation between the points <img class="math" src="_images/math/bfd6ca45953d0c6ff82172022440d2fec96cc301.png" alt="(x_0,y_0)"/> and <img class="math" src="_images/math/11068e2663344fae473707cc857f803b9265dd3c.png" alt="(x_1,y_1)"/>,
using the cubic function with zero first derivative at <img class="math" src="_images/math/c3c08496f07567285212e468b173bea9ca153fab.png" alt="x_0"/> and <img class="math" src="_images/math/b31b1ea8e4fe3f618dedfb0e2d8c69a3df7a391d.png" alt="x_1"/>.
Returns the interpolated <img class="math" src="_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> at position <img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/>, where <img class="math" src="_images/math/8529a12ffb786f3d289764e535d63a708c0da889.png" alt="x_0 \le x \le x_1"/>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x0</strong> :  input float</p>
<p><strong>y0</strong> :  input float</p>
<p><strong>x1</strong> :  input float</p>
<p><strong>y1</strong> :  input float</p>
<p><strong>x</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_y</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">cubic_interpolate</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.permutation_symbol">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">permutation_symbol</tt><big>(</big><big>)</big><a class="headerlink" href="#quippy.linearalgebra.permutation_symbol" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_eps</strong> :  rank-3 array(&#8216;d&#8217;) with bounds (3,3,3)</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">permutation_symbol</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.factorial">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">factorial</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.factorial" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorial, real result</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> :  input int</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_res</strong> :  float</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">factorial</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.pbc_aware_centre">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">pbc_aware_centre</tt><big>(</big><em>p</em>, <em>lattice</em>, <em>g</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.pbc_aware_centre" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>p</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
<p><strong>lattice</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
<p><strong>g</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_c</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">pbc_aware_centre</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.ran_normal3">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">ran_normal3</tt><big>(</big><big>)</big><a class="headerlink" href="#quippy.linearalgebra.ran_normal3" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a three vector with normally distributed components</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_ran_normal3</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (3)</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">ran_normal3</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.matrix3x3_inverse">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix3x3_inverse</tt><big>(</big><em>matrix</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.matrix3x3_inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate <img class="math" src="_images/math/59ca78535a2bfd005ddf503222102c74a0199b90.png" alt="3\times3"/> matrix inverse of <tt class="docutils literal"><span class="pre">lattice</span></tt> and store result in <tt class="docutils literal"><span class="pre">g</span></tt>.
Avoids overhead of calling textsc{lapack} for simple case of <img class="math" src="_images/math/59ca78535a2bfd005ddf503222102c74a0199b90.png" alt="3\times3"/> matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>g</strong> :  rank-2 array(&#8216;d&#8217;) with bounds (3,3)</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix3x3_inverse</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.binom">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">binom</tt><big>(</big><em>n</em>, <em>r</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.binom" title="Permalink to this definition">¶</a></dt>
<dd><p>Binomial coefficient, real result</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n</strong> :  input int</p>
<p><strong>r</strong> :  input int</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_res</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">binom</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.oscillate">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">oscillate</tt><big>(</big><em>m</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.oscillate" title="Permalink to this definition">¶</a></dt>
<dd><p>:math:` (-1)^n ` function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>m</strong> :  input int</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_oscillate</strong> :  int</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">oscillate</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.factorial2">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">factorial2</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.factorial2" title="Permalink to this definition">¶</a></dt>
<dd><p>Double factorial, real result</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> :  input int</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_res</strong> :  float</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">factorial2</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.zero_sum">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">zero_sum</tt><big>(</big><em>array</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.zero_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtract the average value from each element of a real array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>array</strong> :  in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">zero_sum</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.d3poly_switch">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">d3poly_switch</tt><big>(</big><em>r</em>, <em>cutoff_in</em>, <em>transition_width</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.d3poly_switch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>r</strong> :  input float</p>
<p><strong>cutoff_in</strong> :  input float</p>
<p><strong>transition_width</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_d3poly_switch</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">d3poly_switch</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.poly_switch">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">poly_switch</tt><big>(</big><em>r</em>, <em>cutoff_in</em>, <em>transition_width</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.poly_switch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>r</strong> :  input float</p>
<p><strong>cutoff_in</strong> :  input float</p>
<p><strong>transition_width</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_poly_switch</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">poly_switch</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.unit_vector">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">unit_vector</tt><big>(</big><em>theta</em>, <em>phi</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.unit_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a unit vector in the direction given by the angles <tt class="docutils literal"><span class="pre">theta</span></tt> and <tt class="docutils literal"><span class="pre">phi</span></tt>, i.e.
convert the spherical polar coordinates point <img class="math" src="_images/math/c2cb757dbfef144e8880f3a6c21e3bddd3d454ec.png" alt="(1,\theta,\phi)"/> to cartesians.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>theta</strong> :  input float</p>
<p><strong>phi</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_unit_vector</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">unit_vector</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.symmetric_linear_solve">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">symmetric_linear_solve</tt><big>(</big><em>m</em>, <em>a</em>, <em>n3</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.symmetric_linear_solve" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>m</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
<p><strong>a</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</p>
<p><strong>n3</strong> :  input int</p>
<blockquote>
<div><p>shape(qp_M_inv_a,0)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>m_inv_a</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (qp_n3)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">symmetric_linear_solve</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.dcos_cutoff_function">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">dcos_cutoff_function</tt><big>(</big><em>r</em>, <em>cutoff_in</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.dcos_cutoff_function" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>r</strong> :  input float</p>
<p><strong>cutoff_in</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_dcos_cutoff_function</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">dcos_cutoff_function</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.inverse_svd_threshold">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">inverse_svd_threshold</tt><big>(</big><em>in_matrix</em>, <em>thresh</em><span class="optional">[</span>, <em>result_inv</em>, <em>u_out</em>, <em>vt_out</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#quippy.linearalgebra.inverse_svd_threshold" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>in_matrix</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
<p><strong>thresh</strong> :  input float</p>
<p><strong>result_inv</strong> :  in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3), optional</p>
<p><strong>u_out</strong> :  in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n4,qp_n5), optional</p>
<p class="last"><strong>vt_out</strong> :  in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n6,qp_n7), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">inverse_svd_threshold</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.cos_cutoff_function">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">cos_cutoff_function</tt><big>(</big><em>r</em>, <em>cutoff_in</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.cos_cutoff_function" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>r</strong> :  input float</p>
<p><strong>cutoff_in</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_cos_cutoff_function</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">cos_cutoff_function</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.angle">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">angle</tt><big>(</big><em>a</em>, <em>b</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (smallest) angle between two vectors, in radians.
This is calculated as</p>
<div class="math">
<p><img src="_images/math/9486a09be0216defc1bd257dde665b3830bf2384.png" alt="\arccos\left(\frac{\mathbf{a}\cdot\mathbf{b}}{|\mathbf{a}| |\mathbf{b}|}\right)"/></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</p>
<p><strong>b</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n1)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_angle</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">angle</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.dpoly_switch">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">dpoly_switch</tt><big>(</big><em>r</em>, <em>cutoff_in</em>, <em>transition_width</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.dpoly_switch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>r</strong> :  input float</p>
<p><strong>cutoff_in</strong> :  input float</p>
<p><strong>transition_width</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_dpoly_switch</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">dpoly_switch</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.d2poly_switch">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">d2poly_switch</tt><big>(</big><em>r</em>, <em>cutoff_in</em>, <em>transition_width</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.d2poly_switch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>r</strong> :  input float</p>
<p><strong>cutoff_in</strong> :  input float</p>
<p><strong>transition_width</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_d2poly_switch</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">d2poly_switch</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.factorial_int">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">factorial_int</tt><big>(</big><em>n</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.factorial_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorial, integer result</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> :  input int</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_res</strong> :  int</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">factorial_int</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.fill_random_integer">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">fill_random_integer</tt><big>(</big><em>n</em>, <em>n0</em><span class="optional">[</span>, <em>b</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#quippy.linearalgebra.fill_random_integer" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>n0</strong> :  input int</p>
<blockquote>
<div><p>shape(qp_r,0)</p>
</div></blockquote>
<p><strong>n</strong> :  input int</p>
<p><strong>b</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n1), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>r</strong> :  rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">fill_random_integer</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.scalar_triple_product">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">scalar_triple_product</tt><big>(</big><em>x</em>, <em>y</em>, <em>z</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.scalar_triple_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the scalar triple product <img class="math" src="_images/math/b8ea76bffe9d3d676798e6cde9f5db21f5538c5b.png" alt="\mathbf{x} \cdot \mathbf{y} \times \mathbf{z}"/>
of the 3-vectors <tt class="docutils literal"><span class="pre">x</span></tt>, <tt class="docutils literal"><span class="pre">y</span></tt> and <tt class="docutils literal"><span class="pre">z</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p><strong>y</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p><strong>z</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_scalar_triple_product</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">scalar_triple_product</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.trapezoidintegral">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">trapezoidintegral</tt><big>(</big><em>x</em>, <em>y</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.trapezoidintegral" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates integral numerically using the trapezoid formula from (x,y) data
pairs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</p>
<p><strong>y</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n1)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_trapezoidintegral</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">trapezoidintegral</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.invsqrt_real_array1d">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">invsqrt_real_array1d</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.invsqrt_real_array1d" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>x</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_invsqrt_real_array1d</strong> :  rank-1 array(&#8216;d&#8217;) with bounds (size(qp_x))</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">invsqrt_real_array1d</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.matrix3x3_det">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix3x3_det</tt><big>(</big><em>m</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.matrix3x3_det" title="Permalink to this definition">¶</a></dt>
<dd><p>Calulates determinant of <img class="math" src="_images/math/59ca78535a2bfd005ddf503222102c74a0199b90.png" alt="3\times3"/> matrix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>m</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_det</strong> :  float</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix3x3_det</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.int_array_lt">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">int_array_lt</tt><big>(</big><em>array1</em>, <em>array2</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.int_array_lt" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>array1</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</p>
<p><strong>array2</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (size(qp_array1))</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_lt</strong> :  int</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">int_array_lt</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.binary_search">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">binary_search</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.binary_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">binary_search</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">binary_search</tt><big>(</big><em>array</em>, <em>value</em><span class="optional">[</span>, <em>first</em>, <em>low</em>, <em>high</em>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><p>Do binary search and return <tt class="docutils literal"><span class="pre">index</span></tt> of element containing <tt class="docutils literal"><span class="pre">value</span></tt>, or zero if not found.
<tt class="docutils literal"><span class="pre">array</span></tt> must be sorted into ascending order beforehand.
If the array subscripts don``t start at 1, then pass the actual index of the first element as <tt class="docutils literal"><span class="pre">first',</span>
<span class="pre">then,</span> <span class="pre">if</span> <span class="pre">the</span> <span class="pre">element</span> <span class="pre">isn``t</span> <span class="pre">found,</span> <span class="pre">the</span> <span class="pre">value</span> <span class="pre">returned</span> <span class="pre">is</span> <span class="pre">``first'</span> <span class="pre">minus</span> <span class="pre">1.</span>
<span class="pre">To</span> <span class="pre">restrict</span> <span class="pre">the</span> <span class="pre">search</span> <span class="pre">to</span> <span class="pre">a</span> <span class="pre">subsection</span> <span class="pre">of</span> <span class="pre">the</span> <span class="pre">array</span> <span class="pre">supply</span> <span class="pre">``low</span></tt> and/or <tt class="docutils literal"><span class="pre">high</span></tt>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>value</strong> (<em>input int</em>) &#8211; </li>
<li><strong>first</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>low</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>high</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_index</strong> &#8211;  int</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">binary_search_i</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">binary_search</tt><big>(</big><em>array</em>, <em>value</em><span class="optional">[</span>, <em>first</em>, <em>low</em>, <em>high</em>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><p>Do binary search and return <tt class="docutils literal"><span class="pre">index</span></tt> of element being smaller or equal
to <tt class="docutils literal"><span class="pre">value</span></tt>. <tt class="docutils literal"><span class="pre">array</span></tt> must be sorted into ascending order beforehand.
If the array subscripts don&#8217;t start at 1, then pass the actual index of
the first element as <tt class="docutils literal"><span class="pre">first</span></tt></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>value</strong> (<em>input float</em>) &#8211; </li>
<li><strong>first</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>low</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>high</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_index</strong> &#8211;  int</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">binary_search_r</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.update_exponential_average">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">update_exponential_average</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.update_exponential_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a measure of a recent average by decaying its current value and adding on a new sample</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">update_exponential_average</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">update_exponential_average</tt><big>(</big><em>average</em>, <em>decay</em>, <em>x</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>average</strong> (<em>in/output rank-0 array(float,&#8217;d&#8217;)</em>) &#8211; </li>
<li><strong>decay</strong> (<em>input float</em>) &#8211; </li>
<li><strong>x</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">update_exponential_average_s</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">update_exponential_average</tt><big>(</big><em>average</em>, <em>decay</em>, <em>x</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>average</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>decay</strong> (<em>input float</em>) &#8211; </li>
<li><strong>x</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (size(qp_average))</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">update_exponential_average_v</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">update_exponential_average</tt><big>(</big><em>average</em>, <em>decay</em>, <em>x</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>average</strong> (<em>in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>decay</strong> (<em>input float</em>) &#8211; </li>
<li><strong>x</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">update_exponential_average_d2</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.matrix_mvmt">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_mvmt</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.matrix_mvmt" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix product of matrix and a vector in the form:
&gt; matrix * diag(vector) * transpose(matrix)</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">matrix_mvmt</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_mvmt</tt><big>(</big><em>matrix</em>, <em>vect</em>, <em>n3</em>, <em>n4</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>vect</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</em>) &#8211; </li>
<li><strong>n3</strong> (<em>input int</em>) &#8211; shape(qp_ret_prodmatrix,0)</li>
<li><strong>n4</strong> (<em>input int</em>) &#8211; shape(qp_ret_prodmatrix,1)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_prodmatrix</strong> &#8211;  rank-2 array(&#8216;d&#8217;) with bounds (qp_n3,qp_n4)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_cfct</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.sign">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">sign</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">sign</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">sign</tt><big>(</big><em>n</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> (<em>input int</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_int_sign</strong> &#8211;  int</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">int_sign</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">sign</tt><big>(</big><em>n</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> (<em>input float</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_real_sign</strong> &#8211;  float</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">real_sign</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.dcoordination_function">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">dcoordination_function</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.dcoordination_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">dcoordination_function</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">dcoordination_function</tt><big>(</big><em>r</em>, <em>lower_cutoff_in</em>, <em>lower_transition_width</em>, <em>upper_cutoff_in</em>, <em>upper_transition_width</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (<em>input float</em>) &#8211; </li>
<li><strong>lower_cutoff_in</strong> (<em>input float</em>) &#8211; </li>
<li><strong>lower_transition_width</strong> (<em>input float</em>) &#8211; </li>
<li><strong>upper_cutoff_in</strong> (<em>input float</em>) &#8211; </li>
<li><strong>upper_transition_width</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_dcoordination_function_lower_upper</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">dcoordination_function_lower_upper</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">dcoordination_function</tt><big>(</big><em>r</em>, <em>cutoff_in</em>, <em>transition_width</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (<em>input float</em>) &#8211; </li>
<li><strong>cutoff_in</strong> (<em>input float</em>) &#8211; </li>
<li><strong>transition_width</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_dcoordination_function_upper</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">dcoordination_function_upper</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.uniq">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">uniq</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.uniq" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">uniq</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">uniq</tt><big>(</big><em>array</em><span class="optional">[</span>, <em>unique</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>unique</strong> (<em>in/output rank-1 array(&#8216;i&#8217;) with bounds (qp_n2), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">uniq_real_dim2</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.find">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">find</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">find</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">find</tt><big>(</big><em>mask</em>, <em>n1</em><big>)</big></dt>
<dd><p>Collect the indices corresponding to .true. elements of a mask
can be used to index other arrays, e.g. array(find(mask))</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>mask</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_ret_find_indices,0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_find_indices</strong> &#8211;  rank-1 array(&#8216;i&#8217;) with bounds (qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">find_indices</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.matrix_product_vect_asdiagonal_sub">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_sub</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.matrix_product_vect_asdiagonal_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix product with the diagonal matrix constructed from a vector in subroutine form,
with no return value allocated on the stack</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">matrix_product_vect_asdiagonal_sub</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_sub</tt><big>(</big><em>vectl</em>, <em>matrix</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>vectl</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</em>) &#8211; </li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n3,qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vect_asdiagonal_product_matrix_sub_ddd</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_sub</tt><big>(</big><em>matrix</em>, <em>vect</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
<li><strong>vect</strong> (<em>input rank-1 array(&#8216;D&#8217;) with bounds (qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_product_vect_asdiagonal_sub_zdz</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_sub</tt><big>(</big><em>vectl</em>, <em>matrix</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>vectl</strong> (<em>input rank-1 array(&#8216;D&#8217;) with bounds (qp_n2)</em>) &#8211; </li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n3,qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vect_asdiagonal_product_matrix_sub_zzd</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_sub</tt><big>(</big><em>matrix</em>, <em>vect</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
<li><strong>vect</strong> (<em>input rank-1 array(&#8216;D&#8217;) with bounds (qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_product_vect_asdiagonal_sub_zzz</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_sub</tt><big>(</big><em>vectl</em>, <em>matrix</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>vectl</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</em>) &#8211; </li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n3,qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vect_asdiagonal_product_matrix_sub_zdz</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_sub</tt><big>(</big><em>matrix</em>, <em>vect</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
<li><strong>vect</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_product_vect_asdiagonal_sub_zzd</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_sub</tt><big>(</big><em>matrix</em>, <em>vect</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
<li><strong>vect</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_product_vect_asdiagonal_sub_ddd</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_sub</tt><big>(</big><em>vectl</em>, <em>matrix</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>vectl</strong> (<em>input rank-1 array(&#8216;D&#8217;) with bounds (qp_n2)</em>) &#8211; </li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n3,qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vect_asdiagonal_product_matrix_sub_zzz</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.normsq">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">normsq</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.normsq" title="Permalink to this definition">¶</a></dt>
<dd><p>Euclidean norm$^2$ of a vector or a of a list of vectors. Result is equal
to &#8216;x .dot. x&#8217; for a single vector &#8216;x&#8217;.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">normsq</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">normsq</tt><big>(</big><em>vector</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vector</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_normsq</strong> &#8211;  float</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vector_normsq</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">normsq</tt><big>(</big><em>this</em>, <em>dir</em>, <em>n2</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>dir</strong> (<em>input int</em>) &#8211; </li>
<li><strong>n2</strong> (<em>input int</em>) &#8211; shape(qp_ret_array_normsq,0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_array_normsq</strong> &#8211;  rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">array_normsq</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.inverse">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">inverse</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the inverse of a matrix in-place. Uses textsc{lapack} to compute the inverse.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">inverse</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">inverse</tt><big>(</big><em>matrix</em><span class="optional">[</span>, <em>inverse</em>, <em>positive_in</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>inverse</strong> (<em>in/output rank-2 array(&#8216;D&#8217;) with bounds (qp_n2,qp_n3), optional</em>) &#8211; </li>
<li><strong>positive_in</strong> (<em>input int, optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_z_inverse</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">inverse</tt><big>(</big><em>matrix</em><span class="optional">[</span>, <em>inverse</em>, <em>positive_in</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>inverse</strong> (<em>in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3), optional</em>) &#8211; </li>
<li><strong>positive_in</strong> (<em>input int, optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_inverse</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.trace">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">trace</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the trace of a matrix.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">trace</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">trace</tt><big>(</big><em>matrix</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_tr</strong> &#8211;  float</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_trace</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.randomise">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">randomise</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.randomise" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomise the elements of an array. Uniformly distributed random quantities in the range
$(-frac{a}{2},frac{a}{2})$ are added to each element of the vector or matrix.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">randomise</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">randomise</tt><big>(</big><em>m</em>, <em>a</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>m</strong> (<em>in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>a</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_randomise</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">randomise</tt><big>(</big><em>m</em>, <em>a</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>m</strong> (<em>in/output rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>a</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_z_randomise</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">randomise</tt><big>(</big><em>m</em>, <em>a</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>m</strong> (<em>in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>a</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_randomise_vweight</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">randomise</tt><big>(</big><em>v</em>, <em>a</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>a</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vector_randomise</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">randomise</tt><big>(</big><em>v</em>, <em>a</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>v</strong> (<em>in/output rank-1 array(&#8216;D&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>a</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vector_z_randomise</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.diag">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diag</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a diagonal matrix from a vector, or extract the diagonal elements
of a matrix and return them as a vector.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">diag</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diag</tt><big>(</big><em>matrix</em>, <em>n2</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>n2</strong> (<em>input int</em>) &#8211; shape(qp_ret_vect,0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_vect</strong> &#8211;  rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_diagonal_r</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diag</tt><big>(</big><em>matrix</em>, <em>n2</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>n2</strong> (<em>input int</em>) &#8211; shape(qp_ret_vect,0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_vect</strong> &#8211;  rank-1 array(&#8216;D&#8217;) with bounds (qp_n2)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_diagonal_c</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diag</tt><big>(</big><em>vect</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vect</strong> (<em>input rank-1 array(&#8216;D&#8217;) with bounds (qp_n0)</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_matrix</strong> &#8211;  rank-2 array(&#8216;D&#8217;) with bounds (size(qp_vect),size(qp_vect))</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vector_as_diag_matrix_c</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diag</tt><big>(</big><em>vect</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vect</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_matrix</strong> &#8211;  rank-2 array(&#8216;d&#8217;) with bounds (size(qp_vect),size(qp_vect))</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vector_as_diag_matrix_r</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.matrix_product_sub">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_sub</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.matrix_product_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloaded multiplication for matrix $times$ matrix in subroutine form,
with no return value allocated on the stack</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">matrix_product_sub</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_sub</tt><big>(</big><em>matrix1</em>, <em>matrix2</em>, <em>n0</em>, <em>n1</em><span class="optional">[</span>, <em>m1_transpose</em>, <em>m2_transpose</em>, <em>lhs_factor</em>, <em>rhs_factor</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>matrix1</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
<li><strong>matrix2</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n4,qp_n5)</em>) &#8211; </li>
<li><strong>m1_transpose</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>m2_transpose</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>lhs_factor</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>rhs_factor</strong> (<em>input float, optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_product_sub_ddd</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_sub</tt><big>(</big><em>matrix</em>, <em>vector</em>, <em>n0</em><span class="optional">[</span>, <em>m_transpose</em>, <em>lhs_factor</em>, <em>rhs_factor</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n1,qp_n2)</em>) &#8211; </li>
<li><strong>vector</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n3)</em>) &#8211; </li>
<li><strong>m_transpose</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>lhs_factor</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>rhs_factor</strong> (<em>input float, optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_vector_product_sub_ddd</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.matrix_exp">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_exp</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.matrix_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">matrix_exp</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_exp</tt><big>(</big><em>a</em>, <em>n2</em>, <em>n3</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>n2</strong> (<em>input int</em>) &#8211; shape(qp_ret_matrix_exp_d,0)</li>
<li><strong>n3</strong> (<em>input int</em>) &#8211; shape(qp_ret_matrix_exp_d,1)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_matrix_exp_d</strong> &#8211;  rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_exp_d</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.add_identity">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">add_identity</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.add_identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the identity to a matrix</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">add_identity</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">add_identity</tt><big>(</big><em>matrix</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (<em>in/output rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_add_identity_c</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">add_identity</tt><big>(</big><em>matrix</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (<em>in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_add_identity_r</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.is_symmetric">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">is_symmetric</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.is_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Test for matrix symmetry (with floating point equality test &#8216;.feq.&#8217; as described above).</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">is_symmetric</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">is_symmetric</tt><big>(</big><em>matrix</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_symm</strong> &#8211;  int</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_z_is_symmetric</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">is_symmetric</tt><big>(</big><em>matrix</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (<em>input rank-2 array(&#8216;i&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_symm</strong> &#8211;  int</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">int_matrix_is_symmetric</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">is_symmetric</tt><big>(</big><em>matrix</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_symm</strong> &#8211;  int</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_is_symmetric</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.histogram">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">histogram</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a vector, contining a histogram of frequencies.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">histogram</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">histogram</tt><big>(</big><em>vector</em>, <em>min_x</em>, <em>max_x</em>, <em>nbin</em>, <em>n1</em><span class="optional">[</span>, <em>weight_vector</em>, <em>drop_outside</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vector</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>min_x</strong> (<em>input float</em>) &#8211; </li>
<li><strong>max_x</strong> (<em>input float</em>) &#8211; </li>
<li><strong>nbin</strong> (<em>input int</em>) &#8211; </li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_ret_vector_histogram,0)</li>
<li><strong>weight_vector</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n2), optional</em>) &#8211; </li>
<li><strong>drop_outside</strong> (<em>input int, optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_vector_histogram</strong> &#8211;  rank-1 array(&#8216;d&#8217;) with bounds (qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vector_histogram</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.d2coordination_function">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">d2coordination_function</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.d2coordination_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">d2coordination_function</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">d2coordination_function</tt><big>(</big><em>r</em>, <em>cutoff_in</em>, <em>transition_width</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (<em>input float</em>) &#8211; </li>
<li><strong>cutoff_in</strong> (<em>input float</em>) &#8211; </li>
<li><strong>transition_width</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_d2coordination_function_upper</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">d2coordination_function_upper</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.symmetrise">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">symmetrise</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.symmetrise" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetrise a matrix: $$A to frac{A + A^T}{2}$$</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">symmetrise</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">symmetrise</tt><big>(</big><em>matrix</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (<em>in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_symmetrise</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.nonsymmetric_diagonalise">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">nonsymmetric_diagonalise</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.nonsymmetric_diagonalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">nonsymmetric_diagonalise</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">nonsymmetric_diagonalise</tt><big>(</big><em>this</em>, <em>n2</em><span class="optional">[</span>, <em>l_evects</em>, <em>r_evects</em>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>n2</strong> (<em>input int</em>) &#8211; shape(qp_eval,0)</li>
<li><strong>l_evects</strong> (<em>in/output rank-2 array(&#8216;D&#8217;) with bounds (qp_n3,qp_n4), optional</em>) &#8211; </li>
<li><strong>r_evects</strong> (<em>in/output rank-2 array(&#8216;D&#8217;) with bounds (qp_n5,qp_n6), optional</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>eval</strong> &#8211;  rank-1 array(&#8216;D&#8217;) with bounds (qp_n2)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_nonsymmetric_diagonalise</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.insertion_sort">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">insertion_sort</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.insertion_sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">insertion_sort</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">insertion_sort</tt><big>(</big><em>this</em><span class="optional">[</span>, <em>idx</em><span class="optional">]</span><big>)</big></dt>
<dd><p>Do an in place insertion sort on <tt class="docutils literal"><span class="pre">this</span></tt>, in ascending order.
If <tt class="docutils literal"><span class="pre">idx</span></tt> is present  then on exit it will contain the list
of indices into <tt class="docutils literal"><span class="pre">this</span></tt> permuted in the same way as the entries
have been.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong> (<em>in/output rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>idx</strong> (<em>in/output rank-1 array(&#8216;i&#8217;) with bounds (size(qp_this)), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">insertion_sort_i</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">insertion_sort</tt><big>(</big><em>this</em><span class="optional">[</span>, <em>idx</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>idx</strong> (<em>in/output rank-1 array(&#8216;i&#8217;) with bounds (size(qp_this)), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">insertion_sort_r</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.find_in_array">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">find_in_array</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.find_in_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Search an array by element or by row.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">find_in_array</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">find_in_array</tt><big>(</big><em>this</em>, <em>val</em><span class="optional">[</span>, <em>mask</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong> (<em>input rank-2 array(&#8216;i&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>val</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n2)</em>) &#8211; </li>
<li><strong>mask</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n3), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_n</strong> &#8211;  int</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">find_in_array_row</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">find_in_array</tt><big>(</big><em>this</em>, <em>val</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong> (<em>input rank-2 array(&#8216;S&#8217;) with bounds (qp_n0,(*))</em>) &#8211; </li>
<li><strong>val</strong> (<em>input string(len=-1)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_n</strong> &#8211;  int</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">find_in_array_element_s</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">find_in_array</tt><big>(</big><em>this</em>, <em>val</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>val</strong> (<em>input int</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_n</strong> &#8211;  int</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">find_in_array_element_i</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.coordination_function">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">coordination_function</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.coordination_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">coordination_function</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">coordination_function</tt><big>(</big><em>r</em>, <em>lower_cutoff_in</em>, <em>lower_transition_width</em>, <em>upper_cutoff_in</em>, <em>upper_transition_width</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (<em>input float</em>) &#8211; </li>
<li><strong>lower_cutoff_in</strong> (<em>input float</em>) &#8211; </li>
<li><strong>lower_transition_width</strong> (<em>input float</em>) &#8211; </li>
<li><strong>upper_cutoff_in</strong> (<em>input float</em>) &#8211; </li>
<li><strong>upper_transition_width</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_coordination_function_lower_upper</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">coordination_function_lower_upper</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">coordination_function</tt><big>(</big><em>r</em>, <em>cutoff_in</em>, <em>transition_width</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (<em>input float</em>) &#8211; </li>
<li><strong>cutoff_in</strong> (<em>input float</em>) &#8211; </li>
<li><strong>transition_width</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_coordination_function_upper</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">coordination_function_upper</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.matrix_product_vect_asdiagonal_rl_sub">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_rl_sub</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.matrix_product_vect_asdiagonal_rl_sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">matrix_product_vect_asdiagonal_rl_sub</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_rl_sub</tt><big>(</big><em>matrix</em>, <em>vect</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
<li><strong>vect</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_product_vect_asdiagonal_rl_sub_zzd</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">matrix_product_vect_asdiagonal_rl_sub</tt><big>(</big><em>matrix</em>, <em>vect</em>, <em>n0</em>, <em>n1</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n0</strong> (<em>input int</em>) &#8211; shape(qp_lhs,0)</li>
<li><strong>n1</strong> (<em>input int</em>) &#8211; shape(qp_lhs,1)</li>
<li><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
<li><strong>vect</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n4)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>lhs</strong> &#8211;  rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_product_vect_asdiagonal_rl_sub_ddd</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.sort_array">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">sort_array</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.sort_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">sort_array</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">sort_array</tt><big>(</big><em>array</em><span class="optional">[</span>, <em>i_data</em>, <em>r_data</em><span class="optional">]</span><big>)</big></dt>
<dd><p>Sort an array of integers into ascending order (slow: scales as N:math:<cite>^2</cite>).
i_data is an accompanying array of integers on which the same reordering is performed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>i_data</strong> (<em>in/output rank-1 array(&#8216;i&#8217;) with bounds (qp_n1), optional</em>) &#8211; </li>
<li><strong>r_data</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n2), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">sort_array_r</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">sort_array</tt><big>(</big><em>array</em><span class="optional">[</span>, <em>r_data</em><span class="optional">]</span><big>)</big></dt>
<dd><p>Sort an array of integers into ascending order (slow: scales as N:math:<cite>^2</cite>).
r_data is an accompanying array of reals on which the same reordering is performed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<em>in/output rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>r_data</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n1), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">sort_array_i</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.diagonalise">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diagonalise</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.diagonalise" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloaded interfaces to textsc{lapack} matrix diagonlisation
functions for real and complex matrices. Always calls
textsc{lapack}, regardless of the &#8216;use_intrinsic_blas&#8217; setting.
Both diagonalisation and solution of the generalised eigenproblem
are supported, but only for real positive definite symmetric or
complex hermitian postive definite matrices.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">diagonalise</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diagonalise</tt><big>(</big><em>this</em>, <em>other</em>, <em>evals</em>, <em>evects</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>other</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
<li><strong>evals</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n4)</em>) &#8211; </li>
<li><strong>evects</strong> (<em>in/output rank-2 array(&#8216;D&#8217;) with bounds (qp_n5,qp_n6)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_z_diagonalise_generalised</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diagonalise</tt><big>(</big><em>this</em>, <em>evals</em><span class="optional">[</span>, <em>evects</em>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>evals</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</em>) &#8211; </li>
<li><strong>evects</strong> (<em>in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n3,qp_n4), optional</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_diagonalise</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diagonalise</tt><big>(</big><em>this</em>, <em>evals</em><span class="optional">[</span>, <em>evects</em>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>evals</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</em>) &#8211; </li>
<li><strong>evects</strong> (<em>in/output rank-2 array(&#8216;D&#8217;) with bounds (qp_n3,qp_n4), optional</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_z_diagonalise</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">diagonalise</tt><big>(</big><em>this</em>, <em>other</em>, <em>evals</em>, <em>evects</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>this</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>other</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
<li><strong>evals</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n4)</em>) &#8211; </li>
<li><strong>evects</strong> (<em>in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n5,qp_n6)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_diagonalise_generalised</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.rms_diff">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">rms_diff</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.rms_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Root-mean-square difference calculation for components of two vectors or arrays.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">rms_diff</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">rms_diff</tt><big>(</big><em>vector1</em>, <em>vector2</em><big>)</big></dt>
<dd><p>For two vectors of <img class="math" src="_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> dimensions, this is calculated as</p>
<div class="math">
<p><img src="_images/math/573d3593ebbb368ef34ca19fedb1001ecebb8121.png" alt="\sum_{i=1}^{N} \left(\mathbf{v_1}_i - \mathbf{v_2}_i\right)^2"/></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vector1</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>vector2</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n1)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_rms_diff1</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">rms_diff1</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">rms_diff</tt><big>(</big><em>array1</em>, <em>array2</em><big>)</big></dt>
<dd><p>For two arrays of dimension <img class="math" src="_images/math/0a2ae2cfe8c0eecfedf98d86105392aebf89a070.png" alt="N \times M"/>, this is calculated as</p>
<div class="math">
<p><img src="_images/math/2a669355d9a1ec0ddc797f7edcc858fd4ce4434d.png" alt="\sum_{j=1}^{M} \sum_{i=1}^{N} \left(\mathbf{a_1}_{ij} - \mathbf{a_2}_{ij}\right)^2"/></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>array1</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>array2</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_rms_diff2</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">rms_diff2</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.trace_mult">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">trace_mult</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.trace_mult" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">trace_mult</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">trace_mult</tt><big>(</big><em>matrixa</em>, <em>matrixb</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>matrixa</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>matrixb</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n2,qp_n3)</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_trm</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_trace_mult</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.norm">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">norm</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the euclidean norm of a vector or of an array.
For a single vector &#8216;x&#8217;, &#8216;norm(x)&#8217; is equal to &#8216;sqrt(x .dot. x)&#8217;
A two-dimensional array is treated as a list of vectors in either
Fortran (&#8216;dir=1&#8217;) or C (&#8216;dir=2&#8217;) style-ordering.
The result is then a one-dimensional array of the norms of each vector.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">norm</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">norm</tt><big>(</big><em>this</em>, <em>dir</em>, <em>n2</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>this</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>dir</strong> (<em>input int</em>) &#8211; </li>
<li><strong>n2</strong> (<em>input int</em>) &#8211; shape(qp_ret_sqvalue,0)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_sqvalue</strong> &#8211;  rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">array_norm</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">norm</tt><big>(</big><em>vector</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>vector</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_norm</strong> &#8211;  float</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">vector_norm</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.heap_sort">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">heap_sort</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.heap_sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">heap_sort</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">heap_sort</tt><big>(</big><em>array</em><span class="optional">[</span>, <em>r_data</em><span class="optional">]</span><big>)</big></dt>
<dd><p>Sort an array of integers into ascending order.
The function uses heapsort, which always scales as N log N.
r_data is an accompanying array of reals on which the same reordering is
performed
(Initial implementation by Andreas Wonisch)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<em>in/output rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>r_data</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n1), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">heap_sort_i</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">heap_sort</tt><big>(</big><em>array</em><span class="optional">[</span>, <em>i_data</em>, <em>r_data</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<em>in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>i_data</strong> (<em>in/output rank-1 array(&#8216;i&#8217;) with bounds (qp_n2), optional</em>) &#8211; </li>
<li><strong>r_data</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n3), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">heap_sort_r_2dim</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">heap_sort</tt><big>(</big><em>array</em><span class="optional">[</span>, <em>i_data</em>, <em>r_data</em><span class="optional">]</span><big>)</big></dt>
<dd><p>Sort an array of integers into ascending order.
The function uses heapsort, which always scales as N log N.
i_data and r_data are a accompanying arrays of integers and reals
on which the same reordering is performed
(Initial implementation by Andreas Wonisch)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>array</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>i_data</strong> (<em>in/output rank-1 array(&#8216;i&#8217;) with bounds (qp_n1), optional</em>) &#8211; </li>
<li><strong>r_data</strong> (<em>in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n2), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">heap_sort_r</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.d3coordination_function">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">d3coordination_function</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.d3coordination_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">d3coordination_function</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">d3coordination_function</tt><big>(</big><em>r</em>, <em>cutoff_in</em>, <em>transition_width</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (<em>input float</em>) &#8211; </li>
<li><strong>cutoff_in</strong> (<em>input float</em>) &#8211; </li>
<li><strong>transition_width</strong> (<em>input float</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_d3coordination_function_upper</strong> &#8211;  float</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">d3coordination_function_upper</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.is_orthogonal">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">is_orthogonal</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.is_orthogonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Test is matrix is unitary i.e. if $M M^{-1} = I$</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">is_orthogonal</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">is_orthogonal</tt><big>(</big><em>matrix</em><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_matrix_is_orthogonal</strong> &#8211;  int</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">matrix_is_orthogonal</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.linearalgebra.check_size">
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#quippy.linearalgebra.check_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Overloaded interface to assert that the size of an array is correct.
If the test fails &#8216;system_abort&#8217; is called with an appropriate error message
constructed from the &#8216;arrayname&#8217; and &#8216;caller&#8217; arguments.</p>
<p>Routine is wrapper around Fortran interface <tt class="docutils literal"><span class="pre">check_size</span></tt> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>realarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>realarray</strong> (<em>input rank-1 array(&#8216;D&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input int</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_complex_dim1_s</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>intarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>intarray</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (n1)</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_int_dim1</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>intarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>intarray</strong> (<em>input rank-2 array(&#8216;i&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (n2)</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_int_dim2</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>logarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>logarray</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input int</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_log_dim1_s</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>realarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>realarray</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (n1)</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_real_dim1</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>realarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>realarray</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (n2)</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_real_dim2</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>intarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>intarray</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input int</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_int_dim1_s</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>realarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>realarray</strong> (<em>input rank-1 array(&#8216;D&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (n1)</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_complex_dim1</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>realarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>realarray</strong> (<em>input rank-2 array(&#8216;D&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (n2)</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_complex_dim2</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>realarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>realarray</strong> (<em>input rank-1 array(&#8216;d&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input int</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_real_dim1_s</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>logarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>logarray</strong> (<em>input rank-2 array(&#8216;i&#8217;) with bounds (qp_n0,qp_n1)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (n2)</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_log_dim2</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<tt class="descclassname">quippy.linearalgebra.</tt><tt class="descname">check_size</tt><big>(</big><em>arrayname</em>, <em>logarray</em>, <em>n</em>, <em>caller</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><big>)</big></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arrayname</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>logarray</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</em>) &#8211; </li>
<li><strong>n</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (n1)</em>) &#8211; </li>
<li><strong>caller</strong> (<em>input string(len=-1)</em>) &#8211; </li>
<li><strong>error</strong> (<em>in/output rank-0 array(int,&#8217;i&#8217;), optional</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <tt class="docutils literal"><span class="pre">check_size_log_dim1</span></tt> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/libAtoms/linearalgebra.f95">libAtoms/linearalgebra.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="quaternions.html" title="Quaternions and rotation"
             >next</a> |</li>
        <li class="right" >
          <a href="electrostaticembed.html" title="Tools for electrostatic embedding"
             >previous</a> |</li>
        <li><a href="index.html">quippy  documentation</a> &raquo;</li>
          <li><a href="quippy.html" >Quippy library reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2008-2013, James Kermode.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>
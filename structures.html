<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Structure building routines &mdash; quippy d0e2137+ documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'd0e2137+',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="quippy d0e2137+ documentation" href="index.html" />
    <link rel="up" title="Quippy library reference" href="quippy.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">quippy d0e2137+ documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="quippy.html" accesskey="U">Quippy library reference</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/hybrid.png" alt="Logo"/>
            </a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/structures.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-quippy.structures">
<span id="structure-building-routines"></span><h1>Structure building routines<a class="headerlink" href="#module-quippy.structures" title="Permalink to this headline">¶</a></h1>
<p>This module contains a variety of structure generating routines.</p>
<p>Module contents for <a class="reference internal" href="#module-quippy.structures" title="quippy.structures: Structure building routines"><code class="xref py py-mod docutils literal"><span class="pre">quippy.structures</span></code></a>:</p>
<p class="rubric">Classes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#quippy.structures.MillerIndex" title="quippy.structures.MillerIndex"><code class="xref py py-obj docutils literal"><span class="pre">MillerIndex</span></code></a></td>
<td>Representation of a three of four index Miller direction or plane</td>
</tr>
</tbody>
</table>
<p class="rubric">Functions</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#quippy.structures.orthorhombic_slab" title="quippy.structures.orthorhombic_slab"><code class="xref py py-obj docutils literal"><span class="pre">orthorhombic_slab</span></code></a>(at[,&nbsp;tol,&nbsp;min_nrep,&nbsp;...])</td>
<td>Try to construct an orthorhombic cell equivalent to the primitive cell <cite>at</cite>, using supercells up to at most <cite>max_nrep</cite> repeats.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.structures.rotation_matrix" title="quippy.structures.rotation_matrix"><code class="xref py py-obj docutils literal"><span class="pre">rotation_matrix</span></code></a>(unit,&nbsp;y[,&nbsp;z,&nbsp;x,&nbsp;tol])</td>
<td>Return 3x3 matrix rotation matrix defining a crack with open surface defined by the plane <cite>y`=(l,m.n) or (h,k,i,l), and either crack tip line `z</cite> or crack propagation direction <cite>x</cite>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.structures.get_bulk_params" title="quippy.structures.get_bulk_params"><code class="xref py py-obj docutils literal"><span class="pre">get_bulk_params</span></code></a>(bulk,&nbsp;lat_type[,&nbsp;verbose])</td>
<td>Return 6-tuple of lattice parameters a, c, u, x, y, z for</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.structures.get_bond_lengths" title="quippy.structures.get_bond_lengths"><code class="xref py py-obj docutils literal"><span class="pre">get_bond_lengths</span></code></a>(at)</td>
<td>Return a dictionary mapping tuples (Species1, Species2) to an farray of bond-lengths</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.structures.MillerPlane" title="quippy.structures.MillerPlane"><code class="xref py py-obj docutils literal"><span class="pre">MillerPlane</span></code></a>(v)</td>
<td>Special case of <a class="reference internal" href="#quippy.structures.MillerIndex" title="quippy.structures.MillerIndex"><code class="xref py py-class docutils literal"><span class="pre">MillerIndex</span></code></a> with <code class="docutils literal"><span class="pre">type=&quot;plane&quot;</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.structures.MillerDirection" title="quippy.structures.MillerDirection"><code class="xref py py-obj docutils literal"><span class="pre">MillerDirection</span></code></a>(v)</td>
<td>Special case of <a class="reference internal" href="#quippy.structures.MillerIndex" title="quippy.structures.MillerIndex"><code class="xref py py-class docutils literal"><span class="pre">MillerIndex</span></code></a> with <code class="docutils literal"><span class="pre">type=&quot;direction&quot;</span></code> (the default)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.structures.angle_between" title="quippy.structures.angle_between"><code class="xref py py-obj docutils literal"><span class="pre">angle_between</span></code></a>(a,&nbsp;b)</td>
<td>Angle between crystallographic directions between a=[ijk] and b=[lmn], in radians.</td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="81%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="xref py py-attr docutils literal"><span class="pre">quartz_params</span></code></td>
<td>&#8212;</td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="quippy.structures.MillerIndex">
<em class="property">class </em><code class="descclassname">quippy.structures.</code><code class="descname">MillerIndex</code><a class="reference internal" href="_modules/quippy/structures.html#MillerIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.MillerIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Representation of a three of four index Miller direction or plane</p>
<p>A <a class="reference internal" href="#quippy.structures.MillerIndex" title="quippy.structures.MillerIndex"><code class="xref py py-class docutils literal"><span class="pre">MillerIndex</span></code></a> can be constructed from vector or parsed from a string:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">x</span> <span class="o">=</span> <span class="n">MillerIndex</span><span class="p">(</span><span class="s">&#39;-211&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">MillerIndex</span><span class="p">(</span><span class="s">&#39;111&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;plane&#39;</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="k">print</span> <span class="n">x</span> <span class="c"># prints &quot;[-211]&quot;</span>
<span class="k">print</span> <span class="n">y</span> <span class="c"># prints &quot;(111)&quot;, note round brackets denoting a plane</span>
<span class="k">print</span> <span class="n">z</span><span class="o">.</span><span class="n">latex</span><span class="p">()</span>
<span class="k">assert</span><span class="p">(</span><span class="n">angle_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="n">angle_between</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="n">angle_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#quippy.structures.MillerIndex.latex" title="quippy.structures.MillerIndex.latex"><code class="xref py py-obj docutils literal"><span class="pre">latex</span></code></a>()</td>
<td>Format this <a class="reference internal" href="#quippy.structures.MillerIndex" title="quippy.structures.MillerIndex"><code class="xref py py-class docutils literal"><span class="pre">MillerIndex</span></code></a> as a LaTeX string</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#quippy.structures.MillerIndex.parse" title="quippy.structures.MillerIndex.parse"><code class="xref py py-obj docutils literal"><span class="pre">parse</span></code></a>(s)</td>
<td>Parse a Miller index string</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#quippy.structures.MillerIndex.simplify" title="quippy.structures.MillerIndex.simplify"><code class="xref py py-obj docutils literal"><span class="pre">simplify</span></code></a>()</td>
<td>Simplify by dividing through by greatest common denominator</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="quippy.structures.MillerIndex.latex">
<code class="descname">latex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#MillerIndex.latex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.MillerIndex.latex" title="Permalink to this definition">¶</a></dt>
<dd><p>Format this <a class="reference internal" href="#quippy.structures.MillerIndex" title="quippy.structures.MillerIndex"><code class="xref py py-class docutils literal"><span class="pre">MillerIndex</span></code></a> as a LaTeX string</p>
</dd></dl>

<dl class="classmethod">
<dt id="quippy.structures.MillerIndex.parse">
<em class="property">classmethod </em><code class="descname">parse</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#MillerIndex.parse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.MillerIndex.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a Miller index string</p>
<dl class="docutils">
<dt>Negative indices can be denoted by:</dt>
<dd><ol class="first last arabic simple">
<li>leading minus sign, e.g. <code class="docutils literal"><span class="pre">[11-2]</span></code></li>
<li>trailing <code class="docutils literal"><span class="pre">b</span></code> (for &#8216;bar&#8217;), e.g. <code class="docutils literal"><span class="pre">112b</span></code></li>
<li>LaTeX <code class="docutils literal"><span class="pre">\bar{}</span></code>, e.g. <code class="docutils literal"><span class="pre">[11\bar{2}]</span></code> (which renders as <img class="math" src="_images/math/f0c2f668b044259fc2f1b92ead85626e711e2c4b.png" alt="[11\bar{2}]"/> in LaTeX)</li>
</ol>
</dd>
</dl>
<p>Leading or trailing brackets of various kinds are ignored.
i.e. <code class="docutils literal"><span class="pre">[001]</span></code>, <code class="docutils literal"><span class="pre">{001}</span></code>, <code class="docutils literal"><span class="pre">(001)</span></code>, <code class="docutils literal"><span class="pre">[001]</span></code>, <code class="docutils literal"><span class="pre">&lt;001&gt;</span></code>, <code class="docutils literal"><span class="pre">001</span></code> are all equivalent.</p>
<p>Returns an array of components (i,j,k) or (h,k,i,l)</p>
</dd></dl>

<dl class="method">
<dt id="quippy.structures.MillerIndex.simplify">
<code class="descname">simplify</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#MillerIndex.simplify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.MillerIndex.simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplify by dividing through by greatest common denominator</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="quippy.structures.void_analysis">
<code class="descclassname">quippy.structures.</code><code class="descname">void_analysis</code><span class="sig-paren">(</span><em>at</em>, <em>grid_size</em>, <em>cutoff</em>, <em>grid</em>, <em>radii</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.void_analysis" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<p><strong>grid_size</strong> :  input float</p>
<p><strong>cutoff</strong> :  input float</p>
<p><strong>grid</strong> :  in/output rank-2 array(&#8216;d&#8217;) with bounds (qp_n0,qp_n1)</p>
<p class="last"><strong>radii</strong> :  in/output rank-1 array(&#8216;d&#8217;) with bounds (qp_n2)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">void_analysis</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.alpha_quartz_cubic">
<code class="descclassname">quippy.structures.</code><code class="descname">alpha_quartz_cubic</code><span class="sig-paren">(</span><em>a</em>, <em>c</em>, <em>u</em>, <em>x</em>, <em>y</em>, <em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.alpha_quartz_cubic" title="Permalink to this definition">¶</a></dt>
<dd><p>Non-primitive 18-atom cubic quartz cell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>u</strong> :  input float</p>
<p><strong>x</strong> :  input float</p>
<p><strong>y</strong> :  input float</p>
<p><strong>z</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">alpha_quartz_cubic</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.find_closest">
<code class="descclassname">quippy.structures.</code><code class="descname">find_closest</code><span class="sig-paren">(</span><em>at</em>, <em>r</em>, <em>n0</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.find_closest" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<p><strong>r</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p><strong>n0</strong> :  input int</p>
<blockquote>
<div><p>shape(qp_closest_list,0)</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>closest_list</strong> :  rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">find_closest</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.sh2">
<code class="descclassname">quippy.structures.</code><code class="descname">sh2</code><span class="sig-paren">(</span><em>a</em>, <em>c</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.sh2" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 2-atom simple hexagonal lattice with lattice constants of <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">c</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">sh2</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.find_compatible_supercells">
<code class="descclassname">quippy.structures.</code><code class="descname">find_compatible_supercells</code><span class="sig-paren">(</span><em>l1</em>, <em>l2</em>, <em>match_tol</em><span class="optional">[</span>, <em>fix_l2</em>, <em>max_m1</em>, <em>max_m2</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.find_compatible_supercells" title="Permalink to this definition">¶</a></dt>
<dd><p>find supercells of two lattices that are compatible (i.e.
equal or parallel vectors to some tolerance)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>l1</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
<blockquote>
<div><p>lattices of 1st and 2nd structures</p>
</div></blockquote>
<p><strong>l2</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
<blockquote>
<div><p>lattices of 1st and 2nd structures</p>
</div></blockquote>
<p><strong>match_tol</strong> :  input float</p>
<blockquote>
<div><p>tolerange for good enough match.</p>
</div></blockquote>
<p><strong>n1</strong> :  rank-2 array(&#8216;i&#8217;) with bounds (3,3)</p>
<blockquote>
<div><p>output supercells of 1st and 2nd structures that match well enough (new lattices = lattice . n[12] )</p>
</div></blockquote>
<p><strong>n2</strong> :  rank-2 array(&#8216;i&#8217;) with bounds (3,3)</p>
<blockquote>
<div><p>output supercells of 1st and 2nd structures that match well enough (new lattices = lattice . n[12] )</p>
</div></blockquote>
<p><strong>fix_l2</strong> :  input int, optional</p>
<blockquote>
<div><p>if true, don&#8217;t allow supercells of l2</p>
</div></blockquote>
<p><strong>max_m1</strong> :  input int, optional</p>
<blockquote>
<div><p>max range of supercells to check (bigger is slower)</p>
</div></blockquote>
<p><strong>max_m2</strong> :  input int, optional</p>
<blockquote>
<div><p>max range of supercells to check (bigger is slower)</p>
</div></blockquote>
<p><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
<blockquote class="last">
<div><p>if present, error status return</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">find_compatible_supercells</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.imma">
<code class="descclassname">quippy.structures.</code><code class="descname">imma</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>u</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.imma" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 2-atom Imma cell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>b</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>u</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">imma</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.graphite_rhombohedral">
<code class="descclassname">quippy.structures.</code><code class="descname">graphite_rhombohedral</code><span class="sig-paren">(</span><em>a</em>, <em>c</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.graphite_rhombohedral" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">graphite_rhombohedral</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.fcc_z111_ortho">
<code class="descclassname">quippy.structures.</code><code class="descname">fcc_z111_ortho</code><span class="sig-paren">(</span><em>a0</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.fcc_z111_ortho" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a0</strong> :  input float</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">fcc_z111_ortho</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.find_motif">
<code class="descclassname">quippy.structures.</code><code class="descname">find_motif</code><span class="sig-paren">(</span><em>at</em>, <em>motif</em><span class="optional">[</span>, <em>start</em>, <em>end</em>, <em>mask</em>, <em>find_all_possible_matches</em>, <em>nneighb_only</em>, <em>alt_connect</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.find_motif" title="Permalink to this definition">¶</a></dt>
<dd><p>Subgraph isomorphism identifier based on J.R. Ullmann, JACM 23(1) 31-42 (1976)</p>
<p>Slight modifications are that if we include two unconnected vertices in the subgraph
then the corresponding vertices in the isomorphism MUST also be disconnected.
i.e. if we don``t include a bond between two atoms it is because it really isn``t there.</p>
<p>Pattern matching problems are combinatorial in time required, so the routine itself
has seven different escape routes; the first six try to quickly fail and prevent the
main part of the algorithm from executing at all.</p>
<p><code class="docutils literal"><span class="pre">at</span></code> is the atoms structure with connectivity data precalculated to at least first nearest neighbours</p>
<p><code class="docutils literal"><span class="pre">motif</span></code> is an integer matrix describing the connectivity of the region you wish to match.
it has dimension (number of atoms, max number of neighbours + 1)
motif(i,1) is the atomic number of an atom
motif(i,2), motif(i,3) etc. are the indices of atoms to which this atom connects in this motif
or zero if there are no more neighbours.</p>
<p>E.g. to match a water molecule we could use:</p>
<div class="highlight-python"><div class="highlight"><pre>water_motif  = reshape( (/  8, 1, 1, &amp;
                            2, 1, 1, &amp;
                            3, 0, 0  /), (/3,3/) )
</pre></div>
</div>
<p>or, alternatively:</p>
<div class="highlight-python"><div class="highlight"><pre>water_motif2 = reshape( (/ 1, 8, 1, &amp;
                           2, 1, 2, &amp;
                           0, 3, 0/), (/3,3/) )
</pre></div>
</div>
<p>and for an alpha carbon</p>
<div class="highlight-python"><div class="highlight"><pre>         O
         |
 N - C - C
     |
     H

c_alpha = reshape( (/ 6,6,7,8,1, &amp;
                      2,1,1,2,1, &amp;
                      3,4,0,0,0, &amp;
                      5,0,0,0,0/), (/5,4/) )
</pre></div>
</div>
<p>The routine will identify an optimum atom in the motif which it will try to find in the
atoms structure before doing any further matching. The optimum atom is the one which
minimises the total number of bond hops required to include all atoms in the motif</p>
<p><code class="docutils literal"><span class="pre">matches</span></code> is a table containing one line for each match found in the atoms structure
or for optimum atoms with indices between <code class="docutils literal"><span class="pre">start</span></code> and <code class="docutils literal"><span class="pre">end</span></code>. The integers in each line
give the indices of the atoms, in the same order as in the motif, which consitute a single
match.</p>
<p><code class="docutils literal"><span class="pre">mask</span></code> allows individual atoms to be selected for searching, e.g. for preventing a water
molecule from being re-identified as an OH, and then later as two hydrogens.</p>
<p>if find_all_possible_matches is true, all possible matches, not just non-overlapping ones,
are returned.  Useful for situations where things are ambiguous and need to be resolved
with more information outside this routine</p>
<p>The routine could optionally find hysteretically defined connections between neighbours,
if the alt_connect&#8217;s cutoff were the same as at.cutoff(_break)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<blockquote>
<div><p>The atoms structure to search</p>
</div></blockquote>
<p><strong>motif</strong> :  input rank-2 array(&#8216;i&#8217;) with bounds (qp_n0,qp_n1)</p>
<blockquote>
<div><p>The motif to search for</p>
</div></blockquote>
<p><strong>start</strong> :  input int, optional</p>
<blockquote>
<div><p>Start and End atomic indices for search</p>
</div></blockquote>
<p><strong>end</strong> :  input int, optional</p>
<blockquote>
<div><p>Start and End atomic indices for search</p>
</div></blockquote>
<p><strong>mask</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n2), optional</p>
<blockquote>
<div><p>If present only masked atoms are searched</p>
</div></blockquote>
<p><strong>find_all_possible_matches</strong> :  input int, optional</p>
<blockquote>
<div><p>if true, don&#8217;t exclude matches that overlap</p>
</div></blockquote>
<p><strong>nneighb_only</strong> :  input int, optional</p>
<p><strong>alt_connect</strong> : <a class="reference internal" href="connection.html#quippy.atoms.Connection" title="quippy.atoms.Connection"><code class="xref py py-class docutils literal"><span class="pre">Connection</span></code></a> object, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>matches</strong> : <a class="reference internal" href="table.html#quippy.table.Table" title="quippy.table.Table"><code class="xref py py-class docutils literal"><span class="pre">Table</span></code></a> object</p>
<blockquote class="last">
<div><p>All matches</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">find_motif</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.diamond">
<code class="descclassname">quippy.structures.</code><code class="descname">diamond</code><span class="sig-paren">(</span><em>a</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.diamond" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an 8-atom diamond-structure with cubic lattice constant of <code class="docutils literal"><span class="pre">a</span></code>
and atomic number <code class="docutils literal"><span class="pre">Z</span></code>, e.g. in Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">diamond</span><span class="p">(</span><span class="mf">5.44</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>  <span class="c"># Silicon unit cell</span>
</pre></div>
</div>
<p>Or, in Fortran:</p>
<div class="highlight-python"><div class="highlight"><pre>type(Atoms) :: at
...
call diamond(at, 5.44_dp, 14)
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>z</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">diamond</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.unit_slab">
<code class="descclassname">quippy.structures.</code><code class="descname">unit_slab</code><span class="sig-paren">(</span><em>axes</em>, <em>a</em><span class="optional">[</span>, <em>atnum</em>, <em>lat_type</em>, <em>c</em>, <em>u</em>, <em>x</em>, <em>y</em>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.unit_slab" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a slab of material with the x, y, and z axes desribed by the
Miller indices in the array axes (with <code class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">axes[:,1])</span></code>, <code class="docutils literal"><span class="pre">y</span> <span class="pre">=</span>
<span class="pre">axes[:,2]</span></code> and <code class="docutils literal"><span class="pre">z</span> <span class="pre">=</span> <span class="pre">axes[:,3]</span></code>).  The extent of the slab should
be given either as <code class="docutils literal"><span class="pre">(nx,</span> <span class="pre">ny,</span> <span class="pre">nz)</span></code> unit cells or as <code class="docutils literal"><span class="pre">(width,</span>
<span class="pre">height,</span> <span class="pre">nz)</span></code> where <cite>width</cite> and <cite>height</cite> are measured in Angstrom
and <cite>nz</cite> is the number of cells in the <cite>z</cite> direction.</p>
<p><cite>atnum</cite> can be used to initialise the <cite>z</cite> and <cite>species</cite> properties.
<cite>lat_type</cite> should be of <code class="docutils literal"><span class="pre">&quot;diamond&quot;`</span></code>, <code class="docutils literal"><span class="pre">&quot;fcc&quot;</span></code>, or <code class="docutils literal"><span class="pre">&quot;bcc&quot;</span></code>
(default is <code class="docutils literal"><span class="pre">&quot;diamond&quot;</span></code>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>axes</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
<p><strong>a</strong> :  input float</p>
<p><strong>atnum</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0), optional</p>
<p><strong>lat_type</strong> :  input string(len=-1), optional</p>
<p><strong>c</strong> :  input float, optional</p>
<p><strong>u</strong> :  input float, optional</p>
<p><strong>x</strong> :  input float, optional</p>
<p><strong>y</strong> :  input float, optional</p>
<p><strong>z</strong> :  input float, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">unit_slab</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.fcc1">
<code class="descclassname">quippy.structures.</code><code class="descname">fcc1</code><span class="sig-paren">(</span><em>a</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.fcc1" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 1-atom fcc-structure with cubic lattice constant of <code class="docutils literal"><span class="pre">a</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">fcc1</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.remove_too_close_atoms">
<code class="descclassname">quippy.structures.</code><code class="descname">remove_too_close_atoms</code><span class="sig-paren">(</span><em>at</em>, <em>distance</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.remove_too_close_atoms" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<p><strong>distance</strong> :  input float</p>
<p class="last"><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">remove_too_close_atoms</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.bulk">
<code class="descclassname">quippy.structures.</code><code class="descname">bulk</code><span class="sig-paren">(</span><em>lat_type</em>, <em>a</em><span class="optional">[</span>, <em>c</em>, <em>u</em>, <em>x</em>, <em>y</em>, <em>z</em>, <em>atnum</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.bulk" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a bulk primitive cell with a given lattice type and lattice parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>lat_type</strong> :  input string(len=-1)</p>
<blockquote>
<div><p>One of <code class="docutils literal"><span class="pre">diamond</span></code>, <code class="docutils literal"><span class="pre">bcc</span></code>, <code class="docutils literal"><span class="pre">fcc</span></code>, <code class="docutils literal"><span class="pre">alpha_quartz</span></code>, <code class="docutils literal"><span class="pre">anatase_cubic</span></code>, <code class="docutils literal"><span class="pre">anatase</span></code>, or <code class="docutils literal"><span class="pre">rutile</span></code></p>
</div></blockquote>
<p><strong>a</strong> :  input float</p>
<blockquote>
<div><p>Principal lattice constant</p>
</div></blockquote>
<p><strong>c</strong> :  input float, optional</p>
<p><strong>u</strong> :  input float, optional</p>
<p><strong>x</strong> :  input float, optional</p>
<p><strong>y</strong> :  input float, optional</p>
<p><strong>z</strong> :  input float, optional</p>
<p><strong>atnum</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0), optional</p>
<blockquote>
<div><p>Optionally specify atomic numbers</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">bulk</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.supercell">
<code class="descclassname">quippy.structures.</code><code class="descname">supercell</code><span class="sig-paren">(</span><em>a</em>, <em>n1</em>, <em>n2</em>, <em>n3</em><span class="optional">[</span>, <em>supercell_index_name</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.supercell" title="Permalink to this definition">¶</a></dt>
<dd><p>Replicates the unit cell <code class="docutils literal"><span class="pre">n1*n2*n3</span></code> times along the lattice vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<blockquote>
<div><p>Input cell</p>
</div></blockquote>
<p><strong>n1</strong> :  input int</p>
<p><strong>n2</strong> :  input int</p>
<p><strong>n3</strong> :  input int</p>
<p><strong>supercell_index_name</strong> :  input string(len=-1), optional</p>
<p><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>aa</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<blockquote class="last">
<div><p>Output (big) cell</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">supercell</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.structure_from_file">
<code class="descclassname">quippy.structures.</code><code class="descname">structure_from_file</code><span class="sig-paren">(</span><em>struct</em><span class="optional">[</span>, <em>vol_per_atom</em>, <em>vol_per_unit_cell</em>, <em>repeat</em>, <em>z_values_str</em>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.structure_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>create a supercell of a structure, read from a file, with chosen
volume per atom or volume per unit cell, with desired supercell
repeats, and specified Z values.
file may contain default Z values as a property Z_values=``Z1 Z2 ...``
structures that begin with . or / are searched for as paths,
and everything else is searched for in <code class="docutils literal"><span class="pre">QUIP_ARCH/structures/struct.xyz</span></code>
or in <code class="docutils literal"><span class="pre">HOME/share/quip_structures/struct.xyz</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>struct</strong> :  input string(len=-1)</p>
<p><strong>vol_per_atom</strong> :  input float, optional</p>
<p><strong>vol_per_unit_cell</strong> :  input float, optional</p>
<p><strong>repeat</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (3), optional</p>
<p><strong>z_values_str</strong> :  input string(len=-1), optional</p>
<p><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_dup_cell</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">structure_from_file</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.map_nearest_atoms">
<code class="descclassname">quippy.structures.</code><code class="descname">map_nearest_atoms</code><span class="sig-paren">(</span><em>at1</em>, <em>at2</em>, <em>types</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.map_nearest_atoms" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>at1</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<p><strong>at2</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<p><strong>types</strong> :  input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ret_map_nearest_atoms</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">map_nearest_atoms</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.fcc_z100">
<code class="descclassname">quippy.structures.</code><code class="descname">fcc_z100</code><span class="sig-paren">(</span><em>a0</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.fcc_z100" title="Permalink to this definition">¶</a></dt>
<dd><p>Make an FCC 100 surface, such that the repeating squares of the
surface are aligned with the cell boundaries</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a0</strong> :  input float</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">fcc_z100</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.min_neighbour_dist">
<code class="descclassname">quippy.structures.</code><code class="descname">min_neighbour_dist</code><span class="sig-paren">(</span><em>at</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.min_neighbour_dist" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_min_neighbour_dist</strong> :  float</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">min_neighbour_dist</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.rutile">
<code class="descclassname">quippy.structures.</code><code class="descname">rutile</code><span class="sig-paren">(</span><em>a</em>, <em>c</em>, <em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.rutile" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>u</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">rutile</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.fcc_disloc_malc">
<code class="descclassname">quippy.structures.</code><code class="descname">fcc_disloc_malc</code><span class="sig-paren">(</span><em>a0</em>, <em>nu</em>, <em>n1</em>, <em>n2</em>, <em>n3</em>, <em>d</em>, <em>type</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.fcc_disloc_malc" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a0</strong> :  input float</p>
<p><strong>nu</strong> :  input float</p>
<p><strong>n1</strong> :  input int</p>
<p><strong>n2</strong> :  input int</p>
<p><strong>n3</strong> :  input int</p>
<p><strong>d</strong> :  input int</p>
<p><strong>type</strong> :  input string(len=-1)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">fcc_disloc_malc</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.graphite">
<code class="descclassname">quippy.structures.</code><code class="descname">graphite</code><span class="sig-paren">(</span><em>a</em>, <em>c</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.graphite" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 4-atom graphite lattice with lattice constants of <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">c</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">graphite</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.tube_radius">
<code class="descclassname">quippy.structures.</code><code class="descname">tube_radius</code><span class="sig-paren">(</span><em>tube</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.tube_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Calcualte average radius of a nanotube</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tube</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_r</strong> :  float</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">tube_radius</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.transform">
<code class="descclassname">quippy.structures.</code><code class="descname">transform</code><span class="sig-paren">(</span><em>at_in</em>, <em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform cell and lattice coordinates by the 3 x 3 matrix <cite>t</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>at_in</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<blockquote>
<div><p>Input</p>
</div></blockquote>
<p><strong>t</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>at_out</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<blockquote class="last">
<div><p>Output</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">transform</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.graphene_tube">
<code class="descclassname">quippy.structures.</code><code class="descname">graphene_tube</code><span class="sig-paren">(</span><em>a</em>, <em>n</em>, <em>m</em>, <em>nz</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.graphene_tube" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <img class="math" src="_images/math/a931e0da81084e1196139da4d88d9305b81853c8.png" alt="(n,m)"/> nanotube with lattice parameter <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">nz</span></code>
unit cells along the tube length. Also returns the radius of the tube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>tube</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<p><strong>a</strong> :  input float</p>
<p><strong>n</strong> :  input int</p>
<p><strong>m</strong> :  input int</p>
<p><strong>nz</strong> :  input int</p>
<p class="last"><strong>ret_r</strong> :  float</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">graphene_tube</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.fcc_z111">
<code class="descclassname">quippy.structures.</code><code class="descname">fcc_z111</code><span class="sig-paren">(</span><em>a0</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.fcc_z111" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a0</strong> :  input float</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">fcc_z111</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.graphene_cubic">
<code class="descclassname">quippy.structures.</code><code class="descname">graphene_cubic</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.graphene_cubic" title="Permalink to this definition">¶</a></dt>
<dd><p>Cubic graphene unit cell with lattice parameter <code class="docutils literal"><span class="pre">a</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a</strong> :  input float</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_cube</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">graphene_cubic</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.hcp">
<code class="descclassname">quippy.structures.</code><code class="descname">hcp</code><span class="sig-paren">(</span><em>a</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.hcp" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 2-atom hcp lattice with lattice constants of <code class="docutils literal"><span class="pre">a</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">hcp</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.graphene_sheet">
<code class="descclassname">quippy.structures.</code><code class="descname">graphene_sheet</code><span class="sig-paren">(</span><em>a</em>, <em>n</em>, <em>m</em>, <em>rep_x</em>, <em>rep_y</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.graphene_sheet" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a graphene sheet of index <img class="math" src="_images/math/a931e0da81084e1196139da4d88d9305b81853c8.png" alt="(n,m)"/> with lattice constant <code class="docutils literal"><span class="pre">a</span></code> with <code class="docutils literal"><span class="pre">rep_x</span></code>
repeat units in the <img class="math" src="_images/math/188c175aac0a8a9c22499336711b5d7256407254.png" alt="x"/> direction and <code class="docutils literal"><span class="pre">rep_y</span></code> in the <img class="math" src="_images/math/b124ff74afb0914bb434e8fb849eb56d734412f8.png" alt="y"/> direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>n</strong> :  input int</p>
<p><strong>m</strong> :  input int</p>
<p><strong>rep_x</strong> :  input int</p>
<p><strong>rep_y</strong> :  input int</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>sheet</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">graphene_sheet</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.beta_tin">
<code class="descclassname">quippy.structures.</code><code class="descname">beta_tin</code><span class="sig-paren">(</span><em>a</em>, <em>c</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.beta_tin" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 2-atom beta-tin structure with lattice constants of a and c</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">beta_tin</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.graphene_slab">
<code class="descclassname">quippy.structures.</code><code class="descname">graphene_slab</code><span class="sig-paren">(</span><em>a</em>, <em>theta</em>, <em>width</em>, <em>height</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.graphene_slab" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a slab of graphene of a given with and height, at a given angle.
<code class="docutils literal"><span class="pre">a</span></code> is lattice parameter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>theta</strong> :  input float</p>
<p><strong>width</strong> :  input float</p>
<p><strong>height</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>slab</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">graphene_slab</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.imma4">
<code class="descclassname">quippy.structures.</code><code class="descname">imma4</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>u</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.imma4" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 4-atom Imma cell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>b</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>u</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">imma4</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.beta_tin4">
<code class="descclassname">quippy.structures.</code><code class="descname">beta_tin4</code><span class="sig-paren">(</span><em>a</em>, <em>c</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.beta_tin4" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 4-atom beta-tin structure with lattice constants of a and c</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">beta_tin4</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.wurtzite">
<code class="descclassname">quippy.structures.</code><code class="descname">wurtzite</code><span class="sig-paren">(</span><em>a</em><span class="optional">[</span>, <em>c</em>, <em>z1</em>, <em>z2</em>, <em>u</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.wurtzite" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 4-atom wurtzite lattice with lattice constants of <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">c</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float, optional</p>
<p><strong>z1</strong> :  input int, optional</p>
<p><strong>z2</strong> :  input int, optional</p>
<p><strong>u</strong> :  input float, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">wurtzite</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.anatase_cubic">
<code class="descclassname">quippy.structures.</code><code class="descname">anatase_cubic</code><span class="sig-paren">(</span><em>a</em>, <em>c</em>, <em>u</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.anatase_cubic" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>u</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">anatase_cubic</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.bond_angle_mean_dev">
<code class="descclassname">quippy.structures.</code><code class="descname">bond_angle_mean_dev</code><span class="sig-paren">(</span><em>at</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.bond_angle_mean_dev" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">bond_angle_mean_dev</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.alpha_quartz">
<code class="descclassname">quippy.structures.</code><code class="descname">alpha_quartz</code><span class="sig-paren">(</span><em>a</em>, <em>c</em>, <em>u</em>, <em>x</em>, <em>y</em>, <em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.alpha_quartz" title="Permalink to this definition">¶</a></dt>
<dd><p>Primitive 9-atom trigonal alpha quartz cell, with lattice constants
<cite>a</cite> and <cite>c</cite> and internal coordinates <cite>u</cite> (Si), <cite>x</cite>, <cite>y</cite> and <cite>z</cite> (O).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>u</strong> :  input float</p>
<p><strong>x</strong> :  input float</p>
<p><strong>y</strong> :  input float</p>
<p><strong>z</strong> :  input float</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">alpha_quartz</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.water">
<code class="descclassname">quippy.structures.</code><code class="descname">water</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.water" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an atoms object containing one TIP3P water molecule in a box
giving the correct density at 300K</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_water</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">water</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.fcc">
<code class="descclassname">quippy.structures.</code><code class="descname">fcc</code><span class="sig-paren">(</span><em>a</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.fcc" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 4-atom fcc-structure with cubic lattice constant of <code class="docutils literal"><span class="pre">a</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">fcc</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.delaunay_reduce">
<code class="descclassname">quippy.structures.</code><code class="descname">delaunay_reduce</code><span class="sig-paren">(</span><em>lat</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.delaunay_reduce" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lat</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>ret_reduced_lat</strong> :  rank-2 array(&#8216;d&#8217;) with bounds (3,3)</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">delaunay_reduce</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.fcc_11b2_edge_disloc">
<code class="descclassname">quippy.structures.</code><code class="descname">fcc_11b2_edge_disloc</code><span class="sig-paren">(</span><em>a0</em>, <em>n1</em>, <em>n2</em>, <em>n3</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.fcc_11b2_edge_disloc" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a0</strong> :  input float</p>
<p><strong>n1</strong> :  input int</p>
<p><strong>n2</strong> :  input int</p>
<p><strong>n3</strong> :  input int</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">fcc_11b2_edge_disloc</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.disloc_noam">
<code class="descclassname">quippy.structures.</code><code class="descname">disloc_noam</code><span class="sig-paren">(</span><em>at</em>, <em>p</em>, <em>l</em>, <em>b</em><span class="optional">[</span>, <em>close_threshold</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.disloc_noam" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>at</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<p><strong>p</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p><strong>l</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p><strong>b</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<p class="last"><strong>close_threshold</strong> :  input float, optional</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">disloc_noam</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.bcc">
<code class="descclassname">quippy.structures.</code><code class="descname">bcc</code><span class="sig-paren">(</span><em>a</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.bcc" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 2-atom bcc-structure with cubic lattice constant of <code class="docutils literal"><span class="pre">a</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">bcc</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.bcc1">
<code class="descclassname">quippy.structures.</code><code class="descname">bcc1</code><span class="sig-paren">(</span><em>a</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.bcc1" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 1-atom primitive bcc-structure with cubic lattice constant of <code class="docutils literal"><span class="pre">a</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">bcc1</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.sh">
<code class="descclassname">quippy.structures.</code><code class="descname">sh</code><span class="sig-paren">(</span><em>a</em>, <em>c</em><span class="optional">[</span>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.sh" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 1-atom simple hexagonal lattice with lattice constants of <code class="docutils literal"><span class="pre">a</span></code> and <code class="docutils literal"><span class="pre">c</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>c</strong> :  input float</p>
<p><strong>z</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">sh</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.arbitrary_supercell">
<code class="descclassname">quippy.structures.</code><code class="descname">arbitrary_supercell</code><span class="sig-paren">(</span><em>a_in</em>, <em>i1</em><span class="optional">[</span>, <em>error</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.arbitrary_supercell" title="Permalink to this definition">¶</a></dt>
<dd><p>construct an arbitrary supercell from a primitive structure and a combination of primitive vectors that form supercell</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a_in</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<blockquote>
<div><p>Input (small) cell</p>
</div></blockquote>
<p><strong>i1</strong> :  input rank-2 array(&#8216;i&#8217;) with bounds (3,3)</p>
<blockquote>
<div><p>combination of primitive lattice vectors to create supercell (a_out.lattice = a_in.lattice . i1).  column i specifies output pbc vector i.</p>
</div></blockquote>
<p><strong>error</strong> :  in/output rank-0 array(int,&#8217;i&#8217;), optional</p>
<blockquote>
<div><p>if present, returned error status</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>a_out</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
<blockquote class="last">
<div><p>Output (big) cell</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">arbitrary_supercell</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.diamond2">
<code class="descclassname">quippy.structures.</code><code class="descname">diamond2</code><span class="sig-paren">(</span><em>a</em><span class="optional">[</span>, <em>z1</em>, <em>z2</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.diamond2" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a 2-atom diamond-structure with cubic lattice constant of <code class="docutils literal"><span class="pre">a</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> :  input float</p>
<p><strong>z1</strong> :  input int, optional</p>
<p><strong>z2</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myatoms</strong> : <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">diamond2</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.surface_unit_cell">
<code class="descclassname">quippy.structures.</code><code class="descname">surface_unit_cell</code><span class="sig-paren">(</span><em>surf_v</em>, <em>lat</em><span class="optional">[</span>, <em>third_vec_normal</em>, <em>tol</em>, <em>max_n</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.surface_unit_cell" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>surf_v</strong> :  input rank-1 array(&#8216;d&#8217;) with bounds (3)</p>
<blockquote>
<div><p>surface vector</p>
</div></blockquote>
<p><strong>lat</strong> :  input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</p>
<blockquote>
<div><p>lattice</p>
</div></blockquote>
<p><strong>third_vec_normal</strong> :  input int, optional</p>
<p><strong>tol</strong> :  input float, optional</p>
<p><strong>max_n</strong> :  input int, optional</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>i_out</strong> :  rank-2 array(&#8216;i&#8217;) with bounds (3,3)</p>
<blockquote class="last">
<div><p>combination of primitive lattice vectors to create supercell (surf_lattice = latt . i_out).  column i specifies output pbc vector i.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">surface_unit_cell</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.slab">
<code class="descclassname">quippy.structures.</code><code class="descname">slab</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#quippy.structures.slab" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine is wrapper around Fortran interface <code class="docutils literal"><span class="pre">slab</span></code> containing multiple routines:</p>
<blockquote>
<div><dl class="function">
<dt>
<code class="descclassname">quippy.structures.</code><code class="descname">slab</code><span class="sig-paren">(</span><em>axes</em>, <em>a</em>, <em>nx</em>, <em>ny</em>, <em>nz</em><span class="optional">[</span>, <em>atnum</em>, <em>lat_type</em>, <em>c</em>, <em>u</em>, <em>x</em>, <em>y</em>, <em>z</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>axes</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</em>) &#8211; </li>
<li><strong>a</strong> (<em>input float</em>) &#8211; </li>
<li><strong>nx</strong> (<em>input int</em>) &#8211; </li>
<li><strong>ny</strong> (<em>input int</em>) &#8211; </li>
<li><strong>nz</strong> (<em>input int</em>) &#8211; </li>
<li><strong>atnum</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0), optional</em>) &#8211; </li>
<li><strong>lat_type</strong> (<em>in/output rank-0 array(string(len=-1),&#8217;c&#8217;), optional</em>) &#8211; </li>
<li><strong>c</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>u</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>x</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>y</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>z</strong> (<em>input float, optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myslab</strong> &#8211; <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">slab_nx_ny_nz</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

<dl class="function">
<dt>
<code class="descclassname">quippy.structures.</code><code class="descname">slab</code><span class="sig-paren">(</span><em>axes</em>, <em>a</em>, <em>width</em>, <em>height</em>, <em>nz</em><span class="optional">[</span>, <em>atnum</em>, <em>lat_type</em>, <em>c</em>, <em>u</em>, <em>x</em>, <em>y</em>, <em>z</em>, <em>even_nx</em>, <em>even_ny</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>axes</strong> (<em>input rank-2 array(&#8216;d&#8217;) with bounds (3,3)</em>) &#8211; </li>
<li><strong>a</strong> (<em>input float</em>) &#8211; </li>
<li><strong>width</strong> (<em>input float</em>) &#8211; </li>
<li><strong>height</strong> (<em>input float</em>) &#8211; </li>
<li><strong>nz</strong> (<em>input int</em>) &#8211; </li>
<li><strong>atnum</strong> (<em>input rank-1 array(&#8216;i&#8217;) with bounds (qp_n0), optional</em>) &#8211; </li>
<li><strong>lat_type</strong> (<em>input string(len=-1), optional</em>) &#8211; </li>
<li><strong>c</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>u</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>x</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>y</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>z</strong> (<em>input float, optional</em>) &#8211; </li>
<li><strong>even_nx</strong> (<em>input int, optional</em>) &#8211; </li>
<li><strong>even_ny</strong> (<em>input int, optional</em>) &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>myslab</strong> &#8211; <a class="reference internal" href="atoms.html#quippy.atoms.Atoms" title="quippy.atoms.Atoms"><code class="xref py py-class docutils literal"><span class="pre">Atoms</span></code></a> object</p>
</td>
</tr>
</tbody>
</table>
<p>Routine is wrapper around Fortran routine <code class="docutils literal"><span class="pre">slab_width_height_nz</span></code> defined in file <a class="reference external" href="https://github.com/libAtoms/QUIP/blob/public/src/libAtoms/Structures.f95">src/libAtoms/Structures.f95</a>.</p>
</dd></dl>

</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.orthorhombic_slab">
<code class="descclassname">quippy.structures.</code><code class="descname">orthorhombic_slab</code><span class="sig-paren">(</span><em>at</em>, <em>tol=1e-05</em>, <em>min_nrep=1</em>, <em>max_nrep=5</em>, <em>graphics=False</em>, <em>rot=None</em>, <em>periodicity=None</em>, <em>vacuum=None</em>, <em>shift=None</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#orthorhombic_slab"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.orthorhombic_slab" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to construct an orthorhombic cell equivalent to the
primitive cell <cite>at</cite>, using supercells up to at most <cite>max_nrep</cite>
repeats. Symmetry must be exact within a tolerance of <cite>tol</cite>. If
<cite>rot</cite> is not None, we first transform <cite>at</cite> by the rotation
matrix <cite>rot</cite>. The optional argument <cite>periodicity</cite> can be used to
fix the periodicity one or more directions. It should be a three
component vector with value zero in the unconstrained
directions. The vector <cite>vacuum</cite> can be used to add vacuum in one
or more directions. <cite>shift</cite> is a three component vector which
can be used to shift the positions in the final cell.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.rotation_matrix">
<code class="descclassname">quippy.structures.</code><code class="descname">rotation_matrix</code><span class="sig-paren">(</span><em>unit</em>, <em>y</em>, <em>z=None</em>, <em>x=None</em>, <em>tol=1e-05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#rotation_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.rotation_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return 3x3 matrix rotation matrix defining a crack with open
surface defined by the plane <cite>y`=(l,m.n) or (h,k,i,l), and either
crack tip line `z</cite> or crack propagation direction <cite>x</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.get_bulk_params">
<code class="descclassname">quippy.structures.</code><code class="descname">get_bulk_params</code><span class="sig-paren">(</span><em>bulk</em>, <em>lat_type</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#get_bulk_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.get_bulk_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return 6-tuple of lattice parameters a, c, u, x, y, z for
cell <cite>bulk</cite> of lattice type <cite>lat_type</cite></p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.get_bond_lengths">
<code class="descclassname">quippy.structures.</code><code class="descname">get_bond_lengths</code><span class="sig-paren">(</span><em>at</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#get_bond_lengths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.get_bond_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary mapping tuples (Species1, Species2) to an farray of bond-lengths</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.MillerPlane">
<code class="descclassname">quippy.structures.</code><code class="descname">MillerPlane</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#MillerPlane"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.MillerPlane" title="Permalink to this definition">¶</a></dt>
<dd><p>Special case of <a class="reference internal" href="#quippy.structures.MillerIndex" title="quippy.structures.MillerIndex"><code class="xref py py-class docutils literal"><span class="pre">MillerIndex</span></code></a> with <code class="docutils literal"><span class="pre">type=&quot;plane&quot;</span></code></p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.MillerDirection">
<code class="descclassname">quippy.structures.</code><code class="descname">MillerDirection</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#MillerDirection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.MillerDirection" title="Permalink to this definition">¶</a></dt>
<dd><p>Special case of <a class="reference internal" href="#quippy.structures.MillerIndex" title="quippy.structures.MillerIndex"><code class="xref py py-class docutils literal"><span class="pre">MillerIndex</span></code></a> with <code class="docutils literal"><span class="pre">type=&quot;direction&quot;</span></code> (the default)</p>
</dd></dl>

<dl class="function">
<dt id="quippy.structures.angle_between">
<code class="descclassname">quippy.structures.</code><code class="descname">angle_between</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/quippy/structures.html#angle_between"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#quippy.structures.angle_between" title="Permalink to this definition">¶</a></dt>
<dd><p>Angle between crystallographic directions between a=[ijk] and b=[lmn], in radians.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">quippy d0e2137+ documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="quippy.html" >Quippy library reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2008-2015, James Kermode.
      Last updated on Dec 20, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>